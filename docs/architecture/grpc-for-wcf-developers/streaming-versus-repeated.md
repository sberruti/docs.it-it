---
title: Confronto tra i servizi di streaming e i campi ripetuti-gRPC per sviluppatori WCF
description: Confrontare i campi ripetuti con i servizi di streaming come modi per passare raccolte di dati con gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 46586ab08df6b136cdafb990ce8be75435a6bf6c
ms.sourcegitcommit: 30a558d23e3ac5a52071121a52c305c85fe15726
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/25/2019
ms.locfileid: "75337860"
---
# <a name="grpc-streaming-services-versus-repeated-fields"></a><span data-ttu-id="c2dc4-103">Servizi di streaming gRPC rispetto ai campi ripetuti</span><span class="sxs-lookup"><span data-stu-id="c2dc4-103">gRPC streaming services versus repeated fields</span></span>

<span data-ttu-id="c2dc4-104">i servizi gRPC forniscono due modi per restituire set di impostazioni o elenchi di oggetti.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="c2dc4-105">La specifica del messaggio buffer del protocollo utilizza la parola chiave `repeated` per dichiarare elenchi o matrici di messaggi all'interno di un altro messaggio.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="c2dc4-106">La specifica del servizio gRPC usa la parola chiave `stream` per dichiarare una connessione persistente con esecuzione prolungata in cui vengono inviati più messaggi e può essere elaborato singolarmente.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection over which multiple messages are sent, and can be processed, individually.</span></span> <span data-ttu-id="c2dc4-107">La funzionalità `stream` può essere usata anche per dati temporali con esecuzione prolungata, ad esempio notifiche o messaggi di log, ma in questo capitolo viene considerato l'utilizzo per la restituzione di un singolo set di dati.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-107">The `stream` feature can also be used for long-running temporal data such as notifications or log messages, but this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="c2dc4-108">È necessario utilizzare dipende da diversi fattori, ad esempio la dimensione complessiva del set di dati, il tempo necessario per creare il set di dati a livello di client o server e se il consumer del set di dati può iniziare a operare su di esso non appena il primo elemento è disponibile o necessita del set di dati completo per eseguire operazioni utili.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-108">Which you should use depends on various factors, such as the overall size of the dataset, the time it took to create the dataset at either the client or server end, and whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="c2dc4-109">Quando usare campi di `repeated`</span><span class="sxs-lookup"><span data-stu-id="c2dc4-109">When to use `repeated` fields</span></span>

<span data-ttu-id="c2dc4-110">Per qualsiasi set di dati vincolato a dimensioni e che può essere generato interamente in un breve periodo di tempo, ad indicare in un secondo, è necessario usare un campo `repeated` in un messaggio protobuf normale.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-110">For any dataset that is constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="c2dc4-111">Ad esempio, in un sistema di e-commerce, per compilare un elenco di elementi all'interno di un ordine è probabile che l'elenco non sia molto grande.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-111">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="c2dc4-112">La restituzione di un singolo messaggio con un campo `repeated` è un ordine di grandezza più veloce rispetto all'utilizzo di un `stream` e comporta un minor sovraccarico di rete.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-112">Returning a single message with a `repeated` field is an order of magnitude faster than using a `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="c2dc4-113">Se il client richiede tutti i dati prima di iniziare a elaborarli e il set di dati è sufficientemente piccolo da costruire in memoria, provare a usare un campo `repeated` anche se la creazione effettiva del set di dati in memoria nel server è più lenta.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-113">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field even if the actual creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="c2dc4-114">Quando usare i metodi `stream`</span><span class="sxs-lookup"><span data-stu-id="c2dc4-114">When to use `stream` methods</span></span>

<span data-ttu-id="c2dc4-115">I set di impostazioni in cui gli oggetti messaggio sono potenzialmente molto grandi vengono trasferiti in modo ottimale tramite richieste di streaming o risposte.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-115">Datasets where the message objects are potentially very large are best transferred using streaming requests or responses.</span></span> <span data-ttu-id="c2dc4-116">È più efficiente costruire un oggetto di grandi dimensioni in memoria, scriverlo nella rete e quindi liberare le risorse.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-116">It's more efficient to construct a large object in memory, write it to the network and then free up the resources.</span></span> <span data-ttu-id="c2dc4-117">Questo approccio migliorerà la scalabilità del servizio.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-117">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="c2dc4-118">Analogamente, i set di dati di dimensioni non vincolate devono essere inviati attraverso i flussi per evitare di esaurire la memoria durante la loro costruzione.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-118">Similarly, datasets of unconstrained size should be sent over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="c2dc4-119">Per i set di impostazioni in cui ogni singolo elemento può essere elaborato separatamente dal consumer, è consigliabile usare un flusso se significa che lo stato di avanzamento può essere indicato all'utente finale.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-119">For datasets where each individual item can be processed separately by the consumer, you should consider using a stream if it means that progress can be indicated to the end user.</span></span> <span data-ttu-id="c2dc4-120">Questo potrebbe migliorare la velocità di risposta apparente di un'applicazione, sebbene questo debba essere bilanciato in base alle prestazioni complessive dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-120">This could improve the apparent responsiveness of an application, although this should be balanced against the overall performance of the application.</span></span>

<span data-ttu-id="c2dc4-121">Un altro scenario in cui i flussi possono essere utili è la posizione in cui un messaggio viene elaborato tra più servizi.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-121">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="c2dc4-122">Se ogni servizio in una catena restituisce un flusso, il servizio Terminal, ovvero l'ultimo nella catena, può iniziare a restituire messaggi che possono essere elaborati e passati di nuovo lungo la catena al richiedente originale, che può restituire un flusso o aggregare Restituisce un singolo messaggio di risposta.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-122">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages that can be processed and passed back along the chain to the original requestor, which can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="c2dc4-123">Questo approccio si presta bene a modelli come map/reduce.</span><span class="sxs-lookup"><span data-stu-id="c2dc4-123">This approach lends itself well to patterns like Map/Reduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="c2dc4-124">[Precedente](migrate-duplex-services.md)
>[Successivo](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="c2dc4-124">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
