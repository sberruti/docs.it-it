---
title: Servizi di streaming e campi ripetuti - gRPC per gli sviluppatori WCF
description: Confronta i campi ripetuti con i servizi di streaming come modalità di passaggio di raccolte di dati tramite gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 542ebc393f9c9c1ad717d02d01fab33d85c18917
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79147750"
---
# <a name="grpc-streaming-services-vs-repeated-fields"></a><span data-ttu-id="76c50-103">Servizi di streaming gRPC a confronto con i campi ripetuti</span><span class="sxs-lookup"><span data-stu-id="76c50-103">gRPC streaming services vs. repeated fields</span></span>

<span data-ttu-id="76c50-104">I servizi gRPC offrono due modi per restituire set di dati o elenchi di oggetti.</span><span class="sxs-lookup"><span data-stu-id="76c50-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="76c50-105">La specifica del messaggio `repeated` Protocol Buffers utilizza la parola chiave per dichiarare elenchi o matrici di messaggi all'interno di un altro messaggio.</span><span class="sxs-lookup"><span data-stu-id="76c50-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="76c50-106">La specifica del servizio `stream` gRPC utilizza la parola chiave per dichiarare una connessione permanente a esecuzione prolungata.</span><span class="sxs-lookup"><span data-stu-id="76c50-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection.</span></span> <span data-ttu-id="76c50-107">Tramite tale connessione, vengono inviati più messaggi e possono essere elaborati singolarmente.</span><span class="sxs-lookup"><span data-stu-id="76c50-107">Over that connection, multiple messages are sent, and can be processed, individually.</span></span>

<span data-ttu-id="76c50-108">È inoltre possibile `stream` utilizzare la funzionalità per i dati temporali a esecuzione prolungata, ad esempio notifiche o messaggi di log.</span><span class="sxs-lookup"><span data-stu-id="76c50-108">You can also use the `stream` feature for long-running temporal data such as notifications or log messages.</span></span> <span data-ttu-id="76c50-109">Ma questo capitolo prenderà in considerazione il suo utilizzo per la restituzione di un singolo set di dati.</span><span class="sxs-lookup"><span data-stu-id="76c50-109">But this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="76c50-110">La che è consigliabile utilizzare dipende da fattori quali:</span><span class="sxs-lookup"><span data-stu-id="76c50-110">Which you should use depends on factors such as:</span></span>

- <span data-ttu-id="76c50-111">Dimensioni complessive del set di dati.</span><span class="sxs-lookup"><span data-stu-id="76c50-111">The overall size of the dataset.</span></span>
- <span data-ttu-id="76c50-112">Tempo impiegato per creare il set di dati alla fine del client o del server.</span><span class="sxs-lookup"><span data-stu-id="76c50-112">The time it took to create the dataset at either the client or server end.</span></span>
- <span data-ttu-id="76c50-113">Se il consumer del set di dati può iniziare a agire su di esso non appena il primo elemento è disponibile o ha bisogno dell'intero set di dati per eseguire qualsiasi operazione utile.</span><span class="sxs-lookup"><span data-stu-id="76c50-113">Whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="76c50-114">Quando utilizzare `repeated` i campi</span><span class="sxs-lookup"><span data-stu-id="76c50-114">When to use `repeated` fields</span></span>

<span data-ttu-id="76c50-115">Per qualsiasi set di dati che è vincolato in dimensioni e che può essere generato nella `repeated` sua interezza in un breve periodo di tempo, ad esempio, in meno di un secondo, è necessario utilizzare un campo in un normale messaggio Protobuf.</span><span class="sxs-lookup"><span data-stu-id="76c50-115">For any dataset that's constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="76c50-116">Ad esempio, in un sistema di e-commerce, per creare un elenco di elementi all'interno di un ordine è probabilmente veloce e l'elenco non sarà molto grande.</span><span class="sxs-lookup"><span data-stu-id="76c50-116">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="76c50-117">La restituzione di `repeated` un singolo messaggio con un campo `stream` è un ordine di grandezza più veloce rispetto all'utilizzo e comporta un sovraccarico di rete inferiore.</span><span class="sxs-lookup"><span data-stu-id="76c50-117">Returning a single message with a `repeated` field is an order of magnitude faster than using `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="76c50-118">Se il client necessita di tutti i dati prima di iniziare a elaborarli `repeated` e il set di dati è sufficientemente piccolo da costruire in memoria, è consigliabile usare un campo.</span><span class="sxs-lookup"><span data-stu-id="76c50-118">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field.</span></span> <span data-ttu-id="76c50-119">Considerarlo anche se la creazione del set di dati in memoria sul server è più lenta.</span><span class="sxs-lookup"><span data-stu-id="76c50-119">Consider it even if the creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="76c50-120">Quando usare `stream` i metodi</span><span class="sxs-lookup"><span data-stu-id="76c50-120">When to use `stream` methods</span></span>

<span data-ttu-id="76c50-121">Quando gli oggetti messaggio nei set di dati sono potenzialmente molto grandi, è consigliabile trasferirli tramite richieste di streaming o risposte.</span><span class="sxs-lookup"><span data-stu-id="76c50-121">When the message objects in your datasets are potentially very large, it's best for you transfer them by using streaming requests or responses.</span></span> <span data-ttu-id="76c50-122">È più efficiente costruire un oggetto di grandi dimensioni in memoria, scriverlo nella rete e quindi liberare le risorse.</span><span class="sxs-lookup"><span data-stu-id="76c50-122">It's more efficient to construct a large object in memory, write it to the network, and then free up the resources.</span></span> <span data-ttu-id="76c50-123">Questo approccio migliorerà la scalabilità del servizio.</span><span class="sxs-lookup"><span data-stu-id="76c50-123">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="76c50-124">Analogamente, è consigliabile inviare set di dati di dimensioni non vincolate su flussi per evitare di esaurire la memoria durante la costruzione.</span><span class="sxs-lookup"><span data-stu-id="76c50-124">Similarly, you should send datasets of unconstrained size over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="76c50-125">Per i set di dati in cui il consumer può elaborare separatamente ogni elemento, è consigliabile usare un flusso se significa che lo stato di avanzamento può essere indicato all'utente.</span><span class="sxs-lookup"><span data-stu-id="76c50-125">For datasets where the consumer can separately process each item, you should consider using a stream if it means that progress can be indicated to the user.</span></span> <span data-ttu-id="76c50-126">L'uso di un flusso può migliorare la velocità di risposta di un'applicazione, ma è consigliabile bilanciarla con le prestazioni complessive dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="76c50-126">Using a stream can improve the responsiveness of an application, but you should balance it against the overall performance of the application.</span></span>

<span data-ttu-id="76c50-127">Un altro scenario in cui i flussi possono essere utili è il punto in cui un messaggio viene elaborato tra più servizi.</span><span class="sxs-lookup"><span data-stu-id="76c50-127">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="76c50-128">Se ogni servizio in una catena restituisce un flusso, il servizio terminal (ovvero l'ultimo nella catena) può iniziare a restituire messaggi.</span><span class="sxs-lookup"><span data-stu-id="76c50-128">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages.</span></span> <span data-ttu-id="76c50-129">Questi messaggi possono essere elaborati e passati lungo la catena al richiedente originale.</span><span class="sxs-lookup"><span data-stu-id="76c50-129">These messages can be processed and passed back along the chain to the original requestor.</span></span> <span data-ttu-id="76c50-130">Il richiedente può restituire un flusso o aggregare i risultati in un singolo messaggio di risposta.</span><span class="sxs-lookup"><span data-stu-id="76c50-130">The requestor can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="76c50-131">Questo approccio si presta bene a modelli come MapReduce.This approach preends itself well to patterns like MapReduce.</span><span class="sxs-lookup"><span data-stu-id="76c50-131">This approach lends itself well to patterns like MapReduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="76c50-132">[Successivo](migrate-duplex-services.md)
>[precedente](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="76c50-132">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
