---
title: Identificazione dei limiti del modello di dominio per ogni microservizio
description: Esplorare l'essenza del partizionamento di un'applicazione di grandi dimensioni in microservizi per ottenere un'architettura solida.
ms.date: 09/20/2018
ms.openlocfilehash: 9c433066dd8e93dbb09b15e58c9c85617775723d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/14/2020
ms.locfileid: "71834410"
---
# <a name="identify-domain-model-boundaries-for-each-microservice"></a><span data-ttu-id="5cc7c-103">Identificare i limiti del modello di dominio per ogni microservizio</span><span class="sxs-lookup"><span data-stu-id="5cc7c-103">Identify domain-model boundaries for each microservice</span></span>

<span data-ttu-id="5cc7c-104">L'obiettivo durante l'identificazione dei limiti e delle dimensioni del modello per ogni microservizio non è quello di ottenere la separazione più granulare possibile, benché sia consigliabile, se possibile, tendere a microservizi di piccole dimensioni,</span><span class="sxs-lookup"><span data-stu-id="5cc7c-104">The goal when identifying model boundaries and size for each microservice isn't to get to the most granular separation possible, although you should tend toward small microservices if possible.</span></span> <span data-ttu-id="5cc7c-105">ma piuttosto quello di ottenere la separazione più significativa guidata dalla propria conoscenza del dominio.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-105">Instead, your goal should be to get to the most meaningful separation guided by your domain knowledge.</span></span> <span data-ttu-id="5cc7c-106">L'accento viene posto non sulle dimensioni, ma piuttosto sulle funzionalità aziendali.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-106">The emphasis isn't on the size, but instead on business capabilities.</span></span> <span data-ttu-id="5cc7c-107">Per di più, se è necessaria una chiara coesione per una determinata area dell'applicazione basata su un numero elevato di dipendenze, si evince la necessità di un singolo microservizio.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-107">In addition, if there's clear cohesion needed for a certain area of the application based on a high number of dependencies, that indicates the need for a single microservice, too.</span></span> <span data-ttu-id="5cc7c-108">La coesione è un modo per identificare come suddividere o raggruppare i microservizi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-108">Cohesion is a way to identify how to break apart or group together microservices.</span></span> <span data-ttu-id="5cc7c-109">In definitiva, mentre si acquisiscono altre informazioni sul dominio, occorre adattare le dimensioni del microservizio in modo iterativo.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-109">Ultimately, while you gain more knowledge about the domain, you should adapt the size of your microservice, iteratively.</span></span> <span data-ttu-id="5cc7c-110">Trovare le dimensioni giuste non è un processo facile.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-110">Finding the right size isn't a one-shot process.</span></span>

<span data-ttu-id="5cc7c-111">[Sam Newman](https://samnewman.io/), promotore riconosciuto dei microservizi e autore del libro [Building Microservices](https://samnewman.io/books/building_microservices/), evidenzia la necessità di progettare i propri microservizi in base allo schema Bounded Context (BC), cioè una parte della progettazione basata su domini, già introdotta in precedenza.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-111">[Sam Newman](https://samnewman.io/), a recognized promoter of microservices and author of the book [Building Microservices](https://samnewman.io/books/building_microservices/), highlights that you should design your microservices based on the Bounded Context (BC) pattern (part of domain-driven design), as introduced earlier.</span></span> <span data-ttu-id="5cc7c-112">In alcuni casi, un BC potrebbe essere composto da diversi servizi fisici, ma non viceversa.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-112">Sometimes, a BC could be composed of several physical services, but not vice versa.</span></span>

<span data-ttu-id="5cc7c-113">Un modello di dominio con entità di dominio specifiche si applica all'interno di un BC o microservizio concreto.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-113">A domain model with specific domain entities applies within a concrete BC or microservice.</span></span> <span data-ttu-id="5cc7c-114">Un BC delimita l'applicabilità di un modello di dominio e offre ai membri del team di sviluppo una comprensione chiara e condivisa di ciò che deve essere coeso e di ciò che può essere sviluppato in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-114">A BC delimits the applicability of a domain model and gives developer team members a clear and shared understanding of what must be cohesive and what can be developed independently.</span></span> <span data-ttu-id="5cc7c-115">Sono gli stessi obiettivi per i microservizi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-115">These are the same goals for microservices.</span></span>

<span data-ttu-id="5cc7c-116">Un altro strumento che informa la scelta di progettazione è la [legge di Conway](https://en.wikipedia.org/wiki/Conway%27s_law), che asserisce che un'applicazione rifletterà i limiti sociali dell'organizzazione che l'ha prodotta.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-116">Another tool that informs your design choice is [Conway's law](https://en.wikipedia.org/wiki/Conway%27s_law), which states that an application will reflect the social boundaries of the organization that produced it.</span></span> <span data-ttu-id="5cc7c-117">Ma in alcuni casi è vero il contrario: l'organizzazione dell'azienda è costituita dal software.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-117">But sometimes the opposite is true -the company's organization is formed by the software.</span></span> <span data-ttu-id="5cc7c-118">Potrebbe essere necessario invertire la legge di Conway e creare i limiti nel modo in cui si vuole organizzare l'azienda, propendendo per la consulenza sui processi aziendali.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-118">You might need to reverse Conway's law and build the boundaries the way you want the company to be organized, leaning toward business process consulting.</span></span>

<span data-ttu-id="5cc7c-119">Per identificare i contesti limitati, è possibile usare uno schema DDD denominato [Context Mapping](https://www.infoq.com/articles/ddd-contextmapping), ovvero "mapping del contesto".</span><span class="sxs-lookup"><span data-stu-id="5cc7c-119">To identify bounded contexts, you can use a DDD pattern called the [Context Mapping pattern](https://www.infoq.com/articles/ddd-contextmapping).</span></span> <span data-ttu-id="5cc7c-120">Con il mapping del contesto è possibile identificare i vari contesti nell'applicazione e nei relativi limiti.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-120">With Context Mapping, you identify the various contexts in the application and their boundaries.</span></span> <span data-ttu-id="5cc7c-121">È comune, ad esempio, avere contesto e limiti diversi per ogni piccolo sottosistema.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-121">It's common to have a different context and boundary for each small subsystem, for instance.</span></span> <span data-ttu-id="5cc7c-122">La mappa del contesto è un modo per definire e rendere espliciti tali limiti tra un dominio e l'altro.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-122">The Context Map is a way to define and make explicit those boundaries between domains.</span></span> <span data-ttu-id="5cc7c-123">Un BC è autonomo e include i dettagli di un singolo dominio, ad esempio le entità di dominio, e definisce i contratti di integrazione con altri BC.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-123">A BC is autonomous and includes the details of a single domain -details like the domain entities- and defines integration contracts with other BCs.</span></span> <span data-ttu-id="5cc7c-124">Questa operazione è simile alla definizione di un microservizio: è autonomo, implementa alcune funzionalità del dominio e deve specificare le interfacce.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-124">This is similar to the definition of a microservice: it's autonomous, it implements certain domain capability, and it must provide interfaces.</span></span> <span data-ttu-id="5cc7c-125">Ecco perché gli schemi Context Mapping e Bounded Context rappresentano ottimi approcci all'identificazione dei limiti del modello di dominio dei microservizi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-125">This is why Context Mapping and the Bounded Context pattern are good approaches for identifying the domain model boundaries of your microservices.</span></span>

<span data-ttu-id="5cc7c-126">Quando si progetta un'applicazione di grandi dimensioni, viene visualizzato il modo in cui è possibile frammentare il modello di dominio. Ad esempio, un esperto di dominio dal dominio del catalogo assegnerà nomi diversi alle entità nei domini del catalogo e dell'inventario rispetto a un esperto dei domini di spedizione.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-126">When designing a large application, you'll see how its domain model can be fragmented - a domain expert from the catalog domain will name entities differently in the catalog and inventory domains than a shipping domain expert, for instance.</span></span> <span data-ttu-id="5cc7c-127">In alternativa, l'entità del dominio utente potrebbe differire nelle dimensioni e nel numero di attributi quando gestita da un esperto CRM che volesse archiviare ogni dettaglio sul cliente rispetto a un esperto di dominio che necessitasse solo di dati parziali sul cliente.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-127">Or the user domain entity might be different in size and number of attributes when dealing with a CRM expert who wants to store every detail about the customer than for an ordering domain expert who just needs partial data about the customer.</span></span> <span data-ttu-id="5cc7c-128">È molto difficile evitare ambiguità tra tutti i termini di dominio in tutti i domini correlati a un'applicazione di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-128">It's very hard to disambiguate all domain terms across all the domains related to a large application.</span></span> <span data-ttu-id="5cc7c-129">Ma la cosa più importante è che non si deve provare a unificare i termini.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-129">But the most important thing is that you shouldn't try to unify the terms.</span></span> <span data-ttu-id="5cc7c-130">Accettare invece le differenze e la ricchezza offerte da ogni dominio.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-130">Instead, accept the differences and richness provided by each domain.</span></span> <span data-ttu-id="5cc7c-131">Se si prova a unificare un database per l'intera applicazione, i tentativi di ottenere un vocabolario unificato saranno maldestri e non avranno alcun significato per nessuno degli esperti di domini.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-131">If you try to have a unified database for the whole application, attempts at a unified vocabulary will be awkward and won't sound right to any of the multiple domain experts.</span></span> <span data-ttu-id="5cc7c-132">Di conseguenza, i BC (implementati come microservizi) aiutano a chiarire dove è possibile usare alcuni termini di dominio e dove è invece necessario suddividere il sistema e creare altri BC con domini diversi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-132">Therefore, BCs (implemented as microservices) will help you to clarify where you can use certain domain terms and where you'll need to split the system and create additional BCs with different domains.</span></span>

<span data-ttu-id="5cc7c-133">Si può dedurre che sono stati ottenuti i limiti e le dimensioni giusti per ogni BC e modello di dominio quando sono presenti poche relazioni forti tra modelli di dominio e solitamente non è necessario unire le informazioni di più modelli di dominio quando si eseguono operazioni di applicazioni tipiche.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-133">You'll know that you got the right boundaries and sizes of each BC and domain model if you have few strong relationships between domain models, and you do not usually need to merge information from multiple domain models when performing typical application operations.</span></span>

<span data-ttu-id="5cc7c-134">Probabilmente la risposta migliore alla domanda su quali dovrebbero essere le dimensioni di un modello di dominio per ogni microservizio è la seguente: deve contenere un BC autonomo, che consente di lavorare senza dover continuamente passare ad altri contesti (altri modelli di microservizio).</span><span class="sxs-lookup"><span data-stu-id="5cc7c-134">Perhaps the best answer to the question of how large a domain model for each microservice should be is the following: it should have an autonomous BC, as isolated as possible, that enables you to work without having to constantly switch to other contexts (other microservice's models).</span></span> <span data-ttu-id="5cc7c-135">Nella figura 4-10 è possibile osservare che ciascuno dei molteplici microservizi (più BC) ha il proprio modello e che è possibile definire le relative entità, a seconda dei requisiti specifici per ognuno dei domini identificati nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-135">In Figure 4-10, you can see how multiple microservices (multiple BCs) each has their own model and how their entities can be defined, depending on the specific requirements for each of the identified domains in your application.</span></span>

![Diagramma che mostra le entità in diversi contorni del modello.](./media/identify-microservice-domain-model-boundaries/identify-entities-microservice-model-boundries.png)

<span data-ttu-id="5cc7c-137">**Figura 4-10**.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-137">**Figure 4-10**.</span></span> <span data-ttu-id="5cc7c-138">Identificazione di entità e dei limiti del modello di microservizio</span><span class="sxs-lookup"><span data-stu-id="5cc7c-138">Identifying entities and microservice model boundaries</span></span>

<span data-ttu-id="5cc7c-139">La figura 4-10 illustra un esempio di scenario correlato a un sistema di gestione di conferenze online.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-139">Figure 4-10 illustrates a sample scenario related to an online conference management system.</span></span> <span data-ttu-id="5cc7c-140">La stessa entità viene visualizzata come "Utenti", "Acquirenti", "Pagamenti" e "Clienti" a seconda del contesto limitato.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-140">The same entity appears as "Users", "Buyers", "Payers", and "Customers" depending on the bounded context.</span></span> <span data-ttu-id="5cc7c-141">Sono stati identificati diversi BC implementabili come microservizi, in base ai domini definiti per l'utente dagli esperti di dominio.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-141">You've identified several BCs that could be implemented as microservices, based on domains that domain experts defined for you.</span></span> <span data-ttu-id="5cc7c-142">Come si può notare, ci sono entità presenti solo in un modello di microservizio singolo, ad esempio Payments nel microservizio Payment,</span><span class="sxs-lookup"><span data-stu-id="5cc7c-142">As you can see, there are entities that are present just in a single microservice model, like Payments in the Payment microservice.</span></span> <span data-ttu-id="5cc7c-143">che saranno facili da implementare.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-143">Those will be easy to implement.</span></span>

<span data-ttu-id="5cc7c-144">Tuttavia, potrebbero esserci anche entità con una forma differente, ma che condividono la stessa identità tra più modelli di dominio di più microservizi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-144">However, you might also have entities that have a different shape but share the same identity across the multiple domain models from the multiple microservices.</span></span> <span data-ttu-id="5cc7c-145">Ad esempio, l'entità User viene identificata nel microservizio Conferences Management.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-145">For example, the User entity is identified in the Conferences Management microservice.</span></span> <span data-ttu-id="5cc7c-146">Lo stesso utente, con la stessa identità, è quello denominato Buyers nel microservizio degli ordini o Payer nel microservizio Payment, e persino quello denominato Customer nel microservizio Customer Service.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-146">That same user, with the same identity, is the one named Buyers in the Ordering microservice, or the one named Payer in the Payment microservice, and even the one named Customer in the Customer Service microservice.</span></span> <span data-ttu-id="5cc7c-147">Questo avviene perché, a seconda del [linguaggio comune](https://martinfowler.com/bliki/UbiquitousLanguage.html) usato da ogni esperto di dominio, un utente potrebbe avere una prospettiva diversa, anche con attributi diversi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-147">This is because, depending on the [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) that each domain expert is using, a user might have a different perspective even with different attributes.</span></span> <span data-ttu-id="5cc7c-148">L'entità utente nel modello di microservizio denominato Conferences Management potrebbe contenere la maggior parte dei relativi attributi dati personali.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-148">The user entity in the microservice model named Conferences Management might have most of its personal data attributes.</span></span> <span data-ttu-id="5cc7c-149">Tuttavia, lo stesso utente sotto forma di Payer nel microservizio Payment o sotto forma di Customer nel microservizio Customer Service potrebbe non aver bisogno dello stesso elenco di attributi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-149">However, that same user in the shape of Payer in the microservice Payment or in the shape of Customer in the microservice Customer Service might not need the same list of attributes.</span></span>

<span data-ttu-id="5cc7c-150">Un approccio simile è illustrato nella figura 4-11.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-150">A similar approach is illustrated in Figure 4-11.</span></span>

![Diagramma che illustra come scomporre un modello di dati in più modelli di dominio.](./media/identify-microservice-domain-model-boundaries/decompose-traditional-data-models.png)

<span data-ttu-id="5cc7c-152">**Figura 4-11**.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-152">**Figure 4-11**.</span></span> <span data-ttu-id="5cc7c-153">Scomposizione di modelli di dati tradizionali in più modelli di dominio</span><span class="sxs-lookup"><span data-stu-id="5cc7c-153">Decomposing traditional data models into multiple domain models</span></span>

<span data-ttu-id="5cc7c-154">Quando si scompone un modello di dati tradizionali tra contesti delimitati, è possibile avere diverse entità che condividono la stessa identità (un acquirente è anche un utente) con attributi diversi in ogni contesto delimitato.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-154">When decomposing a traditional data model between bounded contexts, you can have different entities that share the same identity (a buyer is also a user) with different attributes in each bounded context.</span></span> <span data-ttu-id="5cc7c-155">Come si può osservare, l'utente è presente nel modello di microservizio Conferences Management come entità User, ma anche sotto forma di entità Buyer nel microservizio Pricing, con attributi o dettagli alternativi sull'utente quando si tratta effettivamente di un acquirente.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-155">You can see how the user is present in the Conferences Management microservice model as the User entity and is also present in the form of the Buyer entity in the Pricing microservice, with alternate attributes or details about the user when it's actually a buyer.</span></span> <span data-ttu-id="5cc7c-156">Ogni microservizio o BC potrebbe non necessitare di tutti i dati relativi a un'entità User, ma solo di parte di essi, a seconda del contesto o del problema da risolvere.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-156">Each microservice or BC might not need all the data related to a User entity, just part of it, depending on the problem to solve or the context.</span></span> <span data-ttu-id="5cc7c-157">Ad esempio, nel modello di microservizio Pricing, non è necessario l'indirizzo o il nome dell'utente, ma sono sufficienti solo l'ID (come identità) e lo stato, che avranno un impatto sugli sconti quando si determinano i prezzi delle postazioni per ogni acquirente.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-157">For instance, in the Pricing microservice model, you do not need the address or the name of the user, just the ID (as identity) and Status, which will have an impact on discounts when pricing the seats per buyer.</span></span>

<span data-ttu-id="5cc7c-158">L'entità Seat ha lo stesso nome, ma diversi attributi in ciascun modello di dominio.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-158">The Seat entity has the same name but different attributes in each domain model.</span></span> <span data-ttu-id="5cc7c-159">Tuttavia, questa entità condivide l'identità basata sullo stesso ID, così come accade con User e Buyer.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-159">However, Seat shares identity based on the same ID, as happens with User and Buyer.</span></span>

<span data-ttu-id="5cc7c-160">In pratica, è un concetto condiviso di utente esistente in più servizi (domini), che condividono tutti l'identità di tale utente.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-160">Basically, there's a shared concept of a user that exists in multiple services (domains), which all share the identity of that user.</span></span> <span data-ttu-id="5cc7c-161">Ma in ogni modello di dominio potrebbero essere presenti informazioni aggiuntive o diverse su tale entità utente.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-161">But in each domain model there might be additional or different details about the user entity.</span></span> <span data-ttu-id="5cc7c-162">Di conseguenza, deve esserci un modo per eseguire il mapping di un'entità utente da un dominio (microservizio) a un altro.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-162">Therefore, there needs to be a way to map a user entity from one domain (microservice) to another.</span></span>

<span data-ttu-id="5cc7c-163">La mancata condivisione tra domini della stessa entità utente con lo stesso numero di attributi comporta diversi vantaggi.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-163">There are several benefits to not sharing the same user entity with the same number of attributes across domains.</span></span> <span data-ttu-id="5cc7c-164">Uno dei vantaggi consiste nella riduzione delle duplicazioni, così che i modelli di microservizio non contengano alcun dato superfluo.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-164">One benefit is to reduce duplication, so that microservice models do not have any data that they do not need.</span></span> <span data-ttu-id="5cc7c-165">Un altro vantaggio consiste nell'avere un microservizio master che sia proprietario di un certo tipo di dati per ogni entità, in modo che gli aggiornamenti e le query per tale tipo di dati siano basati solo su tale microservizio.</span><span class="sxs-lookup"><span data-stu-id="5cc7c-165">Another benefit is having a master microservice that owns a certain type of data per entity so that updates and queries for that type of data are driven only by that microservice.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="5cc7c-166">[Successivo](distributed-data-management.md)
>[precedente](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span><span class="sxs-lookup"><span data-stu-id="5cc7c-166">[Previous](distributed-data-management.md)
[Next](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span></span>
