---
title: Creazione, evoluzione e controllo delle versioni di API e contratti dei microservizi
description: Creare API e contratti dei microservizi tenendo in considerazione l'evoluzione e il controllo delle versioni poiché le esigenze cambiano.
ms.date: 09/20/2018
ms.openlocfilehash: 1972d02d8bf7935c71bfd383707ae19ea2baded9
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/14/2020
ms.locfileid: "68672898"
---
# <a name="creating-evolving-and-versioning-microservice-apis-and-contracts"></a><span data-ttu-id="beba9-103">Creazione, evoluzione e controllo delle versioni di API e contratti dei microservizi</span><span class="sxs-lookup"><span data-stu-id="beba9-103">Creating, evolving, and versioning microservice APIs and contracts</span></span>

<span data-ttu-id="beba9-104">Un'API di microservizio è un contratto tra il servizio e i relativi client.</span><span class="sxs-lookup"><span data-stu-id="beba9-104">A microservice API is a contract between the service and its clients.</span></span> <span data-ttu-id="beba9-105">Sarà possibile sviluppare un microservizio in modo indipendente solo se non si infrange il contratto API, ecco perché il contratto riveste un'importanza particolare.</span><span class="sxs-lookup"><span data-stu-id="beba9-105">You'll be able to evolve a microservice independently only if you do not break its API contract, which is why the contract is so important.</span></span> <span data-ttu-id="beba9-106">Se si modifica il contratto, ci saranno ripercussioni sulle applicazioni client o sul gateway API.</span><span class="sxs-lookup"><span data-stu-id="beba9-106">If you change the contract, it will impact your client applications or your API Gateway.</span></span>

<span data-ttu-id="beba9-107">La natura della definizione dell'API dipende dal protocollo in uso.</span><span class="sxs-lookup"><span data-stu-id="beba9-107">The nature of the API definition depends on which protocol you're using.</span></span> <span data-ttu-id="beba9-108">Ad esempio, se si usa la messaggistica (come [AMQP](https://www.amqp.org/)), l'API è costituita dai tipi di messaggio.</span><span class="sxs-lookup"><span data-stu-id="beba9-108">For instance, if you're using messaging (like [AMQP](https://www.amqp.org/)), the API consists of the message types.</span></span> <span data-ttu-id="beba9-109">Se si usano i servizi HTTP e RESTful, l'API è costituita dagli URL e dai formati JSON delle richieste e delle risposte.</span><span class="sxs-lookup"><span data-stu-id="beba9-109">If you're using HTTP and RESTful services, the API consists of the URLs and the request and response JSON formats.</span></span>

<span data-ttu-id="beba9-110">Tuttavia, anche se si effettua una scelta ponderata del contratto iniziale, un'API del servizio dovrà necessariamente evolversi nel tempo.</span><span class="sxs-lookup"><span data-stu-id="beba9-110">However, even if you're thoughtful about your initial contract, a service API will need to change over time.</span></span> <span data-ttu-id="beba9-111">Quando ciò accade, in particolare se si tratta di un'API pubblica usata da più applicazioni client, in genere non è possibile imporre a tutti i client di eseguire l'aggiornamento al nuovo contratto API.</span><span class="sxs-lookup"><span data-stu-id="beba9-111">When that happens—and especially if your API is a public API consumed by multiple client applications — you typically can't force all clients to upgrade to your new API contract.</span></span> <span data-ttu-id="beba9-112">Di norma, occorre procedere a una distribuzione incrementale delle nuove versioni di un servizio, in modo che vengano eseguite contemporaneamente sia le nuove versioni di un contratto di servizio che quelle precedenti.</span><span class="sxs-lookup"><span data-stu-id="beba9-112">You usually need to incrementally deploy new versions of a service in a way that both old and new versions of a service contract are running simultaneously.</span></span> <span data-ttu-id="beba9-113">Quindi, è importante disporre di una strategia per il controllo delle versioni del servizio.</span><span class="sxs-lookup"><span data-stu-id="beba9-113">Therefore, it's important to have a strategy for your service versioning.</span></span>

<span data-ttu-id="beba9-114">Quando le modifiche dell'API sono di lieve entità, ad esempio in caso di aggiunta di attributi o di parametri all'API, i client che usano un'API precedente dovrebbero eseguire l'aggiornamento e usare la nuova versione del servizio.</span><span class="sxs-lookup"><span data-stu-id="beba9-114">When the API changes are small, like if you add attributes or parameters to your API, clients that use an older API should switch and work with the new version of the service.</span></span> <span data-ttu-id="beba9-115">Potrebbe essere possibile fornire valori predefiniti per tutti gli attributi mancanti richiesti e i client potrebbero ignorare eventuali attributi di risposta aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="beba9-115">You might be able to provide default values for any missing attributes that are required, and the clients might be able to ignore any extra response attributes.</span></span>

<span data-ttu-id="beba9-116">Tuttavia, talvolta è necessario apportare modifiche sostanziali e incompatibili a un'API del servizio.</span><span class="sxs-lookup"><span data-stu-id="beba9-116">However, sometimes you need to make major and incompatible changes to a service API.</span></span> <span data-ttu-id="beba9-117">Dal momento che potrebbe non essere possibile imporre ai servizi o alle applicazioni client di eseguire immediatamente l'aggiornamento alla nuova versione, un servizio deve essere in grado di supportare le versioni precedenti dell'API per un determinato periodo.</span><span class="sxs-lookup"><span data-stu-id="beba9-117">Because you might not be able to force client applications or services to upgrade immediately to the new version, a service must support older versions of the API for some period.</span></span> <span data-ttu-id="beba9-118">Se si usa un meccanismo basato su HTTP, ad esempio REST, un approccio possibile è incorporare il numero di versione dell'API nell'URL o in un'intestazione HTTP.</span><span class="sxs-lookup"><span data-stu-id="beba9-118">If you're using an HTTP-based mechanism such as REST, one approach is to embed the API version number in the URL or into an HTTP header.</span></span> <span data-ttu-id="beba9-119">È quindi possibile scegliere se implementare entrambe le versioni del servizio contemporaneamente nella stessa istanza del servizio o distribuire istanze diverse che gestiscono le differenti versioni dell'API.</span><span class="sxs-lookup"><span data-stu-id="beba9-119">Then you can decide between implementing both versions of the service simultaneously within the same service instance, or deploying different instances that each handle a version of the API.</span></span> <span data-ttu-id="beba9-120">Un approccio valido potrebbe essere lo [schema Mediator](https://en.wikipedia.org/wiki/Mediator_pattern) (ad esempio, la [libreria MediatR](https://github.com/jbogard/MediatR)), che consente di separare le diverse versioni dell'implementazione in gestori indipendenti.</span><span class="sxs-lookup"><span data-stu-id="beba9-120">A good approach for this is the [Mediator pattern](https://en.wikipedia.org/wiki/Mediator_pattern) (for example, [MediatR library](https://github.com/jbogard/MediatR)) to decouple the different implementation versions into independent handlers.</span></span>

<span data-ttu-id="beba9-121">Infine, se si usa un'architettura REST, [Hypermedia](https://www.infoq.com/articles/mark-baker-hypermedia) è la soluzione migliore per garantire il controllo delle versioni dei servizi e consentire l'uso di API in grado di evolversi.</span><span class="sxs-lookup"><span data-stu-id="beba9-121">Finally, if you're using a REST architecture, [Hypermedia](https://www.infoq.com/articles/mark-baker-hypermedia) is the best solution for versioning your services and allowing evolvable APIs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="beba9-122">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="beba9-122">Additional resources</span></span>

- <span data-ttu-id="beba9-123">**Scott Hanselman. ASP.NET il controllo delle versioni delle API Web RESTful di base semplificato** </span><span class="sxs-lookup"><span data-stu-id="beba9-123">**Scott Hanselman. ASP.NET Core RESTful Web API versioning made easy** </span></span>\
  <https://www.hanselman.com/blog/ASPNETCoreRESTfulWebAPIVersioningMadeEasy.aspx>

- <span data-ttu-id="beba9-124">**Controllo delle versioni di un'API Web RESTfulVersioning a RESTful web API** </span><span class="sxs-lookup"><span data-stu-id="beba9-124">**Versioning a RESTful web API** </span></span>\
  <https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api>

- <span data-ttu-id="beba9-125">**Roy Fielding. Controllo delle versioni, Hypermedia e RESTVersioning, Hypermedia, and REST** </span><span class="sxs-lookup"><span data-stu-id="beba9-125">**Roy Fielding. Versioning, Hypermedia, and REST** </span></span>\
  <https://www.infoq.com/articles/roy-fielding-on-versioning>

>[!div class="step-by-step"]
><span data-ttu-id="beba9-126">[Successivo](asynchronous-message-based-communication.md)
>[precedente](microservices-addressability-service-registry.md)</span><span class="sxs-lookup"><span data-stu-id="beba9-126">[Previous](asynchronous-message-based-communication.md)
[Next](microservices-addressability-service-registry.md)</span></span>
