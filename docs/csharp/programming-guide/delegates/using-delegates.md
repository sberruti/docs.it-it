---
title: Uso dei delegati - Guida per programmatori C#
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [C#], how to use
ms.assetid: 99a2fc27-a32e-4a34-921c-e65497520eec
ms.openlocfilehash: dcc73aba738d6296a44c48aad8b66cd6fc7f4a7b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/14/2020
ms.locfileid: "77448439"
---
# <a name="using-delegates-c-programming-guide"></a><span data-ttu-id="6ac4e-102">Utilizzo di delegati (Guida per programmatori C#)</span><span class="sxs-lookup"><span data-stu-id="6ac4e-102">Using Delegates (C# Programming Guide)</span></span>

<span data-ttu-id="6ac4e-103">Un [delegato](../../language-reference/builtin-types/reference-types.md) è un tipo che incapsula in modo sicuro un metodo, simile a un puntatore a funzione in C e C++.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-103">A [delegate](../../language-reference/builtin-types/reference-types.md) is a type that safely encapsulates a method, similar to a function pointer in C and C++.</span></span> <span data-ttu-id="6ac4e-104">A differenza dei puntatori a funzione, tuttavia, i delegati sono orientati a oggetti, indipendenti dai tipi e sicuri.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-104">Unlike C function pointers, delegates are object-oriented, type safe, and secure.</span></span> <span data-ttu-id="6ac4e-105">Il tipo delegato è definito dal nome del delegato.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-105">The type of a delegate is defined by the name of the delegate.</span></span> <span data-ttu-id="6ac4e-106">Nell'esempio seguente viene dichiarato un delegato denominato `Del` che può incapsulare un metodo che accetta una [stringa](../../language-reference/builtin-types/reference-types.md) come argomento e restituisce [void](../../language-reference/builtin-types/void.md):</span><span class="sxs-lookup"><span data-stu-id="6ac4e-106">The following example declares a delegate named `Del` that can encapsulate a method that takes a [string](../../language-reference/builtin-types/reference-types.md) as an argument and returns [void](../../language-reference/builtin-types/void.md):</span></span>

[!code-csharp[csProgGuideDelegates#21](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#21)]

<span data-ttu-id="6ac4e-107">Un oggetto delegato viene normalmente creato fornendo il nome del metodo di cui il delegato eseguirà il wrapping o con una [funzione anonima](../statements-expressions-operators/anonymous-functions.md).</span><span class="sxs-lookup"><span data-stu-id="6ac4e-107">A delegate object is normally constructed by providing the name of the method the delegate will wrap, or with an [anonymous function](../statements-expressions-operators/anonymous-functions.md).</span></span> <span data-ttu-id="6ac4e-108">Una volta che viene creata un'istanza di un delegato, una chiamata al metodo effettuata al delegato verrà passata dal delegato a tale metodo.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-108">Once a delegate is instantiated, a method call made to the delegate will be passed by the delegate to that method.</span></span> <span data-ttu-id="6ac4e-109">I parametri passati al delegato dal chiamante vengono passati al metodo e il valore restituito, se presente, dal metodo viene restituito al chiamante dal delegato.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-109">The parameters passed to the delegate by the caller are passed to the method, and the return value, if any, from the method is returned to the caller by the delegate.</span></span> <span data-ttu-id="6ac4e-110">Questa operazione è nota come richiamare il delegato.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-110">This is known as invoking the delegate.</span></span> <span data-ttu-id="6ac4e-111">È possibile richiamare un delegato per cui è stata creata un'istanza come se fosse il metodo di wrapping stesso.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-111">An instantiated delegate can be invoked as if it were the wrapped method itself.</span></span> <span data-ttu-id="6ac4e-112">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-112">For example:</span></span>

[!code-csharp[csProgGuideDelegates#22](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#22)]  

[!code-csharp[csProgGuideDelegates#23](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#23)]

<span data-ttu-id="6ac4e-113">Tipi delegati vengono derivati dalla classe <xref:System.Delegate> di.NET Framework.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-113">Delegate types are derived from the <xref:System.Delegate> class in the .NET Framework.</span></span> <span data-ttu-id="6ac4e-114">I tipi delegati sono [sealed](../../language-reference/keywords/sealed.md), ovvero non possono essere usati per la derivazione, e non è possibile derivare classi personalizzate da <xref:System.Delegate>.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-114">Delegate types are [sealed](../../language-reference/keywords/sealed.md)—they cannot be derived from— and it is not possible to derive custom classes from <xref:System.Delegate>.</span></span> <span data-ttu-id="6ac4e-115">Poiché l'istanza del delegato è un oggetto, può essere passata come parametro o assegnata a una proprietà.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-115">Because the instantiated delegate is an object, it can be passed as a parameter, or assigned to a property.</span></span> <span data-ttu-id="6ac4e-116">In questo modo un metodo può accettare un delegato come parametro e chiamare il delegato in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-116">This allows a method to accept a delegate as a parameter, and call the delegate at some later time.</span></span> <span data-ttu-id="6ac4e-117">Questa operazione è nota come callback asincrono ed è un metodo comune per notificare un chiamante al termine di un processo lungo.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-117">This is known as an asynchronous callback, and is a common method of notifying a caller when a long process has completed.</span></span> <span data-ttu-id="6ac4e-118">Quando un delegato viene usato in questo modo, per il codice che usa il delegato non è richiesta alcuna conoscenza dell'implementazione del metodo in uso.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-118">When a delegate is used in this fashion, the code using the delegate does not need any knowledge of the implementation of the method being used.</span></span> <span data-ttu-id="6ac4e-119">La funzionalità è simile all'incapsulamento fornito dalle interfacce.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-119">The functionality is similar to the encapsulation interfaces provide.</span></span>

<span data-ttu-id="6ac4e-120">Un altro utilizzo comune dei callback è la definizione di un metodo di confronto personalizzato e il passaggio di tale delegato a un metodo di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-120">Another common use of callbacks is defining a custom comparison method and passing that delegate to a sort method.</span></span> <span data-ttu-id="6ac4e-121">Consente al codice del chiamante di entrare a far parte dell'algoritmo di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-121">It allows the caller's code to become part of the sort algorithm.</span></span> <span data-ttu-id="6ac4e-122">Nell'esempio di metodo seguente viene usato il tipo `Del` come parametro:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-122">The following example method uses the `Del` type as a parameter:</span></span>

[!code-csharp[csProgGuideDelegates#24](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#24)]

<span data-ttu-id="6ac4e-123">È quindi possibile passare il delegato creato in precedenza a tale metodo:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-123">You can then pass the delegate created above to that method:</span></span>

[!code-csharp[csProgGuideDelegates#25](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#25)]

<span data-ttu-id="6ac4e-124">e visualizzare il seguente output sulla console:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-124">and receive the following output to the console:</span></span>

```console
The number is: 3
```

<span data-ttu-id="6ac4e-125">Usando il delegato come astrazione, non è necessario chiamare direttamente la console da `MethodWithCallback`, ovvero questo non deve essere progettato tenendo presente una console.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-125">Using the delegate as an abstraction, `MethodWithCallback` does not need to call the console directly—it does not have to be designed with a console in mind.</span></span> <span data-ttu-id="6ac4e-126">`MethodWithCallback` si limita a preparare una stringa e a passarla a un altro metodo.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-126">What `MethodWithCallback` does is simply prepare a string and pass the string to another method.</span></span> <span data-ttu-id="6ac4e-127">Questa operazione è particolarmente efficace perché un metodo delegato può usare qualsiasi numero di parametri.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-127">This is especially powerful since a delegated method can use any number of parameters.</span></span>

<span data-ttu-id="6ac4e-128">Quando viene creato un delegato per eseguire il wrapping di un metodo di istanza, il delegato fa riferimento sia all'istanza sia al metodo.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-128">When a delegate is constructed to wrap an instance method, the delegate references both the instance and the method.</span></span> <span data-ttu-id="6ac4e-129">Un delegato non ha alcuna conoscenza del tipo di istanza a parte il metodo di cui esegue il wrapping, perciò un delegato può fare riferimento a qualsiasi tipo di oggetto a condizione che vi sia un metodo su tale oggetto che corrisponda alla firma del delegato.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-129">A delegate has no knowledge of the instance type aside from the method it wraps, so a delegate can refer to any type of object as long as there is a method on that object that matches the delegate signature.</span></span> <span data-ttu-id="6ac4e-130">Quando viene creato un delegato per eseguire il wrapping di un metodo statico, fa riferimento solo al metodo.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-130">When a delegate is constructed to wrap a static method, it only references the method.</span></span> <span data-ttu-id="6ac4e-131">Si considerino le dichiarazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-131">Consider the following declarations:</span></span>

[!code-csharp[csProgGuideDelegates#26](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#26)]

<span data-ttu-id="6ac4e-132">Insieme al metodo statico `DelegateMethod` illustrato in precedenza, ci sono tre metodi di cui è possibile eseguire il wrapping in un'istanza di `Del`.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-132">Along with the static `DelegateMethod` shown previously, we now have three methods that can be wrapped by a `Del` instance.</span></span>

<span data-ttu-id="6ac4e-133">Un delegato può chiamare più di un metodo, quando viene richiamato.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-133">A delegate can call more than one method when invoked.</span></span> <span data-ttu-id="6ac4e-134">Questo processo viene definito multicasting.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-134">This is referred to as multicasting.</span></span> <span data-ttu-id="6ac4e-135">Per aggiungere un ulteriore metodo all'elenco dei metodi del delegato (l'elenco chiamate), è necessario semplicemente aggiungere due delegati usando gli operatori addizione o di assegnazione di addizione ("+" o "+=").</span><span class="sxs-lookup"><span data-stu-id="6ac4e-135">To add an extra method to the delegate's list of methods—the invocation list—simply requires adding two delegates using the addition or addition assignment operators ('+' or '+=').</span></span> <span data-ttu-id="6ac4e-136">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-136">For example:</span></span>

[!code-csharp[csProgGuideDelegates#27](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#27)]

<span data-ttu-id="6ac4e-137">A questo punto `allMethodsDelegate` contiene tre metodi nel relativo elenco chiamate: `Method1`, `Method2` e `DelegateMethod`.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-137">At this point `allMethodsDelegate` contains three methods in its invocation list—`Method1`, `Method2`, and `DelegateMethod`.</span></span> <span data-ttu-id="6ac4e-138">I tre delegati originali, `d1`, `d2` e `d3`, rimangono invariati.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-138">The original three delegates, `d1`, `d2`, and `d3`, remain unchanged.</span></span> <span data-ttu-id="6ac4e-139">Quando si richiama `allMethodsDelegate`, tutti e tre i metodi vengono chiamati nell'ordine.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-139">When `allMethodsDelegate` is invoked, all three methods are called in order.</span></span> <span data-ttu-id="6ac4e-140">Se il delegato usa parametri per riferimento, il riferimento viene passato in sequenza a ciascuno dei tre metodi a turno e le eventuali modifiche apportate da un solo metodo saranno visibili al metodo successivo.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-140">If the delegate uses reference parameters, the reference is passed sequentially to each of the three methods in turn, and any changes by one method are visible to the next method.</span></span> <span data-ttu-id="6ac4e-141">Quando uno dei metodi genera un'eccezione non rilevata all'interno del metodo, tale eccezione viene passata al chiamante del delegato e non verrà chiamato nessun metodo successivo nell'elenco chiamate.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-141">When any of the methods throws an exception that is not caught within the method, that exception is passed to the caller of the delegate and no subsequent methods in the invocation list are called.</span></span> <span data-ttu-id="6ac4e-142">Se il delegato ha un valore restituito e/o i parametri out, restituisce il valore restituito e i parametri dell'ultimo metodo richiamato.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-142">If the delegate has a return value and/or out parameters, it returns the return value and parameters of the last method invoked.</span></span> <span data-ttu-id="6ac4e-143">Per rimuovere un metodo dall'elenco chiamate, utilizzare gli operatori`-` `-=`di assegnazione di [sottrazione o sottrazione](../../language-reference/operators/subtraction-operator.md) ( o ).</span><span class="sxs-lookup"><span data-stu-id="6ac4e-143">To remove a method from the invocation list, use the [subtraction or subtraction assignment operators](../../language-reference/operators/subtraction-operator.md) (`-` or `-=`).</span></span> <span data-ttu-id="6ac4e-144">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-144">For example:</span></span>

[!code-csharp[csProgGuideDelegates#28](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#28)]

<span data-ttu-id="6ac4e-145">Poiché i tipi delegati vengono derivati da `System.Delegate`, i metodi e le proprietà definiti da tale classe possono essere chiamati sul delegato.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-145">Because delegate types are derived from `System.Delegate`, the methods and properties defined by that class can be called on the delegate.</span></span> <span data-ttu-id="6ac4e-146">Ad esempio, per trovare il numero di metodi nell'elenco chiamate di un delegato, è possibile scrivere:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-146">For example, to find the number of methods in a delegate's invocation list, you may write:</span></span>

[!code-csharp[csProgGuideDelegates#29](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#29)]

<span data-ttu-id="6ac4e-147">I delegati con più metodi nel relativo elenco chiamate derivano da <xref:System.MulticastDelegate>, cioè una sottoclasse di `System.Delegate`.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-147">Delegates with more than one method in their invocation list derive from <xref:System.MulticastDelegate>, which is a subclass of `System.Delegate`.</span></span> <span data-ttu-id="6ac4e-148">Il codice sopra riportato funziona in entrambi i casi, perché entrambe le classi supportano `GetInvocationList`.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-148">The above code works in either case because both classes support `GetInvocationList`.</span></span>

<span data-ttu-id="6ac4e-149">I delegati multicast vengono ampiamente usati nella gestione degli eventi.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-149">Multicast delegates are used extensively in event handling.</span></span> <span data-ttu-id="6ac4e-150">Gli oggetti di origine evento inviano notifiche di eventi agli oggetti destinatario registrati per ricevere l'evento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-150">Event source objects send event notifications to recipient objects that have registered to receive that event.</span></span> <span data-ttu-id="6ac4e-151">Per registrarsi a un evento, il destinatario crea un metodo che può gestire l'evento, quindi crea un delegato per il metodo e passa il delegato all'origine evento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-151">To register for an event, the recipient creates a method designed to handle the event, then creates a delegate for that method and passes the delegate to the event source.</span></span> <span data-ttu-id="6ac4e-152">L'origine chiama il delegato quando si verifica l'evento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-152">The source calls the delegate when the event occurs.</span></span> <span data-ttu-id="6ac4e-153">Il delegato chiama quindi il metodo di gestione eventi sul destinatario, recapitando i dati dell'evento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-153">The delegate then calls the event handling method on the recipient, delivering the event data.</span></span> <span data-ttu-id="6ac4e-154">Il tipo delegato per un determinato evento è definito dall'origine evento.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-154">The delegate type for a given event is defined by the event source.</span></span> <span data-ttu-id="6ac4e-155">Per altre informazioni, vedere [Eventi](../events/index.md).</span><span class="sxs-lookup"><span data-stu-id="6ac4e-155">For more, see [Events](../events/index.md).</span></span>

<span data-ttu-id="6ac4e-156">Se si confrontano delegati di due tipi diversi assegnati in fase di compilazione si avrà un errore di compilazione.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-156">Comparing delegates of two different types assigned at compile-time will result in a compilation error.</span></span> <span data-ttu-id="6ac4e-157">Se le istanze dei delegati sono staticamente del tipo `System.Delegate`, il confronto è consentito, ma restituirà false in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="6ac4e-157">If the delegate instances are statically of the type `System.Delegate`, then the comparison is allowed, but will return false at run time.</span></span> <span data-ttu-id="6ac4e-158">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="6ac4e-158">For example:</span></span>

[!code-csharp[csProgGuideDelegates#30](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#30)]

## <a name="see-also"></a><span data-ttu-id="6ac4e-159">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6ac4e-159">See also</span></span>

- [<span data-ttu-id="6ac4e-160">Guida per programmatori C#</span><span class="sxs-lookup"><span data-stu-id="6ac4e-160">C# Programming Guide</span></span>](../index.md)
- [<span data-ttu-id="6ac4e-161">Delegati</span><span class="sxs-lookup"><span data-stu-id="6ac4e-161">Delegates</span></span>](./index.md)
- [<span data-ttu-id="6ac4e-162">Uso della varianza nei delegati</span><span class="sxs-lookup"><span data-stu-id="6ac4e-162">Using Variance in Delegates</span></span>](../concepts/covariance-contravariance/using-variance-in-delegates.md)
- [<span data-ttu-id="6ac4e-163">Varianza nei delegati</span><span class="sxs-lookup"><span data-stu-id="6ac4e-163">Variance in Delegates</span></span>](../concepts/covariance-contravariance/variance-in-delegates.md)
- [<span data-ttu-id="6ac4e-164">Uso della varianza per i delegati generici Func e Action</span><span class="sxs-lookup"><span data-stu-id="6ac4e-164">Using Variance for Func and Action Generic Delegates</span></span>](../concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md)
- [<span data-ttu-id="6ac4e-165">Events</span><span class="sxs-lookup"><span data-stu-id="6ac4e-165">Events</span></span>](../events/index.md)
