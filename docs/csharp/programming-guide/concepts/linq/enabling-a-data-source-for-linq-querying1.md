---
title: Abilitazione di un'origine dati per l'esecuzione di query LINQ
ms.date: 07/20/2015
ms.assetid: d2ef04a5-31a6-45cb-af9a-a5ce7732662c
ms.openlocfilehash: 9a143f0da74d4e91ef697f468d7fda225e75245b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/14/2020
ms.locfileid: "75635769"
---
# <a name="enabling-a-data-source-for-linq-querying"></a><span data-ttu-id="25ac3-102">Abilitazione di un'origine dati per l'esecuzione di query LINQ</span><span class="sxs-lookup"><span data-stu-id="25ac3-102">Enabling a Data Source for LINQ Querying</span></span>
<span data-ttu-id="25ac3-103">Esistono vari modi per estendere LINQ per consentire a qualsiasi origine dati di eseguire query nel modello LINQ.</span><span class="sxs-lookup"><span data-stu-id="25ac3-103">There are various ways to extend LINQ to enable any data source to be queried in the LINQ pattern.</span></span> <span data-ttu-id="25ac3-104">L'origine dati potrebbe, ad esempio, essere una struttura ad albero dei dati, un servizio Web, un file system o un database.</span><span class="sxs-lookup"><span data-stu-id="25ac3-104">The data source might be a data structure, a Web service, a file system, or a database, to name some.</span></span> <span data-ttu-id="25ac3-105">Il modello LINQ consente ai client di eseguire facilmente query su un'origine dati per cui è abilitata l'esecuzione di query LINQ, poiché la sintassi e il modello della query non vengono modificati.</span><span class="sxs-lookup"><span data-stu-id="25ac3-105">The LINQ pattern makes it easy for clients to query a data source for which LINQ querying is enabled, because the syntax and pattern of the query does not change.</span></span> <span data-ttu-id="25ac3-106">Di seguito sono riportati i modi in cui LINQ può essere esteso a queste origini dati:</span><span class="sxs-lookup"><span data-stu-id="25ac3-106">The ways in which LINQ can be extended to these data sources include the following:</span></span>  
  
- <span data-ttu-id="25ac3-107">Implementazione <xref:System.Collections.Generic.IEnumerable%601> dell'interfaccia in un tipo per abilitare l'esecuzione di query LINQ to Objects di tale tipo.</span><span class="sxs-lookup"><span data-stu-id="25ac3-107">Implementing the <xref:System.Collections.Generic.IEnumerable%601> interface in a type to enable LINQ to Objects querying of that type.</span></span>  
  
- <span data-ttu-id="25ac3-108">Creazione di metodi dell'operatore di query standard, ad esempio <xref:System.Linq.Enumerable.Where%2A> e <xref:System.Linq.Enumerable.Select%2A> che estendono un tipo, per abilitare l'esecuzione di query LINQ personalizzate di tale tipo.</span><span class="sxs-lookup"><span data-stu-id="25ac3-108">Creating standard query operator methods such as <xref:System.Linq.Enumerable.Where%2A> and <xref:System.Linq.Enumerable.Select%2A> that extend a type, to enable custom LINQ querying of that type.</span></span>  
  
- <span data-ttu-id="25ac3-109">Creando un provider per l'origine dati che implementi l'interfaccia <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="25ac3-109">Creating a provider for your data source that implements the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="25ac3-110">Un provider che implementa questa interfaccia riceve query LINQ sotto forma di alberi delle espressioni, che può essere eseguita in modo personalizzato, ad esempio in modalità remota.</span><span class="sxs-lookup"><span data-stu-id="25ac3-110">A provider that implements this interface receives LINQ queries in the form of expression trees, which it can execute in a custom way, for example remotely.</span></span>  
  
- <span data-ttu-id="25ac3-111">Creazione di un provider per l'origine dati che sfrutta una tecnologia LINQ esistente.</span><span class="sxs-lookup"><span data-stu-id="25ac3-111">Creating a provider for your data source that takes advantage of an existing LINQ technology.</span></span> <span data-ttu-id="25ac3-112">Tale provider consentirebbe non solo l'esecuzione di query, ma anche le operazioni di inserimento, aggiornamento ed eliminazione e il mapping per i tipi definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="25ac3-112">Such a provider would enable not only querying, but also insert, update, and delete operations and mapping for user-defined types.</span></span>  
  
 <span data-ttu-id="25ac3-113">In questo argomento vengono descritte queste opzioni.</span><span class="sxs-lookup"><span data-stu-id="25ac3-113">This topic discusses these options.</span></span>  
  
## <a name="how-to-enable-linq-querying-of-your-data-source"></a><span data-ttu-id="25ac3-114">Come attivare l'esecuzione di query LINQ sull'origine dati</span><span class="sxs-lookup"><span data-stu-id="25ac3-114">How to Enable LINQ Querying of Your Data Source</span></span>  
  
### <a name="in-memory-data"></a><span data-ttu-id="25ac3-115">Dati in memoria</span><span class="sxs-lookup"><span data-stu-id="25ac3-115">In-Memory Data</span></span>  
 <span data-ttu-id="25ac3-116">Esistono due modi per abilitare l'esecuzione di query LINQ di dati in memoria.</span><span class="sxs-lookup"><span data-stu-id="25ac3-116">There are two ways you can enable LINQ querying of in-memory data.</span></span> <span data-ttu-id="25ac3-117">Se i dati sono di <xref:System.Collections.Generic.IEnumerable%601>un tipo che implementa , è possibile eseguire query sui dati utilizzando LINQ to Objects.</span><span class="sxs-lookup"><span data-stu-id="25ac3-117">If the data is of a type that implements <xref:System.Collections.Generic.IEnumerable%601>, you can query the data by using LINQ to Objects.</span></span> <span data-ttu-id="25ac3-118">Se non ha senso abilitare l'enumerazione <xref:System.Collections.Generic.IEnumerable%601> del tipo implementando l'interfaccia, è possibile definire i metodi dell'operatore di query standard LINQ in tale tipo o creare metodi dell'operatore di query standard LINQ che estendono il tipo.</span><span class="sxs-lookup"><span data-stu-id="25ac3-118">If it does not make sense to enable enumeration of your type by implementing the <xref:System.Collections.Generic.IEnumerable%601> interface, you can define LINQ standard query operator methods in that type or create LINQ standard query operator methods that extend the type.</span></span> <span data-ttu-id="25ac3-119">Le implementazioni personalizzate degli operatori di query standard devono utilizzare l'esecuzione posticipata per restituire i risultati.</span><span class="sxs-lookup"><span data-stu-id="25ac3-119">Custom implementations of the standard query operators should use deferred execution to return the results.</span></span>  
  
### <a name="remote-data"></a><span data-ttu-id="25ac3-120">Dati remoti</span><span class="sxs-lookup"><span data-stu-id="25ac3-120">Remote Data</span></span>  
 <span data-ttu-id="25ac3-121">L'opzione migliore per abilitare l'esecuzione di <xref:System.Linq.IQueryable%601> query LINQ di un'origine dati remota consiste nell'implementare l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="25ac3-121">The best option for enabling LINQ querying of a remote data source is to implement the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="25ac3-122">È tuttavia diverso dall'estendere un provider come [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] per un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="25ac3-122">However, this differs from extending a provider such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] for a data source.</span></span> <span data-ttu-id="25ac3-123">In Visual Studio 2008 [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)]non sono disponibili modelli di provider per l'estensione delle tecnologie LINQ esistenti, ad esempio , ad altri tipi di origine dati.</span><span class="sxs-lookup"><span data-stu-id="25ac3-123">No provider models for extending existing LINQ technologies, such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], to other types of data source are available in Visual Studio 2008.</span></span>
  
## <a name="iqueryable-linq-providers"></a><span data-ttu-id="25ac3-124">Provider LINQ IQueryable</span><span class="sxs-lookup"><span data-stu-id="25ac3-124">IQueryable LINQ Providers</span></span>  
 <span data-ttu-id="25ac3-125">I provider <xref:System.Linq.IQueryable%601> LINQ che implementano possono variare notevolmente nella loro complessità.</span><span class="sxs-lookup"><span data-stu-id="25ac3-125">LINQ providers that implement <xref:System.Linq.IQueryable%601> can vary widely in their complexity.</span></span> <span data-ttu-id="25ac3-126">In questa sezione vengono illustrati i diversi livelli di complessità.</span><span class="sxs-lookup"><span data-stu-id="25ac3-126">This section discusses the different levels of complexity.</span></span>  
  
 <span data-ttu-id="25ac3-127">Un provider `IQueryable` meno complesso potrebbe interfacciarsi con un singolo metodo di un servizio Web.</span><span class="sxs-lookup"><span data-stu-id="25ac3-127">A less complex `IQueryable` provider might interface with a single method of a Web service.</span></span> <span data-ttu-id="25ac3-128">Questo tipo di provider è molto specifico poiché prevede informazioni specifiche nelle query che gestisce.</span><span class="sxs-lookup"><span data-stu-id="25ac3-128">This type of provider is very specific because it expects specific information in the queries that it handles.</span></span> <span data-ttu-id="25ac3-129">Ha un sistema del tipo chiuso, forse esponendo un solo tipo di risultato.</span><span class="sxs-lookup"><span data-stu-id="25ac3-129">It has a closed type system, perhaps exposing a single result type.</span></span> <span data-ttu-id="25ac3-130">La maggior parte dell'esecuzione della query avviene localmente, utilizzando ad esempio le implementazioni <xref:System.Linq.Enumerable> degli operatori di query standard.</span><span class="sxs-lookup"><span data-stu-id="25ac3-130">Most of the execution of the query occurs locally, for example by using the <xref:System.Linq.Enumerable> implementations of the standard query operators.</span></span> <span data-ttu-id="25ac3-131">Un provider meno complesso potrebbe esaminare solo un'espressione della chiamata al metodo nella struttura ad albero dell'espressione che rappresenta la query facendo sì che la logica rimanente della query venga gestita altrove.</span><span class="sxs-lookup"><span data-stu-id="25ac3-131">A less complex provider might examine only one method call expression in the expression tree that represents the query, and let the remaining logic of the query be handled elsewhere.</span></span>  
  
 <span data-ttu-id="25ac3-132">Un provider `IQueryable` mediamente complesso potrebbe essere destinato a un'origine dati che ha un linguaggio di query parzialmente espressivo.</span><span class="sxs-lookup"><span data-stu-id="25ac3-132">An `IQueryable` provider of medium complexity might target a data source that has a partially expressive query language.</span></span> <span data-ttu-id="25ac3-133">Se è destinato a un servizio Web, potrebbe interagire con più metodi del servizio Web e selezionare il metodo da chiamare in base alla domanda posta dalla query.</span><span class="sxs-lookup"><span data-stu-id="25ac3-133">If it targets a Web service, it might interface with more than one method of the Web service and select the method to call based on the question that the query poses.</span></span> <span data-ttu-id="25ac3-134">Un provider mediamente complesso può avere un sistema di tipi più dettagliato rispetto a un provider semplice, ma rimane sempre un sistema di tipi fisso.</span><span class="sxs-lookup"><span data-stu-id="25ac3-134">A provider of medium complexity would have a richer type system than a simple provider, but it would still be a fixed type system.</span></span> <span data-ttu-id="25ac3-135">Ad esempio, il provider può esporre tipi che hanno relazioni uno-a-molti che possono essere attraversate, ma non fornisce la tecnologia di mapping per i tipi definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="25ac3-135">For example, the provider might expose types that have one-to-many relationships that can be traversed, but it would not provide mapping technology for user-defined types.</span></span>  
  
 <span data-ttu-id="25ac3-136">Un `IQueryable` provider complesso, [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] ad esempio il provider, potrebbe convertire le query LINQ complete in un linguaggio di query espressivo, ad esempio SQL.</span><span class="sxs-lookup"><span data-stu-id="25ac3-136">A complex `IQueryable` provider, such as the [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] provider, might translate complete LINQ queries to an expressive query language, such as SQL.</span></span> <span data-ttu-id="25ac3-137">Un provider complesso è più generale di un provider meno complesso, poiché può gestire un'ampia gamma di domande nella query.</span><span class="sxs-lookup"><span data-stu-id="25ac3-137">A complex provider is more general than a less complex provider, because it can handle a wider variety of questions in the query.</span></span> <span data-ttu-id="25ac3-138">Ha anche un sistema di tipi aperto e pertanto deve contenere un'infrastruttura completa per eseguire il mapping dei tipi definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="25ac3-138">It also has an open type system and therefore must contain extensive infrastructure to map user-defined types.</span></span> <span data-ttu-id="25ac3-139">Lo sviluppo di un provider complesso è molto impegnativo.</span><span class="sxs-lookup"><span data-stu-id="25ac3-139">Developing a complex provider requires a significant amount of effort.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="25ac3-140">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="25ac3-140">See also</span></span>

- <xref:System.Linq.IQueryable%601>
- <xref:System.Collections.Generic.IEnumerable%601>
- <xref:System.Linq.Enumerable>
- <span data-ttu-id="25ac3-141">[Standard Query Operators Overview (C#)](./standard-query-operators-overview.md) (Panoramica degli operatori di query standard)</span><span class="sxs-lookup"><span data-stu-id="25ac3-141">[Standard Query Operators Overview (C#)](./standard-query-operators-overview.md)</span></span>
- [<span data-ttu-id="25ac3-142">LINQ to Objects (C#)</span><span class="sxs-lookup"><span data-stu-id="25ac3-142">LINQ to Objects (C#)</span></span>](./linq-to-objects.md)
