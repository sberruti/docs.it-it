---
title: Sintassi di query e sintassi di metodi in LINQ (C#)
ms.date: 07/20/2015
helpviewer_keywords:
- LINQ [C#], query syntax vs. method syntax
- queries [LINQ in C#], syntax comparisons
ms.assetid: eedd6dd9-fec2-428c-9581-5b8783810ded
ms.openlocfilehash: 17280daaf98010245bbd019652a2a46d7f66ab59
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/14/2020
ms.locfileid: "75635496"
---
# <a name="query-syntax-and-method-syntax-in-linq-c"></a><span data-ttu-id="5e8a7-102">Sintassi di query e sintassi di metodi in LINQ (C#)</span><span class="sxs-lookup"><span data-stu-id="5e8a7-102">Query Syntax and Method Syntax in LINQ (C#)</span></span>
<span data-ttu-id="5e8a7-103">La maggior parte delle query nella documentazione introduttiva di Language Integrated Query (LINQ) viene scritta utilizzando la sintassi di query dichiarativa LINQ.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-103">Most queries in the introductory Language Integrated Query (LINQ) documentation are written by using the LINQ declarative query syntax.</span></span> <span data-ttu-id="5e8a7-104">Tuttavia, la sintassi di query deve essere convertita in chiamate al metodo per Common Language Runtime (CLR) di .NET quando il codice viene compilato.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-104">However, the query syntax must be translated into method calls for the .NET common language runtime (CLR) when the code is compiled.</span></span> <span data-ttu-id="5e8a7-105">Queste chiamate al metodo richiamano gli operatori query standard, che hanno nomi come `Where`, `Select`, `GroupBy`, `Join`, `Max` e `Average`.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-105">These method calls invoke the standard query operators, which have names such as `Where`, `Select`, `GroupBy`, `Join`, `Max`, and `Average`.</span></span> <span data-ttu-id="5e8a7-106">È possibile chiamarli direttamente usando la sintassi di metodo anziché la sintassi di query.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-106">You can call them directly by using method syntax instead of query syntax.</span></span>  
  
 <span data-ttu-id="5e8a7-107">La sintassi di query e la sintassi di metodo sono semanticamente identiche, ma molti utenti ritengono che la sintassi di query sia più semplice e più facile da leggere.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-107">Query syntax and method syntax are semantically identical, but many people find query syntax simpler and easier to read.</span></span> <span data-ttu-id="5e8a7-108">Alcune query devono essere espresse come chiamate al metodo.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-108">Some queries must be expressed as method calls.</span></span> <span data-ttu-id="5e8a7-109">Ad esempio, è necessario usare una chiamata al metodo per esprimere una query che recupera il numero di elementi che soddisfano una determinata condizione.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-109">For example, you must use a method call to express a query that retrieves the number of elements that match a specified condition.</span></span> <span data-ttu-id="5e8a7-110">È necessario usare una chiamata al metodo anche per una query che recupera l'elemento con il valore massimo in una sequenza di origine.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-110">You also must use a method call for a query that retrieves the element that has the maximum value in a source sequence.</span></span> <span data-ttu-id="5e8a7-111">Nella documentazione di riferimento per gli operatori query standard nello spazio dei nomi <xref:System.Linq> viene usata in genere la sintassi di metodo.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-111">The reference documentation for the standard query operators in the <xref:System.Linq> namespace generally uses method syntax.</span></span> <span data-ttu-id="5e8a7-112">Pertanto, anche quando si inizia a scrivere query LINQ, è utile avere familiarità con l'utilizzo della sintassi del metodo nelle query e nelle espressioni di query stesse.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-112">Therefore, even when getting started writing LINQ queries, it is useful to be familiar with how to use method syntax in queries and in query expressions themselves.</span></span>  
  
## <a name="standard-query-operator-extension-methods"></a><span data-ttu-id="5e8a7-113">Metodi di estensione degli operatori query standard</span><span class="sxs-lookup"><span data-stu-id="5e8a7-113">Standard Query Operator Extension Methods</span></span>  
 <span data-ttu-id="5e8a7-114">Nell'esempio seguente viene illustrata un'*espressione di query* semplice e la query semanticamente equivalente scritta come *query basata su metodo*.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-114">The following example shows a simple *query expression* and the semantically equivalent query written as a *method-based query*.</span></span>  
  
 [!code-csharp[csLINQGettingStarted#22](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsLINQGettingStarted/CS/Class1.cs#22)]  
  
 <span data-ttu-id="5e8a7-115">L'output dei due esempi è identico.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-115">The output from the two examples is identical.</span></span> <span data-ttu-id="5e8a7-116">Si noterà che il tipo della variabile di query è lo stesso in entrambi i formati: <xref:System.Collections.Generic.IEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-116">You can see that the type of the query variable is the same in both forms: <xref:System.Collections.Generic.IEnumerable%601>.</span></span>  
  
 <span data-ttu-id="5e8a7-117">Per capire meglio la query basata su metodo, esaminiamola più da vicino.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-117">To understand the method-based query, let's examine it more closely.</span></span> <span data-ttu-id="5e8a7-118">Sul lato destro dell'espressione, si può notare che la clausola `where` viene ora espressa come metodo di istanza per l'oggetto `numbers` che, come si ricorderà, ha un tipo di `IEnumerable<int>`.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-118">On the right side of the expression, notice that the `where` clause is now expressed as an instance method on the `numbers` object, which as you will recall has a type of `IEnumerable<int>`.</span></span> <span data-ttu-id="5e8a7-119">Chi ha familiarità con l'interfaccia generica <xref:System.Collections.Generic.IEnumerable%601> sa che non ha un metodo `Where`.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-119">If you are familiar with the generic <xref:System.Collections.Generic.IEnumerable%601> interface, you know that it does not have a `Where` method.</span></span> <span data-ttu-id="5e8a7-120">Tuttavia, se si richiama l'elenco di completamento IntelliSense nell'IDE di Visual Studio, si vedrà non solo un metodo `Where` ma molti altri metodi, ad esempio `Select`, `SelectMany`, `Join` e `Orderby`.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-120">However, if you invoke the IntelliSense completion list in the Visual Studio IDE, you will see not only a `Where` method, but many other methods such as `Select`, `SelectMany`, `Join`, and `Orderby`.</span></span> <span data-ttu-id="5e8a7-121">Sono tutti operatori di query standard.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-121">These are all the standard query operators.</span></span>  
  
 ![Screenshot di tutti gli operatori query standard in Intellisense.](./media/query-syntax-and-method-syntax-in-linq/standard-query-operators.png)  
  
 <span data-ttu-id="5e8a7-123">Sebbene possa sembrare che <xref:System.Collections.Generic.IEnumerable%601> sia stata ridefinita in modo da includere questi metodi aggiuntivi, di fatto non è così.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-123">Although it looks as if <xref:System.Collections.Generic.IEnumerable%601> has been redefined to include these additional methods, in fact this is not the case.</span></span> <span data-ttu-id="5e8a7-124">Gli operatori di query standard vengono implementati come un nuovo tipo di metodo denominato *metodo di estensione*.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-124">The standard query operators are implemented as a new kind of method called *extension methods*.</span></span> <span data-ttu-id="5e8a7-125">I metodi di estensione "estendono" un tipo esistente. Possono essere chiamati come se fossero metodi di istanza per il tipo.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-125">Extensions methods "extend" an existing type; they can be called as if they were instance methods on the type.</span></span> <span data-ttu-id="5e8a7-126">Gli operatori di query standard estendono <xref:System.Collections.Generic.IEnumerable%601> e questo è il motivo per cui è possibile scrivere `numbers.Where(...)`.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-126">The standard query operators extend <xref:System.Collections.Generic.IEnumerable%601> and that is why you can write `numbers.Where(...)`.</span></span>  
  
 <span data-ttu-id="5e8a7-127">Per iniziare a usare LINQ, tutto ciò che è realmente necessario conoscere sui metodi `using` di estensione è come portarli nell'ambito nell'applicazione utilizzando le direttive corrette.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-127">To get started using LINQ, all that you really have to know about extension methods is how to bring them into scope in your application by using the correct `using` directives.</span></span> <span data-ttu-id="5e8a7-128">Dal punto di vista dell'applicazione, un metodo di estensione e un metodo di istanza normale sono la stessa cosa.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-128">From your application's point of view, an extension method and a regular instance method are the same.</span></span>  
  
 <span data-ttu-id="5e8a7-129">Per altre informazioni sui metodi di estensione, vedere [Metodi di estensione](../../classes-and-structs/extension-methods.md).</span><span class="sxs-lookup"><span data-stu-id="5e8a7-129">For more information about extension methods, see [Extension Methods](../../classes-and-structs/extension-methods.md).</span></span> <span data-ttu-id="5e8a7-130">Per altre informazioni sugli operatori di query standard, vedere [Panoramica degli operatori di query standard (C#)](./standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5e8a7-130">For more information about standard query operators, see [Standard Query Operators Overview (C#)](./standard-query-operators-overview.md).</span></span> <span data-ttu-id="5e8a7-131">Alcuni provider LINQ, [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]ad esempio e , implementano i propri operatori <xref:System.Collections.Generic.IEnumerable%601>di query standard e metodi di estensione aggiuntivi per altri tipi oltre a .</span><span class="sxs-lookup"><span data-stu-id="5e8a7-131">Some LINQ providers, such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] and [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], implement their own standard query operators and additional extension methods for other types besides <xref:System.Collections.Generic.IEnumerable%601>.</span></span>  
  
## <a name="lambda-expressions"></a><span data-ttu-id="5e8a7-132">Espressioni lambda</span><span class="sxs-lookup"><span data-stu-id="5e8a7-132">Lambda Expressions</span></span>  
 <span data-ttu-id="5e8a7-133">Nell'esempio precedente, si può notare che l'espressione condizionale (`num % 2 == 0`) viene passata come argomento inline al metodo `Where`: `Where(num => num % 2 == 0).` Questa espressione inline è definita espressione lambda.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-133">In the previous example, notice that the conditional expression (`num % 2 == 0`) is passed as an in-line argument to the `Where` method: `Where(num => num % 2 == 0).` This inline expression is called a lambda expression.</span></span> <span data-ttu-id="5e8a7-134">È un modo pratico per scrivere codice che altrimenti dovrebbe essere scritto in un formato più complesso come metodo anonimo, delegato generico o albero delle espressioni.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-134">It is a convenient way to write code that would otherwise have to be written in more cumbersome form as an anonymous method or a generic delegate or an expression tree.</span></span> <span data-ttu-id="5e8a7-135">In C# `=>` è l'operatore lambda, che viene letto come "goes to".</span><span class="sxs-lookup"><span data-stu-id="5e8a7-135">In C# `=>` is the lambda operator, which is read as "goes to".</span></span> <span data-ttu-id="5e8a7-136">L'elemento `num` a sinistra dell'operatore è la variabile di input che corrisponde a `num` nell'espressione di query.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-136">The `num` on the left of the operator is the input variable which corresponds to `num` in the query expression.</span></span> <span data-ttu-id="5e8a7-137">Il compilatore è in grado di dedurre il tipo di `num` poiché sa che `numbers` è un tipo <xref:System.Collections.Generic.IEnumerable%601> generico.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-137">The compiler can infer the type of `num` because it knows that `numbers` is a generic <xref:System.Collections.Generic.IEnumerable%601> type.</span></span> <span data-ttu-id="5e8a7-138">Il corpo dell'espressione lambda è identico all'espressione nella sintassi di query o in qualsiasi altra espressione o istruzione di C# e può includere chiamate al metodo e altra logica complessa.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-138">The body of the lambda is just the same as the expression in query syntax or in any other C# expression or statement; it can include method calls and other complex logic.</span></span> <span data-ttu-id="5e8a7-139">Il valore restituito è semplicemente il risultato dell'espressione.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-139">The "return value" is just the expression result.</span></span>  
  
 <span data-ttu-id="5e8a7-140">Per iniziare a usare LINQ, non è necessario usare le espressioni lambda in modo esteso.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-140">To get started using LINQ, you do not have to use lambdas extensively.</span></span> <span data-ttu-id="5e8a7-141">Tuttavia, alcune query possono essere espresse solo nella sintassi di metodo e alcune di esse richiedono le espressioni lambda.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-141">However, certain queries can only be expressed in method syntax and some of those require lambda expressions.</span></span> <span data-ttu-id="5e8a7-142">Dopo aver acquisito maggiore familiarità con le espressioni lambda, si noterà che sono uno strumento potente e flessibile nella casella degli strumenti LINQ.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-142">After you become more familiar with lambdas, you will find that they are a powerful and flexible tool in your LINQ toolbox.</span></span> <span data-ttu-id="5e8a7-143">Per ulteriori informazioni, vedere [Espressioni lambda](../../statements-expressions-operators/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="5e8a7-143">For more information, see [Lambda Expressions](../../statements-expressions-operators/lambda-expressions.md).</span></span>  
  
## <a name="composability-of-queries"></a><span data-ttu-id="5e8a7-144">Componibilità delle query</span><span class="sxs-lookup"><span data-stu-id="5e8a7-144">Composability of Queries</span></span>  
 <span data-ttu-id="5e8a7-145">Nell'esempio di codice precedente il metodo `OrderBy` viene richiamato usando l'operatore punto nella chiamata a `Where`.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-145">In the previous code example, note that the `OrderBy` method is invoked by using the dot operator on the call to `Where`.</span></span> <span data-ttu-id="5e8a7-146">`Where` genera una sequenza filtrata e quindi `Orderby` agisce sulla sequenza ordinandola.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-146">`Where` produces a filtered sequence, and then `Orderby` operates on that sequence by sorting it.</span></span> <span data-ttu-id="5e8a7-147">Poiché le query restituiscono un oggetto `IEnumerable`, è necessario comporle nella sintassi di metodo concatenando le chiamate al metodo.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-147">Because queries return an `IEnumerable`, you compose them in method syntax by chaining the method calls together.</span></span> <span data-ttu-id="5e8a7-148">Questa è l'operazione che il compilatore esegue in background quando si scrivono le query usando la sintassi di query.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-148">This is what the compiler does behind the scenes when you write queries by using query syntax.</span></span> <span data-ttu-id="5e8a7-149">E poiché una variabile di query non archivia i risultati della query, è possibile modificarla o usarla come base per una nuova query in qualsiasi momento, anche dopo che è stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="5e8a7-149">And because a query variable does not store the results of the query, you can modify it or use it as the basis for a new query at any time, even after it has been executed.</span></span>  
