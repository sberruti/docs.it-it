---
title: Modelli comuni per i delegati
description: Informazioni sui modelli comuni per l'uso dei delegati nel codice per evitare l'accoppiamento forte tra i componenti.
ms.date: 06/20/2016
ms.assetid: 0ff8fdfd-6a11-4327-b061-0f2526f35b43
ms.openlocfilehash: 22ab88e5b139381e3a8921baa20df035f1405146
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/14/2020
ms.locfileid: "79399665"
---
# <a name="common-patterns-for-delegates"></a><span data-ttu-id="5b421-103">Modelli comuni per i delegati</span><span class="sxs-lookup"><span data-stu-id="5b421-103">Common Patterns for Delegates</span></span>

[<span data-ttu-id="5b421-104">Indietro</span><span class="sxs-lookup"><span data-stu-id="5b421-104">Previous</span></span>](delegates-strongly-typed.md)

<span data-ttu-id="5b421-105">I delegati offrono un meccanismo che consente progettazioni software che comportano un accoppiamento minimo tra i componenti.</span><span class="sxs-lookup"><span data-stu-id="5b421-105">Delegates provide a mechanism that enables software designs involving minimal coupling between components.</span></span>

<span data-ttu-id="5b421-106">Un esempio eccellente di questo tipo di progettazione è LINQ.</span><span class="sxs-lookup"><span data-stu-id="5b421-106">One excellent example for this kind of design is LINQ.</span></span> <span data-ttu-id="5b421-107">Tutte le funzionalità del modello di espressione di query LINQ sono basate sui delegati.</span><span class="sxs-lookup"><span data-stu-id="5b421-107">The LINQ Query Expression Pattern relies on delegates for all of its features.</span></span> <span data-ttu-id="5b421-108">Considerare il semplice esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="5b421-108">Consider this simple example:</span></span>

```csharp
var smallNumbers = numbers.Where(n => n < 10);
```

<span data-ttu-id="5b421-109">La sequenza di numeri viene filtrata mantenendo solo i numeri inferiori al valore 10.</span><span class="sxs-lookup"><span data-stu-id="5b421-109">This filters the sequence of numbers to only those less than the value 10.</span></span>
<span data-ttu-id="5b421-110">Il metodo `Where` usa un delegato che determina quali elementi di un filtro passano il filtro.</span><span class="sxs-lookup"><span data-stu-id="5b421-110">The `Where` method uses a delegate that determines which elements of a sequence pass the filter.</span></span> <span data-ttu-id="5b421-111">Quando si crea una query LINQ, si specifica l'implementazione del delegato per questo scopo specifico.</span><span class="sxs-lookup"><span data-stu-id="5b421-111">When you create a LINQ query, you supply the implementation of the delegate for this specific purpose.</span></span>

<span data-ttu-id="5b421-112">Il prototipo del metodo Where è:</span><span class="sxs-lookup"><span data-stu-id="5b421-112">The prototype for the Where method is:</span></span>

```csharp
public static IEnumerable<TSource> Where<TSource> (this IEnumerable<TSource> source, Func<TSource, bool> predicate);
```

<span data-ttu-id="5b421-113">Questo esempio viene ripetuto con tutti i metodi che fanno parte di LINQ.</span><span class="sxs-lookup"><span data-stu-id="5b421-113">This example is repeated with all the methods that are part of LINQ.</span></span> <span data-ttu-id="5b421-114">Tutti i metodi si basano su delegati per il codice che gestisce la query specifica.</span><span class="sxs-lookup"><span data-stu-id="5b421-114">They all rely on delegates for the code that manages the specific query.</span></span> <span data-ttu-id="5b421-115">Lo schema progettuale di questa API è molto utile per apprendere e comprendere.</span><span class="sxs-lookup"><span data-stu-id="5b421-115">This API design pattern is a very powerful one to learn and understand.</span></span>

<span data-ttu-id="5b421-116">Questo semplice esempio illustrato come i delegati richiedono pochissimo accoppiamento tra i componenti.</span><span class="sxs-lookup"><span data-stu-id="5b421-116">This simple example illustrates how delegates require very little coupling between components.</span></span> <span data-ttu-id="5b421-117">Non è necessario creare una classe che deriva da una determinata classe base.</span><span class="sxs-lookup"><span data-stu-id="5b421-117">You don't need to create a class that derives from a particular base class.</span></span> <span data-ttu-id="5b421-118">Non è necessario implementare un'interfaccia specifica.</span><span class="sxs-lookup"><span data-stu-id="5b421-118">You don't need to implement a specific interface.</span></span>
<span data-ttu-id="5b421-119">L'unico requisito è fornire l'implementazione di un metodo che è fondamentale per l'attività in questione.</span><span class="sxs-lookup"><span data-stu-id="5b421-119">The only requirement is to provide the implementation of one method that is fundamental to the task at hand.</span></span>

## <a name="building-your-own-components-with-delegates"></a><span data-ttu-id="5b421-120">Creazione di componenti personalizzati con i delegati</span><span class="sxs-lookup"><span data-stu-id="5b421-120">Building Your Own Components with Delegates</span></span>

<span data-ttu-id="5b421-121">Continuando con lo stesso esempio si crea un componente usando una progettazione basata sui delegati.</span><span class="sxs-lookup"><span data-stu-id="5b421-121">Let's build on that example by creating a component using a design that relies on delegates.</span></span>

<span data-ttu-id="5b421-122">Definire un componente che può essere usato per i messaggi di registro in un sistema di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="5b421-122">Let's define a component that could be used for log messages in a large system.</span></span> <span data-ttu-id="5b421-123">I componenti di libreria possono essere usati in molti ambienti diversi, su più piattaforme.</span><span class="sxs-lookup"><span data-stu-id="5b421-123">The library components could be used in many different environments, on multiple different platforms.</span></span> <span data-ttu-id="5b421-124">Sono disponibili molte funzionalità comuni nel componente che gestisce i registri.</span><span class="sxs-lookup"><span data-stu-id="5b421-124">There are a lot of common features in the component that manages the logs.</span></span> <span data-ttu-id="5b421-125">È necessario che vengano accettati i messaggi da qualsiasi componente nel sistema.</span><span class="sxs-lookup"><span data-stu-id="5b421-125">It will need to accept messages from any component in the system.</span></span> <span data-ttu-id="5b421-126">I messaggi avranno priorità diverse che possono essere gestite dal componente principale.</span><span class="sxs-lookup"><span data-stu-id="5b421-126">Those messages will have different priorities, which the core component can manage.</span></span> <span data-ttu-id="5b421-127">I messaggi devono avere timestamp nel formato archiviato finale.</span><span class="sxs-lookup"><span data-stu-id="5b421-127">The messages should have timestamps in their final archived form.</span></span> <span data-ttu-id="5b421-128">Per gli scenari più avanzati, è possibile filtrare i messaggi in base al componente di origine.</span><span class="sxs-lookup"><span data-stu-id="5b421-128">For more advanced scenarios, you could filter messages by the source component.</span></span>

<span data-ttu-id="5b421-129">La posizione in cui vengono scritti i messaggi è uno degli aspetti della funzionalità che verrà modificato spesso.</span><span class="sxs-lookup"><span data-stu-id="5b421-129">There is one aspect of the feature that will change often: where messages are written.</span></span> <span data-ttu-id="5b421-130">In alcuni ambienti possono essere scritti nella console degli errori.</span><span class="sxs-lookup"><span data-stu-id="5b421-130">In some environments, they may be written to the error console.</span></span> <span data-ttu-id="5b421-131">In altri casi, in un file.</span><span class="sxs-lookup"><span data-stu-id="5b421-131">In others, a file.</span></span> <span data-ttu-id="5b421-132">Le altre possibilità includono l'archiviazione database, i log eventi del sistema operativo o un'altra archiviazione di documenti.</span><span class="sxs-lookup"><span data-stu-id="5b421-132">Other possibilities include database storage, OS event logs, or other document storage.</span></span>

<span data-ttu-id="5b421-133">Esistono anche combinazioni di output che possono essere usate in scenari diversi.</span><span class="sxs-lookup"><span data-stu-id="5b421-133">There are also combinations of output that might be used in different scenarios.</span></span> <span data-ttu-id="5b421-134">È possibile scrivere i messaggi nella console e in un file.</span><span class="sxs-lookup"><span data-stu-id="5b421-134">You may want to write messages to the console and to a file.</span></span>

<span data-ttu-id="5b421-135">Una progettazione basata sui delegati offre molta flessibilità e semplifica il supporto di meccanismi di archiviazione che possono essere aggiunti in futuro.</span><span class="sxs-lookup"><span data-stu-id="5b421-135">A design based on delegates will provide a great deal of flexibility, and make it easy to support storage mechanisms that may be added in the future.</span></span>

<span data-ttu-id="5b421-136">In questa progettazione, il componente del log primario può essere una classe non virtuale e persino sealed.</span><span class="sxs-lookup"><span data-stu-id="5b421-136">Under this design, the primary log component can be a non-virtual, even sealed class.</span></span> <span data-ttu-id="5b421-137">È possibile collegare qualsiasi set di delegati per scrivere i messaggi in diversi supporti di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="5b421-137">You can plug in any set of delegates to write the messages to different storage media.</span></span> <span data-ttu-id="5b421-138">Il supporto incorporato per i delegati multicast semplifica il supporto di scenari in cui i messaggi devono essere scritti in più posizioni (un file e una console).</span><span class="sxs-lookup"><span data-stu-id="5b421-138">The built in support for multicast delegates makes it easy to support scenarios where messages must be written to multiple locations (a file, and a console).</span></span>

## <a name="a-first-implementation"></a><span data-ttu-id="5b421-139">Prima implementazione</span><span class="sxs-lookup"><span data-stu-id="5b421-139">A First Implementation</span></span>

<span data-ttu-id="5b421-140">Per iniziare in modo semplice, l'implementazione iniziale accetterà i nuovi messaggi e li scriverà usando qualsiasi delegato associato.</span><span class="sxs-lookup"><span data-stu-id="5b421-140">Let's start small: the initial implementation will accept new messages, and write them using any attached delegate.</span></span> <span data-ttu-id="5b421-141">È possibile iniziare con un solo delegato che scrive i messaggi nella console.</span><span class="sxs-lookup"><span data-stu-id="5b421-141">You can start with one delegate that writes messages to the console.</span></span>

[!code-csharp[LoggerImplementation](../../samples/snippets/csharp/delegates-and-events/Logger.cs#FirstImplementation "A first Logger implementation.")]

<span data-ttu-id="5b421-142">La classe statica precedente è l'elemento più semplice in grado di funzionare.</span><span class="sxs-lookup"><span data-stu-id="5b421-142">The static class above is the simplest thing that can work.</span></span> <span data-ttu-id="5b421-143">È necessario scrivere la singola implementazione per il metodo che scrive i messaggi nella console:</span><span class="sxs-lookup"><span data-stu-id="5b421-143">We need to write the single implementation for the method that writes messages to the console:</span></span>

[!code-csharp[LogToConsole](../../samples/snippets/csharp/delegates-and-events/LoggingMethods.cs#LogToConsole "A Console logger.")]

<span data-ttu-id="5b421-144">Infine, è necessario collegare il delegato associandolo al delegato WriteMessage dichiarato nel logger:</span><span class="sxs-lookup"><span data-stu-id="5b421-144">Finally, you need to hook up the delegate by attaching it to the WriteMessage delegate declared in the logger:</span></span>

[!code-csharp[ConnectDelegate](../../samples/snippets/csharp/delegates-and-events/Program.cs#ConnectDelegate "Connect to the delegate")]

## <a name="practices"></a><span data-ttu-id="5b421-145">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="5b421-145">Practices</span></span>

<span data-ttu-id="5b421-146">L'esempio è abbastanza semplice ma illustra alcune importanti linee guida per le progettazioni che usano i delegati.</span><span class="sxs-lookup"><span data-stu-id="5b421-146">Our sample so far is fairly simple, but it still demonstrates some of the important guidelines for designs involving delegates.</span></span>

<span data-ttu-id="5b421-147">L'uso dei tipi delegati definiti nel framework principale semplifica l'uso dei delegati da parte degli utenti.</span><span class="sxs-lookup"><span data-stu-id="5b421-147">Using the delegate types defined in the Core Framework makes it easier for users to work with the delegates.</span></span> <span data-ttu-id="5b421-148">Non è necessario definire nuovi tipi e gli sviluppatori che usano la libreria non devono conoscere tipi delegati nuovi e specializzati.</span><span class="sxs-lookup"><span data-stu-id="5b421-148">You don't need to define new types, and developers using your library do not need to learn new, specialized delegate types.</span></span>

<span data-ttu-id="5b421-149">Le interfacce usate sono essenziali e offrono la massima flessibilità: per creare un nuovo logger di output è necessario creare un solo metodo.</span><span class="sxs-lookup"><span data-stu-id="5b421-149">The interfaces used are as minimal and as flexible as possible: To create a new output logger, you must create one method.</span></span> <span data-ttu-id="5b421-150">Il metodo creato può essere statico o di istanza</span><span class="sxs-lookup"><span data-stu-id="5b421-150">That method may be a static method, or an instance method.</span></span> <span data-ttu-id="5b421-151">e avere qualsiasi accesso.</span><span class="sxs-lookup"><span data-stu-id="5b421-151">It may have any access.</span></span>

## <a name="formatting-output"></a><span data-ttu-id="5b421-152">Formattazione dell'output</span><span class="sxs-lookup"><span data-stu-id="5b421-152">Formatting Output</span></span>

<span data-ttu-id="5b421-153">Creare una prima versione più affidabile e altri meccanismi di registrazione.</span><span class="sxs-lookup"><span data-stu-id="5b421-153">Let's make this first version a bit more robust, and then start creating other logging mechanisms.</span></span>

<span data-ttu-id="5b421-154">Successivamente, aggiungere alcuni argomenti al metodo `LogMessage()` in modo che la classe del log crei messaggi più strutturati:</span><span class="sxs-lookup"><span data-stu-id="5b421-154">Next, let's add a few arguments to the `LogMessage()` method so that your log class creates more structured messages:</span></span>

[!code-csharp[Severity](../../samples/snippets/csharp/delegates-and-events/Logger.cs#Severity "Define severities")]
[!code-csharp[NextLogger](../../samples/snippets/csharp/delegates-and-events/Logger.cs#LoggerTwo "Refine the Logger")]

<span data-ttu-id="5b421-155">Usare quindi l'argomento `Severity` per filtrare i messaggi inviati all'output del log.</span><span class="sxs-lookup"><span data-stu-id="5b421-155">Next, let's make use of that `Severity` argument to filter the messages that are sent to the log's output.</span></span>

[!code-csharp[FinalLogger](../../samples/snippets/csharp/delegates-and-events/Logger.cs#LoggerFinal "Finish the Logger")]

## <a name="practices"></a><span data-ttu-id="5b421-156">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="5b421-156">Practices</span></span>

<span data-ttu-id="5b421-157">Sono state aggiunte nuove funzionalità all'infrastruttura di registrazione.</span><span class="sxs-lookup"><span data-stu-id="5b421-157">You've added new features to the logging infrastructure.</span></span> <span data-ttu-id="5b421-158">Poiché il componente di logger è accoppiato molto genericamente a qualsiasi meccanismo di output, è possibile aggiungere queste nuove funzionalità senza alcun impatto sul codice che implementa il delegato del logger.</span><span class="sxs-lookup"><span data-stu-id="5b421-158">Because the logger component is very loosely coupled to any output mechanism, these new features can be added with no impact on any of the code implementing the logger delegate.</span></span>

<span data-ttu-id="5b421-159">Durante la compilazione, si noteranno ulteriori esempi di come questo accoppiamento generico offra una maggiore flessibilità per l'aggiornamento di parti del sito senza modifiche in altre posizioni.</span><span class="sxs-lookup"><span data-stu-id="5b421-159">As you keep building this, you'll see more examples of how this loose coupling enables greater flexibility in updating parts of the site without any changes to other locations.</span></span> <span data-ttu-id="5b421-160">In un'applicazione di dimensioni maggiori, infatti, le classi di output del logger potrebbero trovarsi in un assembly diverso e non richiedere alcuna ricompilazione.</span><span class="sxs-lookup"><span data-stu-id="5b421-160">In fact, in a larger application, the logger output classes might be in a different assembly, and not even need to be rebuilt.</span></span>

## <a name="building-a-second-output-engine"></a><span data-ttu-id="5b421-161">Creazione di un secondo modulo di output</span><span class="sxs-lookup"><span data-stu-id="5b421-161">Building a Second Output Engine</span></span>

<span data-ttu-id="5b421-162">Il componente di log è stato migliorato.</span><span class="sxs-lookup"><span data-stu-id="5b421-162">The Log component is coming along well.</span></span> <span data-ttu-id="5b421-163">Aggiungere un modulo di output che registra i messaggi in un file.</span><span class="sxs-lookup"><span data-stu-id="5b421-163">Let's add one more output engine that logs messages to a file.</span></span> <span data-ttu-id="5b421-164">Questo modulo di output sarà leggermente più complesso.</span><span class="sxs-lookup"><span data-stu-id="5b421-164">This will be a slightly more involved output engine.</span></span> <span data-ttu-id="5b421-165">Sarà costituito da una classe che incapsula le operazioni di file e garantisce che il file venga sempre chiuso dopo ogni scrittura.</span><span class="sxs-lookup"><span data-stu-id="5b421-165">It will be a class that encapsulates the file operations, and ensures that the file is always closed after each write.</span></span> <span data-ttu-id="5b421-166">Questo garantisce che tutti i dati vengano scaricati su disco dopo la generazione di ogni messaggio.</span><span class="sxs-lookup"><span data-stu-id="5b421-166">That ensures that all the data is flushed to disk after each message is generated.</span></span>

<span data-ttu-id="5b421-167">Il logger basato su file è il seguente:</span><span class="sxs-lookup"><span data-stu-id="5b421-167">Here is that file based logger:</span></span>

[!code-csharp[FileLogger](../../samples/snippets/csharp/delegates-and-events/FileLogger.cs#FileLogger "Log to files")]

<span data-ttu-id="5b421-168">Dopo aver creato questa classe, è possibile crearne un'istanza che associa il relativo metodo LogMessage al componente Logger:</span><span class="sxs-lookup"><span data-stu-id="5b421-168">Once you've created this class, you can instantiate it and it attaches its LogMessage method to the Logger component:</span></span>

[!code-csharp[FileLogger](../../samples/snippets/csharp/delegates-and-events/Program.cs#FileLogger "Log to files")]

<span data-ttu-id="5b421-169">Le due operazioni non si escludono a vicenda.</span><span class="sxs-lookup"><span data-stu-id="5b421-169">These two are not mutually exclusive.</span></span> <span data-ttu-id="5b421-170">È possibile associare entrambi i metodi di log e generare messaggi nella console e in un file:</span><span class="sxs-lookup"><span data-stu-id="5b421-170">You could attach both log methods and generate messages to the console and a file:</span></span>

```csharp
var fileOutput = new FileLogger("log.txt");
Logger.WriteMessage += LoggingMethods.LogToConsole; // LoggingMethods is the static class we utilized earlier
```

<span data-ttu-id="5b421-171">Successivamente, anche nella stessa applicazione, è possibile rimuovere uno dei delegati senza causare problemi nel sistema:</span><span class="sxs-lookup"><span data-stu-id="5b421-171">Later, even in the same application, you can remove one of the delegates without any other issues to the system:</span></span>

```csharp
Logger.WriteMessage -= LoggingMethods.LogToConsole;
```

## <a name="practices"></a><span data-ttu-id="5b421-172">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="5b421-172">Practices</span></span>

<span data-ttu-id="5b421-173">A questo punto, è stato aggiunto un secondo gestore di output per il sottosistema di registrazione.</span><span class="sxs-lookup"><span data-stu-id="5b421-173">Now, you've added a second output handler for the logging sub-system.</span></span>
<span data-ttu-id="5b421-174">Questo gestore richiede maggiore infrastruttura per supportare correttamente il file system.</span><span class="sxs-lookup"><span data-stu-id="5b421-174">This one needs a bit more infrastructure to correctly support the file system.</span></span> <span data-ttu-id="5b421-175">Il delegato è un metodo di istanza</span><span class="sxs-lookup"><span data-stu-id="5b421-175">The delegate is an instance method.</span></span> <span data-ttu-id="5b421-176">ed è anche un metodo privato.</span><span class="sxs-lookup"><span data-stu-id="5b421-176">It's also a private method.</span></span>
<span data-ttu-id="5b421-177">Non è necessaria una maggiore accessibilità poiché l'infrastruttura dei delegato è in grado di connettere i delegati.</span><span class="sxs-lookup"><span data-stu-id="5b421-177">There's no need for greater accessibility because the delegate infrastructure can connect the delegates.</span></span>

<span data-ttu-id="5b421-178">Inoltre, la progettazione basata sui delegati offre più metodi di output senza codice aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="5b421-178">Second, the delegate-based design enables multiple output methods without any extra code.</span></span> <span data-ttu-id="5b421-179">Non è necessario compilare un'infrastruttura aggiuntiva per supportare più metodi di output.</span><span class="sxs-lookup"><span data-stu-id="5b421-179">You don't need to build any additional infrastructure to support multiple output methods.</span></span> <span data-ttu-id="5b421-180">I metodo vanno semplicemente ad aggiungersi all'elenco chiamate.</span><span class="sxs-lookup"><span data-stu-id="5b421-180">They simply become another method on the invocation list.</span></span>

<span data-ttu-id="5b421-181">Prestare particolare attenzione al codice nel metodo di output di registrazione file.</span><span class="sxs-lookup"><span data-stu-id="5b421-181">Pay special attention to the code in the file logging output method.</span></span> <span data-ttu-id="5b421-182">Viene codificato per assicurarsi che non venga generata alcuna eccezione.</span><span class="sxs-lookup"><span data-stu-id="5b421-182">It is coded to ensure that it does not throw any exceptions.</span></span> <span data-ttu-id="5b421-183">Sebbene questa operazione non sia sempre strettamente necessaria, è spesso consigliabile.</span><span class="sxs-lookup"><span data-stu-id="5b421-183">While this isn't always strictly necessary, it's often a good practice.</span></span> <span data-ttu-id="5b421-184">Se uno dei metodi delegati genera un'eccezione, i delegati rimanenti non verranno chiamati.</span><span class="sxs-lookup"><span data-stu-id="5b421-184">If either of the delegate methods throws an exception, the remaining delegates that are on the invocation won't be invoked.</span></span>

<span data-ttu-id="5b421-185">Infine tenere presente che il logger di file deve gestire le risorse aprendo e chiudendo il file per ogni messaggio di log.</span><span class="sxs-lookup"><span data-stu-id="5b421-185">As a last note, the file logger must manage its resources by opening and closing the file on each log message.</span></span> <span data-ttu-id="5b421-186">È possibile scegliere di mantenere aperto il file e implementare IDisposable per chiudere il file al termine.</span><span class="sxs-lookup"><span data-stu-id="5b421-186">You could choose to keep the file open and implement IDisposable to close the file when you are completed.</span></span>
<span data-ttu-id="5b421-187">Entrambe le opzioni presentano vantaggi e svantaggi.</span><span class="sxs-lookup"><span data-stu-id="5b421-187">Either method has its advantages and disadvantages.</span></span> <span data-ttu-id="5b421-188">Entrambe creano maggiore accoppiamento tra le classi.</span><span class="sxs-lookup"><span data-stu-id="5b421-188">Both do create a bit more coupling between the classes.</span></span>

<span data-ttu-id="5b421-189">Nessun codice nella classe Logger dovrà essere aggiornato per supportare gli scenari.</span><span class="sxs-lookup"><span data-stu-id="5b421-189">None of the code in the Logger class would need to be updated in order to support either scenario.</span></span>

## <a name="handling-null-delegates"></a><span data-ttu-id="5b421-190">Gestione dei delegati Null</span><span class="sxs-lookup"><span data-stu-id="5b421-190">Handling Null Delegates</span></span>

<span data-ttu-id="5b421-191">Aggiornare infine il metodo LogMessage in modo che risulti affidabile per i casi in cui non viene selezionato alcun meccanismo di output.</span><span class="sxs-lookup"><span data-stu-id="5b421-191">Finally, let's update the LogMessage method so that it is robust for those cases when no output mechanism is selected.</span></span> <span data-ttu-id="5b421-192">L'implementazione corrente genererà `NullReferenceException` se non è stato associato alcun elenco chiamate al delegato `WriteMessage`.</span><span class="sxs-lookup"><span data-stu-id="5b421-192">The current implementation will throw a `NullReferenceException` when the `WriteMessage` delegate does not have an invocation list attached.</span></span>
<span data-ttu-id="5b421-193">È possibile che si preferisca una progettazione che continua automaticamente quando non sono stati associati metodi.</span><span class="sxs-lookup"><span data-stu-id="5b421-193">You may prefer a design that silently continues when no methods have been attached.</span></span> <span data-ttu-id="5b421-194">Questa operazione risulta semplice usando l'operatore condizionale Null insieme al metodo `Delegate.Invoke()`:</span><span class="sxs-lookup"><span data-stu-id="5b421-194">This is easy using the null conditional operator, combined with the `Delegate.Invoke()` method:</span></span>

```csharp
public static void LogMessage(string msg)
{
    WriteMessage?.Invoke(msg);
}
```

<span data-ttu-id="5b421-195">L'operatore condizionale Null (`?.`) provoca un corto circuito quando l'operando sinistro (in questo caso `WriteMessage`) è Null, ovvero non viene eseguito alcun tentativo di registrare un messaggio.</span><span class="sxs-lookup"><span data-stu-id="5b421-195">The null conditional operator (`?.`) short-circuits when the left operand (`WriteMessage` in this case) is null, which means no attempt is made to log a message.</span></span>

<span data-ttu-id="5b421-196">Il metodo `Invoke()` non apparirà nella documentazione per `System.Delegate` o `System.MulticastDelegate`.</span><span class="sxs-lookup"><span data-stu-id="5b421-196">You won't find the `Invoke()` method listed in the documentation for `System.Delegate` or `System.MulticastDelegate`.</span></span> <span data-ttu-id="5b421-197">Il compilatore genera un metodo `Invoke` indipendente dai tipi per tutti i tipi delegati dichiarati.</span><span class="sxs-lookup"><span data-stu-id="5b421-197">The compiler generates a type safe `Invoke` method for any delegate type declared.</span></span> <span data-ttu-id="5b421-198">In questo esempio ciò significa che `Invoke` accetta un singolo argomento `string` e ha un tipo restituito void.</span><span class="sxs-lookup"><span data-stu-id="5b421-198">In this example, that means `Invoke` takes a single `string` argument, and has a void return type.</span></span>

## <a name="summary-of-practices"></a><span data-ttu-id="5b421-199">Riepilogo delle procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="5b421-199">Summary of Practices</span></span>

<span data-ttu-id="5b421-200">Sono state descritte le prime fasi di un componente di log che può essere espanso con altri writer e altre funzionalità.</span><span class="sxs-lookup"><span data-stu-id="5b421-200">You've seen the beginnings of a log component that could be expanded with other writers, and other features.</span></span> <span data-ttu-id="5b421-201">Se vengono usati i delegati nella progettazione, questi componenti diversi risultano accoppiati molto genericamente.</span><span class="sxs-lookup"><span data-stu-id="5b421-201">By using delegates in the design these different components are very loosely coupled.</span></span> <span data-ttu-id="5b421-202">Quest'aspetto offre numerosi vantaggi.</span><span class="sxs-lookup"><span data-stu-id="5b421-202">This provides several advantages.</span></span> <span data-ttu-id="5b421-203">È molto semplice creare nuovi meccanismi di output e associarli al sistema.</span><span class="sxs-lookup"><span data-stu-id="5b421-203">It's very easy to create new output mechanisms and attach them to the system.</span></span> <span data-ttu-id="5b421-204">Questi meccanismi richiedono un solo metodo, ovvero il metodo che scrive il messaggio di log.</span><span class="sxs-lookup"><span data-stu-id="5b421-204">These other mechanisms only need one method: the method that writes the log message.</span></span> <span data-ttu-id="5b421-205">Si tratta di una progettazione che risulta molto flessibile quando vengono aggiunte nuove funzionalità.</span><span class="sxs-lookup"><span data-stu-id="5b421-205">It's a design that is very resilient when new features are added.</span></span> <span data-ttu-id="5b421-206">Al writer viene richiesto di implementare un solo metodo.</span><span class="sxs-lookup"><span data-stu-id="5b421-206">The contract required for any writer is to implement one method.</span></span> <span data-ttu-id="5b421-207">Il metodo può essere statico o di istanza.</span><span class="sxs-lookup"><span data-stu-id="5b421-207">That method could be a static or instance method.</span></span> <span data-ttu-id="5b421-208">Può avere un accesso pubblico, privato o un altro tipo di accesso valido.</span><span class="sxs-lookup"><span data-stu-id="5b421-208">It could be public, private, or any other legal access.</span></span>

<span data-ttu-id="5b421-209">La classe Logger può apportare qualsiasi numero di miglioramenti o modifiche senza causare modifiche sostanziali.</span><span class="sxs-lookup"><span data-stu-id="5b421-209">The Logger class can make any number of enhancements or changes without introducing breaking changes.</span></span> <span data-ttu-id="5b421-210">Come qualsiasi altra classe, non è possibile modificare l'API pubblica senza il rischio di modifiche di rilievo.</span><span class="sxs-lookup"><span data-stu-id="5b421-210">Like any class, you cannot modify the public API without the risk of breaking changes.</span></span> <span data-ttu-id="5b421-211">Tuttavia, poiché l'accoppiamento tra il logger e i moduli di output avviene solo tramite il delegato, non vengono usati altri tipi, ad esempio interfacce o classi base.</span><span class="sxs-lookup"><span data-stu-id="5b421-211">But, because the coupling between the logger and any output engines is only through the delegate, no other types (like interfaces or base classes) are involved.</span></span> <span data-ttu-id="5b421-212">L'accoppiamento è ridotto al minimo.</span><span class="sxs-lookup"><span data-stu-id="5b421-212">The coupling is as small as possible.</span></span>

[<span data-ttu-id="5b421-213">Avanti</span><span class="sxs-lookup"><span data-stu-id="5b421-213">Next</span></span>](events-overview.md)
