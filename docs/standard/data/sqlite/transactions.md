---
title: Transazioni
ms.date: 12/13/2019
description: Informazioni su come usare le transazioni.
ms.openlocfilehash: 4b72a1573a560ffd1bfd0f54d46ab3b135280976
ms.sourcegitcommit: 30a558d23e3ac5a52071121a52c305c85fe15726
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/25/2019
ms.locfileid: "75447139"
---
# <a name="transactions"></a><span data-ttu-id="74a1e-103">Transazioni</span><span class="sxs-lookup"><span data-stu-id="74a1e-103">Transactions</span></span>

<span data-ttu-id="74a1e-104">Le transazioni consentono di raggruppare più istruzioni SQL in una singola unità di lavoro di cui viene eseguito il commit nel database come un'unica unità atomica.</span><span class="sxs-lookup"><span data-stu-id="74a1e-104">Transactions let you group multiple SQL statements into a single unit of work that is committed to the database as one atomic unit.</span></span> <span data-ttu-id="74a1e-105">Se un'istruzione nella transazione ha esito negativo, è possibile eseguire il rollback delle modifiche apportate dalle istruzioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="74a1e-105">If any statement in the transaction fails, changes made by the previous statements can be rolled back.</span></span> <span data-ttu-id="74a1e-106">Stato iniziale del database in cui è stata avviata la transazione.</span><span class="sxs-lookup"><span data-stu-id="74a1e-106">The initial state of the database when the transaction was started is preserved.</span></span> <span data-ttu-id="74a1e-107">L'uso di una transazione può anche migliorare le prestazioni in SQLite quando si apportano numerose modifiche al database in una sola volta.</span><span class="sxs-lookup"><span data-stu-id="74a1e-107">Using a transaction can also improve performance on SQLite when making numerous changes to the database at once.</span></span>

## <a name="concurrency"></a><span data-ttu-id="74a1e-108">concorrenza</span><span class="sxs-lookup"><span data-stu-id="74a1e-108">Concurrency</span></span>

<span data-ttu-id="74a1e-109">In SQLite, solo una transazione può presentare modifiche in sospeso nel database alla volta.</span><span class="sxs-lookup"><span data-stu-id="74a1e-109">In SQLite, only one transaction is allowed to have changes pending in the database at a time.</span></span> <span data-ttu-id="74a1e-110">Per questo motivo, è possibile che si verifichi il timeout delle chiamate a <xref:Microsoft.Data.Sqlite.SqliteConnection.BeginTransaction%2A> e ai metodi di `Execute` su <xref:Microsoft.Data.Sqlite.SqliteCommand> se un'altra transazione impiega troppo tempo per il completamento.</span><span class="sxs-lookup"><span data-stu-id="74a1e-110">Because of this, calls to <xref:Microsoft.Data.Sqlite.SqliteConnection.BeginTransaction%2A> and the `Execute` methods on <xref:Microsoft.Data.Sqlite.SqliteCommand> may time out if another transaction takes too long to complete.</span></span>

<span data-ttu-id="74a1e-111">Per ulteriori informazioni sul blocco, i tentativi e i timeout, vedere [errori del database](database-errors.md).</span><span class="sxs-lookup"><span data-stu-id="74a1e-111">For more information about locking, retries, and timeouts, see [Database errors](database-errors.md).</span></span>

## <a name="isolation-levels"></a><span data-ttu-id="74a1e-112">Livelli di isolamento</span><span class="sxs-lookup"><span data-stu-id="74a1e-112">Isolation levels</span></span>

<span data-ttu-id="74a1e-113">Per impostazione predefinita, le transazioni sono **serializzabili** in SQLite.</span><span class="sxs-lookup"><span data-stu-id="74a1e-113">Transactions are **serializable** by default in SQLite.</span></span> <span data-ttu-id="74a1e-114">Questo livello di isolamento garantisce che tutte le modifiche apportate all'interno di una transazione siano completamente isolate.</span><span class="sxs-lookup"><span data-stu-id="74a1e-114">This isolation level guarantees that any changes made within a transaction are completely isolated.</span></span> <span data-ttu-id="74a1e-115">Altre istruzioni eseguite all'esterno della transazione non sono interessate dalle modifiche della transazione.</span><span class="sxs-lookup"><span data-stu-id="74a1e-115">Other statements executed outside of the transaction aren't affected by the transaction's changes.</span></span>

<span data-ttu-id="74a1e-116">SQLite supporta anche **Read uncommitted** quando si usa una cache condivisa.</span><span class="sxs-lookup"><span data-stu-id="74a1e-116">SQLite also supports **read uncommitted** when using a shared cache.</span></span> <span data-ttu-id="74a1e-117">Questo livello consente letture dirty, letture non ripetibili e Phantom:</span><span class="sxs-lookup"><span data-stu-id="74a1e-117">This level allows dirty reads, nonrepeatable reads, and phantoms:</span></span>

- <span data-ttu-id="74a1e-118">Una *lettura dirty* si verifica quando le modifiche in sospeso in una transazione vengono restituite da una query all'esterno della transazione, ma viene eseguito il rollback delle modifiche apportate alla transazione.</span><span class="sxs-lookup"><span data-stu-id="74a1e-118">A *dirty read* occurs when changes pending in one transaction are returned by a query outside of the transaction, but the changes in the transaction are rolled back.</span></span> <span data-ttu-id="74a1e-119">I risultati contengono dati che non sono mai stati effettivamente sottoposte a commit nel database.</span><span class="sxs-lookup"><span data-stu-id="74a1e-119">The results contain data that was never actually committed to the database.</span></span>

- <span data-ttu-id="74a1e-120">Una *lettura non ripetibile* si verifica quando una transazione esegue una query sulla stessa riga due volte, ma i risultati sono diversi perché sono stati modificati tra le due query da un'altra transazione.</span><span class="sxs-lookup"><span data-stu-id="74a1e-120">A *nonrepeatable read* occurs when a transaction queries same row twice, but the results are different because it was changed between the two queries by another transaction.</span></span>

- <span data-ttu-id="74a1e-121">Gli oggetti *fantasma* sono righe che vengono modificate o aggiunte per soddisfare la clausola WHERE di una query durante una transazione.</span><span class="sxs-lookup"><span data-stu-id="74a1e-121">*Phantoms* are rows that get changed or added to meet the where clause of a query during a transaction.</span></span> <span data-ttu-id="74a1e-122">Se consentito, la stessa query può restituire righe diverse quando viene eseguita due volte nella stessa transazione.</span><span class="sxs-lookup"><span data-stu-id="74a1e-122">If allowed, the same query could return different rows when executed twice in the same transaction.</span></span>

<span data-ttu-id="74a1e-123">Microsoft. Data. sqlite considera il valore IsolationLevel passato a <xref:Microsoft.Data.Sqlite.SqliteConnection.BeginTransaction%2A> come livello minimo.</span><span class="sxs-lookup"><span data-stu-id="74a1e-123">Microsoft.Data.Sqlite treats the IsolationLevel passed to <xref:Microsoft.Data.Sqlite.SqliteConnection.BeginTransaction%2A> as a minimum level.</span></span> <span data-ttu-id="74a1e-124">Il livello di isolamento effettivo verrà promosso a Read uncommitted o Serializable.</span><span class="sxs-lookup"><span data-stu-id="74a1e-124">The actual isolation level will be promoted to either read uncommitted or serializable.</span></span>

<span data-ttu-id="74a1e-125">Il codice seguente simula una lettura dirty.</span><span class="sxs-lookup"><span data-stu-id="74a1e-125">The following code simulates a dirty read.</span></span> <span data-ttu-id="74a1e-126">Si noti che la stringa di connessione deve includere `Cache=Shared`.</span><span class="sxs-lookup"><span data-stu-id="74a1e-126">Note, the connection string must include `Cache=Shared`.</span></span>

[!code-csharp[](../../../../samples/snippets/standard/data/sqlite/DirtyReadSample/Program.cs?name=snippet_DirtyRead)]
