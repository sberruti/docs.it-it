---
title: Gestione degli errori di I/O in .NET
ms.date: 08/27/2018
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- I/O, exception handling
- I/O, errors
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 51eb0e758f1ae8fb41c842ef9b32a9f8928af9ac
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/15/2020
ms.locfileid: "73120737"
---
# <a name="handling-io-errors-in-net"></a><span data-ttu-id="706a1-102">Gestione degli errori di I/O in .NET</span><span class="sxs-lookup"><span data-stu-id="706a1-102">Handling I/O errors in .NET</span></span>

<span data-ttu-id="706a1-103">Oltre alle eccezioni che possono essere generate in qualsiasi chiamata a un metodo (ad esempio, <xref:System.OutOfMemoryException> quando un sistema è in sovraccarico o <xref:System.NullReferenceException> a causa di un errore del programmatore), i metodi del file system .NET possono generare le eccezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="706a1-103">In addition to the exceptions that can be thrown in any method call (such as an <xref:System.OutOfMemoryException> when a system is stressed or an <xref:System.NullReferenceException> due to programmer error), .NET file system methods can throw the following exceptions:</span></span>

- <span data-ttu-id="706a1-104"><xref:System.IO.IOException?displayProperty=nameWithType>, la classe di base di tutti i tipi di eccezioni <xref:System.IO>.</span><span class="sxs-lookup"><span data-stu-id="706a1-104"><xref:System.IO.IOException?displayProperty=nameWithType>, the base class of all <xref:System.IO> exception types.</span></span> <span data-ttu-id="706a1-105">Viene generata per gli errori i cui codici restituiti dal sistema operativo non eseguono il mapping diretto a nessun altro tipo di eccezione.</span><span class="sxs-lookup"><span data-stu-id="706a1-105">It is thrown for errors whose return codes from the operating system don't directly map to any other exception type.</span></span>
- <span data-ttu-id="706a1-106"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="706a1-106"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="706a1-107"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="706a1-107"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="706a1-108"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="706a1-108"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="706a1-109"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="706a1-109"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="706a1-110"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="706a1-110"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="706a1-111"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="706a1-111"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="706a1-112"><xref:System.ArgumentException?displayProperty=nameWithType>, generata per i caratteri non validi nel percorso in .NET Framework e in .NET Core 2.0 e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="706a1-112"><xref:System.ArgumentException?displayProperty=nameWithType>, which is thrown for invalid path characters on .NET Framework and on .NET Core 2.0 and previous versions.</span></span>
- <span data-ttu-id="706a1-113"><xref:System.NotSupportedException?displayProperty=nameWithType>, generata per i caratteri due punti non validi in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="706a1-113"><xref:System.NotSupportedException?displayProperty=nameWithType>, which is thrown for invalid colons in .NET Framework.</span></span>
- <span data-ttu-id="706a1-114"><xref:System.Security.SecurityException?displayProperty=nameWithType>, generata per le applicazioni in esecuzione con attendibilità limitata senza le autorizzazioni necessarie solo in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="706a1-114"><xref:System.Security.SecurityException?displayProperty=nameWithType>, which is thrown for applications running in limited trust that lack the necessary permissions on .NET Framework only.</span></span> <span data-ttu-id="706a1-115">L'attendibilità totale è l'impostazione predefinita in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="706a1-115">(Full trust is the default on .NET Framework.)</span></span>

## <a name="mapping-error-codes-to-exceptions"></a><span data-ttu-id="706a1-116">Mapping dei codici di errore alle eccezioni</span><span class="sxs-lookup"><span data-stu-id="706a1-116">Mapping error codes to exceptions</span></span>

<span data-ttu-id="706a1-117">Poiché il file system è una risorsa del sistema operativo, i metodi di I/O sia in .NET Core che in .NET eseguono il wrapping delle chiamate nel sistema operativo sottostante.</span><span class="sxs-lookup"><span data-stu-id="706a1-117">Because the file system is an operating system resource, I/O methods in both .NET Core and .NET Framework wrap calls to the underlying operating system.</span></span> <span data-ttu-id="706a1-118">Quando si verifica un errore di I/O nel codice eseguito dal sistema operativo, il sistema operativo restituisce le informazioni sull'errore al metodo di I/O di .NET.</span><span class="sxs-lookup"><span data-stu-id="706a1-118">When an I/O error occurs in code executed by the operating system, the operating system returns error information to the .NET I/O method.</span></span> <span data-ttu-id="706a1-119">Il metodo converte quindi le informazioni sull'errore, in genere in formato codice di errore, in un tipo di eccezione .NET.</span><span class="sxs-lookup"><span data-stu-id="706a1-119">The method then translates the error information, typically in the form of an error code, into a .NET exception type.</span></span> <span data-ttu-id="706a1-120">Nella maggior parte dei casi, esegue questa operazione convertendo direttamente il codice di errore nel tipo di eccezione corrispondente, senza eseguire mapping specifici dell'errore basati sul contesto della chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="706a1-120">In most cases, it does this by directly translating the error code into its corresponding exception type; it does not perform any special mapping of the error based on the context of the method call.</span></span>

<span data-ttu-id="706a1-121">Nel sistema operativo Windows, ad esempio, una chiamata a un metodo che restituisce un codice di errore `ERROR_FILE_NOT_FOUND` (o 0x02) esegue il mapping a <xref:System.IO.FileNotFoundException> e un codice di errore `ERROR_PATH_NOT_FOUND` (o 0x03) esegue il mapping a <xref:System.IO.DirectoryNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="706a1-121">For example, on the Windows operating system, a method call that returns an error code of `ERROR_FILE_NOT_FOUND` (or 0x02) maps to a <xref:System.IO.FileNotFoundException>, and an error code of `ERROR_PATH_NOT_FOUND` (or 0x03) maps to a <xref:System.IO.DirectoryNotFoundException>.</span></span>

<span data-ttu-id="706a1-122">Tuttavia, le condizioni esatte in cui il sistema operativo restituisce determinati codici di errore spesso sono poco o per nulla documentate.</span><span class="sxs-lookup"><span data-stu-id="706a1-122">However, the precise conditions under which the operating system returns particular error codes is often undocumented or poorly documented.</span></span> <span data-ttu-id="706a1-123">Possono quindi verificarsi eccezioni impreviste.</span><span class="sxs-lookup"><span data-stu-id="706a1-123">As a result, unexpected exceptions can occur.</span></span> <span data-ttu-id="706a1-124">Poiché ad esempio si usa una directory invece di un file, se si fornisse un percorso di directory non valido al costruttore <xref:System.IO.DirectoryInfo.%23ctor%2A?displayProperty=nameWithType>, dovrebbe essere generata un'eccezione <xref:System.IO.DirectoryNotFoundException>,</span><span class="sxs-lookup"><span data-stu-id="706a1-124">For example, because you are working with a directory rather than a file, you would expect that providing an invalid directory path to the <xref:System.IO.DirectoryInfo.%23ctor%2A?displayProperty=nameWithType> constructor throws a <xref:System.IO.DirectoryNotFoundException>.</span></span> <span data-ttu-id="706a1-125">ma potrebbe anche venire generata un'eccezione <xref:System.IO.FileNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="706a1-125">However, it may also throw a <xref:System.IO.FileNotFoundException>.</span></span>

## <a name="exception-handling-in-io-operations"></a><span data-ttu-id="706a1-126">Gestione delle eccezioni nelle operazioni di I/O</span><span class="sxs-lookup"><span data-stu-id="706a1-126">Exception handling in I/O operations</span></span>

<span data-ttu-id="706a1-127">A causa di questa dipendenza dal sistema operativo, con condizioni di eccezione identiche (come l'errore di directory non trovata dell'esempio) un metodo di I/O può generare una qualsiasi tra tutte le eccezioni di I/O della classe.</span><span class="sxs-lookup"><span data-stu-id="706a1-127">Because of this reliance on the operating system, identical exception conditions (such as the directory not found error in our example) can result in an I/O method throwing any one of the entire class of I/O exceptions.</span></span> <span data-ttu-id="706a1-128">Pertanto, quando si chiamano le API di I/O, il codice deve essere preparato per gestire tutte o quasi tutte le eccezioni, come illustrato nella tabella seguente:</span><span class="sxs-lookup"><span data-stu-id="706a1-128">This means that, when calling I/O APIs, your code should be prepared to handle most or all of these exceptions, as shown in the following table:</span></span>

| <span data-ttu-id="706a1-129">Tipo di eccezione</span><span class="sxs-lookup"><span data-stu-id="706a1-129">Exception type</span></span> | <span data-ttu-id="706a1-130">.NET Core</span><span class="sxs-lookup"><span data-stu-id="706a1-130">.NET Core</span></span> | <span data-ttu-id="706a1-131">.NET Framework</span><span class="sxs-lookup"><span data-stu-id="706a1-131">.NET Framework</span></span> |
|---|---|---|
| <xref:System.IO.IOException> | <span data-ttu-id="706a1-132">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-132">Yes</span></span> | <span data-ttu-id="706a1-133">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-133">Yes</span></span> |
| <xref:System.IO.FileNotFoundException> | <span data-ttu-id="706a1-134">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-134">Yes</span></span> | <span data-ttu-id="706a1-135">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-135">Yes</span></span> |
| <xref:System.IO.DirectoryNotFoundException> | <span data-ttu-id="706a1-136">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-136">Yes</span></span> | <span data-ttu-id="706a1-137">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-137">Yes</span></span> |
| <xref:System.IO.DriveNotFoundException?> | <span data-ttu-id="706a1-138">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-138">Yes</span></span> | <span data-ttu-id="706a1-139">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-139">Yes</span></span> |
| <xref:System.IO.PathTooLongException> | <span data-ttu-id="706a1-140">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-140">Yes</span></span> | <span data-ttu-id="706a1-141">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-141">Yes</span></span> |
| <xref:System.OperationCanceledException> | <span data-ttu-id="706a1-142">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-142">Yes</span></span> | <span data-ttu-id="706a1-143">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-143">Yes</span></span> |
| <xref:System.UnauthorizedAccessException> | <span data-ttu-id="706a1-144">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-144">Yes</span></span> | <span data-ttu-id="706a1-145">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-145">Yes</span></span> |
| <xref:System.ArgumentException> | <span data-ttu-id="706a1-146">.NET Core 2.0 e versioni precedenti</span><span class="sxs-lookup"><span data-stu-id="706a1-146">.NET Core 2.0 and earlier</span></span>| <span data-ttu-id="706a1-147">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-147">Yes</span></span> |
| <xref:System.NotSupportedException> | <span data-ttu-id="706a1-148">No</span><span class="sxs-lookup"><span data-stu-id="706a1-148">No</span></span> | <span data-ttu-id="706a1-149">Sì</span><span class="sxs-lookup"><span data-stu-id="706a1-149">Yes</span></span> |
| <xref:System.Security.SecurityException> | <span data-ttu-id="706a1-150">No</span><span class="sxs-lookup"><span data-stu-id="706a1-150">No</span></span> | <span data-ttu-id="706a1-151">Solo attendibilità limitata</span><span class="sxs-lookup"><span data-stu-id="706a1-151">Limited trust only</span></span> |

## <a name="handling-ioexception"></a><span data-ttu-id="706a1-152">Gestione di IOException</span><span class="sxs-lookup"><span data-stu-id="706a1-152">Handling IOException</span></span>

<span data-ttu-id="706a1-153">In quanto classe di base per le eccezioni nello spazio dei nomi <xref:System.IO>, viene generata un'eccezione <xref:System.IO.IOException> anche per i codici di errore che non eseguono il mapping a un tipo di eccezione predefinito.</span><span class="sxs-lookup"><span data-stu-id="706a1-153">As the base class for exceptions in the <xref:System.IO> namespace, <xref:System.IO.IOException> is also thrown for any error code that does not map to a predefined exception type.</span></span> <span data-ttu-id="706a1-154">Può essere quindi generata da qualsiasi operazione di I/O.</span><span class="sxs-lookup"><span data-stu-id="706a1-154">This means that it can be thrown by any I/O operation.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="706a1-155">Poiché <xref:System.IO.IOException> è la classe di base degli altri tipi di eccezioni nello spazio dei nomi <xref:System.IO>, è consigliabile gestire un blocco `catch` dopo aver gestito le altre eccezioni relative alle operazioni di I/O.</span><span class="sxs-lookup"><span data-stu-id="706a1-155">Because <xref:System.IO.IOException> is the base class of the other exception types in the <xref:System.IO> namespace, you should handle in a `catch` block after you've handled the other I/O-related exceptions.</span></span>

<span data-ttu-id="706a1-156">Inoltre, a partire da .NET Core 2.1, i controlli di convalida della correttezza del percorso (ad esempio, per assicurarsi che in un percorso non siano presenti caratteri non validi) sono stati rimossi e il runtime genera un'eccezione di cui viene eseguito il mapping da un codice di errore del sistema operativo invece che dal proprio codice di convalida.</span><span class="sxs-lookup"><span data-stu-id="706a1-156">In addition, starting with .NET Core 2.1, validation checks for path correctness (for example, to ensure that invalid characters are not present in a path) have been removed, and the runtime throws an exception mapped from an operating system error code rather than from its own validation code.</span></span> <span data-ttu-id="706a1-157">In questo caso l'eccezione che viene generata con maggior probabilità è <xref:System.IO.IOException>, ma potrebbe essere generato qualsiasi altro tipo di eccezione.</span><span class="sxs-lookup"><span data-stu-id="706a1-157">The most likely exception to be thrown in this case is an <xref:System.IO.IOException>, although any other exception type could also be thrown.</span></span>

<span data-ttu-id="706a1-158">Si noti che nel codice di gestione dell'eccezione, si dovrà gestire sempre per ultima <xref:System.IO.IOException>.</span><span class="sxs-lookup"><span data-stu-id="706a1-158">Note that, in your exception handling code, you should always handle the <xref:System.IO.IOException> last.</span></span> <span data-ttu-id="706a1-159">In caso contrario, poiché si tratta della classe di base di tutte le altre eccezioni di I/O, i blocchi catch di classi derivate non verranno valutati.</span><span class="sxs-lookup"><span data-stu-id="706a1-159">Otherwise, because it is the base class of all other IO exceptions, the catch blocks of derived classes will not be evaluated.</span></span>

<span data-ttu-id="706a1-160">Nel caso di <xref:System.IO.IOException>, è possibile ottenere altre informazioni sull'errore dalla proprietà [IOException.HResult](xref:System.Exception.HResult).</span><span class="sxs-lookup"><span data-stu-id="706a1-160">In the case of an <xref:System.IO.IOException>, you can get additional error information from the [IOException.HResult](xref:System.Exception.HResult) property.</span></span> <span data-ttu-id="706a1-161">Per convertire il valore HResult in un codice di errore Win32, si rimuovono i 16 bit superiori del valore da 32 bit.</span><span class="sxs-lookup"><span data-stu-id="706a1-161">To convert the HResult value to a Win32 error code, you strip out the upper 16 bits of the 32-bit value.</span></span> <span data-ttu-id="706a1-162">La tabella seguente elenca i codici di errore di cui potrebbe essere eseguito il wrapping in un'eccezione <xref:System.IO.IOException>.</span><span class="sxs-lookup"><span data-stu-id="706a1-162">The following table lists error codes that may be wrapped in an <xref:System.IO.IOException>.</span></span>

| <span data-ttu-id="706a1-163">HResult</span><span class="sxs-lookup"><span data-stu-id="706a1-163">HResult</span></span> | <span data-ttu-id="706a1-164">Costante</span><span class="sxs-lookup"><span data-stu-id="706a1-164">Constant</span></span> | <span data-ttu-id="706a1-165">Descrizione</span><span class="sxs-lookup"><span data-stu-id="706a1-165">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="706a1-166">ERROR_SHARING_VIOLATION</span><span class="sxs-lookup"><span data-stu-id="706a1-166">ERROR_SHARING_VIOLATION</span></span> | <span data-ttu-id="706a1-167">32</span><span class="sxs-lookup"><span data-stu-id="706a1-167">32</span></span> | <span data-ttu-id="706a1-168">Il nome del file è mancante oppure il file o la directory è in uso.</span><span class="sxs-lookup"><span data-stu-id="706a1-168">The file name is missing, or the file or directory is in use.</span></span> |
| <span data-ttu-id="706a1-169">ERROR_FILE_EXISTS</span><span class="sxs-lookup"><span data-stu-id="706a1-169">ERROR_FILE_EXISTS</span></span> | <span data-ttu-id="706a1-170">80</span><span class="sxs-lookup"><span data-stu-id="706a1-170">80</span></span> | <span data-ttu-id="706a1-171">File già esistente.</span><span class="sxs-lookup"><span data-stu-id="706a1-171">The file already exists.</span></span> |
| <span data-ttu-id="706a1-172">ERROR_INVALID_PARAMETER</span><span class="sxs-lookup"><span data-stu-id="706a1-172">ERROR_INVALID_PARAMETER</span></span> | <span data-ttu-id="706a1-173">87</span><span class="sxs-lookup"><span data-stu-id="706a1-173">87</span></span> | <span data-ttu-id="706a1-174">Un argomento fornito al metodo non è valido.</span><span class="sxs-lookup"><span data-stu-id="706a1-174">An argument supplied to the method is invalid.</span></span> |
| <span data-ttu-id="706a1-175">ERROR_ALREADY_EXISTS</span><span class="sxs-lookup"><span data-stu-id="706a1-175">ERROR_ALREADY_EXISTS</span></span> | <span data-ttu-id="706a1-176">183</span><span class="sxs-lookup"><span data-stu-id="706a1-176">183</span></span> | <span data-ttu-id="706a1-177">File o directory già esistente.</span><span class="sxs-lookup"><span data-stu-id="706a1-177">The file or directory already exists.</span></span> |

<span data-ttu-id="706a1-178">È possibile gestirli usando una clausola `When` in un'istruzione catch, come illustrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="706a1-178">You can handle these using a `When` clause in a catch statement, as the following example shows.</span></span>

[!code-csharp[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/cs/io-exceptions.cs)]
[!code-vb[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/vb/io-exceptions.vb)]

## <a name="see-also"></a><span data-ttu-id="706a1-179">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="706a1-179">See also</span></span>

- [<span data-ttu-id="706a1-180">Gestione e generazione di eccezioni in .NET</span><span class="sxs-lookup"><span data-stu-id="706a1-180">Handling and throwing exceptions in .NET</span></span>](../exceptions/index.md)
- [<span data-ttu-id="706a1-181">Gestione delle eccezioni (Task Parallel Library)</span><span class="sxs-lookup"><span data-stu-id="706a1-181">Exception handling (Task Parallel Library)</span></span>](../parallel-programming/exception-handling-task-parallel-library.md)
- [<span data-ttu-id="706a1-182">Procedure consigliate per le eccezioni</span><span class="sxs-lookup"><span data-stu-id="706a1-182">Best practices for exceptions</span></span>](../exceptions/best-practices-for-exceptions.md)
- [<span data-ttu-id="706a1-183">Come usare eccezioni specifiche in un blocco catch</span><span class="sxs-lookup"><span data-stu-id="706a1-183">How to use specific exceptions in a catch block</span></span>](../exceptions/how-to-use-specific-exceptions-in-a-catch-block.md)
