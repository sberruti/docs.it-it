---
title: Strutture di dati per la programmazione in parallelo
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- data structures, multi-threading
ms.assetid: bdc82f2f-4754-45a1-a81e-fe2e9c30cef9
ms.openlocfilehash: a2271feae78100940b4ecac3c42c9bfefa7e1769
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/15/2020
ms.locfileid: "73123143"
---
# <a name="data-structures-for-parallel-programming"></a><span data-ttu-id="2ee70-102">Strutture di dati per la programmazione in parallelo</span><span class="sxs-lookup"><span data-stu-id="2ee70-102">Data Structures for Parallel Programming</span></span>
<span data-ttu-id="2ee70-103">In .NET Framework versione 4 sono stati introdotti diversi nuovi tipi utili nella programmazione parallela, inclusi un set di classi di raccolta simultanee, primitive di sincronizzazione leggera e tipi per l'inizializzazione differita.</span><span class="sxs-lookup"><span data-stu-id="2ee70-103">The .NET Framework version 4 introduces several new types that are useful in parallel programming, including a set of concurrent collection classes, lightweight synchronization primitives, and types for lazy initialization.</span></span> <span data-ttu-id="2ee70-104">È possibile usare questi tipi con qualsiasi codice dell'applicazione multithreading, inclusi Task Parallel Library e PLINQ.</span><span class="sxs-lookup"><span data-stu-id="2ee70-104">You can use these types with any multithreaded application code, including the Task Parallel Library and PLINQ.</span></span>  
  
## <a name="concurrent-collection-classes"></a><span data-ttu-id="2ee70-105">Classi di raccolta simultanee</span><span class="sxs-lookup"><span data-stu-id="2ee70-105">Concurrent Collection Classes</span></span>  
 <span data-ttu-id="2ee70-106">Le classi di raccolta nello spazio dei nomi <xref:System.Collections.Concurrent?displayProperty=nameWithType> consentono di eseguire operazioni di aggiunta e rimozione thread-safe che, ove possibile, evitano i blocchi e, dove i blocchi sono necessari, usano quelli con granularità fine.</span><span class="sxs-lookup"><span data-stu-id="2ee70-106">The collection classes in the <xref:System.Collections.Concurrent?displayProperty=nameWithType> namespace provide thread-safe add and remove operations that avoid locks wherever possible and use fine-grained locking where locks are necessary.</span></span> <span data-ttu-id="2ee70-107">Diversamente dalle raccolte introdotte in .NET Framework versioni 1.0 e 2.0, in una classe di raccolta simultanea non è necessario che il codice utente acquisisca alcun blocco quando accede agli elementi.</span><span class="sxs-lookup"><span data-stu-id="2ee70-107">Unlike collections that were introduced in the .NET Framework versions 1.0 and 2.0, a concurrent collection class does not require user code to take any locks when it accesses items.</span></span> <span data-ttu-id="2ee70-108">Le classi di raccolta simultanee possono migliorare considerevolmente le prestazioni rispetto a tipi come <xref:System.Collections.ArrayList?displayProperty=nameWithType> e <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> (con il blocco implementato dall'utente) negli scenari in cui più thread aggiungono e rimuovono elementi da una raccolta.</span><span class="sxs-lookup"><span data-stu-id="2ee70-108">The concurrent collection classes can significantly improve performance over types such as <xref:System.Collections.ArrayList?displayProperty=nameWithType> and <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> (with user-implemented locking) in scenarios where multiple threads add and remove items from a collection.</span></span>  
  
 <span data-ttu-id="2ee70-109">Nella tabella seguente vengono elencate le nuove classi di raccolta simultanee:</span><span class="sxs-lookup"><span data-stu-id="2ee70-109">The following table lists the new concurrent collection classes:</span></span>  
  
|<span data-ttu-id="2ee70-110">Type</span><span class="sxs-lookup"><span data-stu-id="2ee70-110">Type</span></span>|<span data-ttu-id="2ee70-111">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2ee70-111">Description</span></span>|  
|----------|-----------------|  
|<xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>|<span data-ttu-id="2ee70-112">Fornisce funzionalità di blocco e limitazione per le raccolte thread-safe che implementano <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2ee70-112">Provides blocking and bounding capabilities for thread-safe collections that implement <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="2ee70-113">I thread producer vengono bloccati se non sono disponibili slot o se la raccolta è completa.</span><span class="sxs-lookup"><span data-stu-id="2ee70-113">Producer threads block if no slots are available or if the collection is full.</span></span> <span data-ttu-id="2ee70-114">I thread consumer vengono bloccati se la raccolta è vuota.</span><span class="sxs-lookup"><span data-stu-id="2ee70-114">Consumer threads block if the collection is empty.</span></span> <span data-ttu-id="2ee70-115">Questo tipo supporta anche l'accesso che non causa blocchi da parte di consumer e producer.</span><span class="sxs-lookup"><span data-stu-id="2ee70-115">This type also supports non-blocking access by consumers and producers.</span></span> <span data-ttu-id="2ee70-116"><xref:System.Collections.Concurrent.BlockingCollection%601> può essere usata come classe di base o archivio di backup per fornire funzionalità di blocco limitazione per le classi di raccolta che supportano <xref:System.Collections.Generic.IEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="2ee70-116"><xref:System.Collections.Concurrent.BlockingCollection%601> can be used as a base class or backing store to provide blocking and bounding for any collection class that supports <xref:System.Collections.Generic.IEnumerable%601>.</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentBag%601?displayProperty=nameWithType>|<span data-ttu-id="2ee70-117">Implementazione di un contenitore thread-safe che fornisce operazioni add e get scalabili.</span><span class="sxs-lookup"><span data-stu-id="2ee70-117">A thread-safe bag implementation that provides scalable add and get operations.</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentDictionary%602?displayProperty=nameWithType>|<span data-ttu-id="2ee70-118">Tipo di dizionario simultaneo e scalabile.</span><span class="sxs-lookup"><span data-stu-id="2ee70-118">A concurrent and scalable dictionary type.</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>|<span data-ttu-id="2ee70-119">Coda FIFO simultanea e scalabile.</span><span class="sxs-lookup"><span data-stu-id="2ee70-119">A concurrent and scalable FIFO queue.</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentStack%601?displayProperty=nameWithType>|<span data-ttu-id="2ee70-120">Stack LIFO simultaneo e scalabile.</span><span class="sxs-lookup"><span data-stu-id="2ee70-120">A concurrent and scalable LIFO stack.</span></span>|  
  
 <span data-ttu-id="2ee70-121">Per altre informazioni, vedere [Raccolte thread-safe](../../../docs/standard/collections/thread-safe/index.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-121">For more information, see [Thread-Safe Collections](../../../docs/standard/collections/thread-safe/index.md).</span></span>  
  
## <a name="synchronization-primitives"></a><span data-ttu-id="2ee70-122">Primitive di sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="2ee70-122">Synchronization Primitives</span></span>  
 <span data-ttu-id="2ee70-123">Le nuove primitive di sincronizzazione nello spazio dei nomi <xref:System.Threading?displayProperty=nameWithType> consentono la concorrenza con granularità fine e prestazioni più veloci evitando i costosi meccanismi di blocco del codice multithreading legacy.</span><span class="sxs-lookup"><span data-stu-id="2ee70-123">The new synchronization primitives in the <xref:System.Threading?displayProperty=nameWithType> namespace enable fine-grained concurrency and faster performance by avoiding expensive locking mechanisms found in legacy multithreading code.</span></span> <span data-ttu-id="2ee70-124">Alcuni dei nuovi tipi, ad esempio <xref:System.Threading.Barrier?displayProperty=nameWithType> e <xref:System.Threading.CountdownEvent?displayProperty=nameWithType> non hanno controparti nelle versioni precedenti di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2ee70-124">Some of the new types, such as <xref:System.Threading.Barrier?displayProperty=nameWithType> and <xref:System.Threading.CountdownEvent?displayProperty=nameWithType> have no counterparts in earlier releases of the .NET Framework.</span></span>  
  
 <span data-ttu-id="2ee70-125">La tabella seguente elenca i nuovi tipi di sincronizzazione:</span><span class="sxs-lookup"><span data-stu-id="2ee70-125">The following table lists the new synchronization types:</span></span>  
  
|<span data-ttu-id="2ee70-126">Type</span><span class="sxs-lookup"><span data-stu-id="2ee70-126">Type</span></span>|<span data-ttu-id="2ee70-127">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2ee70-127">Description</span></span>|  
|----------|-----------------|  
|<xref:System.Threading.Barrier?displayProperty=nameWithType>|<span data-ttu-id="2ee70-128">Consente a più thread di usare un algoritmo in parallelo fornendo un punto in cui ogni attività può segnalare il proprio arrivo e quindi venire bloccata finché non arrivano alcune o tutte le attività.</span><span class="sxs-lookup"><span data-stu-id="2ee70-128">Enables multiple threads to work on an algorithm in parallel by providing a point at which each task can signal its arrival and then block until some or all tasks have arrived.</span></span> <span data-ttu-id="2ee70-129">Per altre informazioni, vedere [Barriera](../../../docs/standard/threading/barrier.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-129">For more information, see [Barrier](../../../docs/standard/threading/barrier.md).</span></span>|  
|<xref:System.Threading.CountdownEvent?displayProperty=nameWithType>|<span data-ttu-id="2ee70-130">Semplifica gli scenari di fork e join fornendo un agevole meccanismo di rendezvous.</span><span class="sxs-lookup"><span data-stu-id="2ee70-130">Simplifies fork and join scenarios by providing an easy rendezvous mechanism.</span></span> <span data-ttu-id="2ee70-131">Per altre informazioni, vedere [CountdownEvent](../../../docs/standard/threading/countdownevent.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-131">For more information, see [CountdownEvent](../../../docs/standard/threading/countdownevent.md).</span></span>|  
|<xref:System.Threading.ManualResetEventSlim?displayProperty=nameWithType>|<span data-ttu-id="2ee70-132">Primitiva di sincronizzazione simile a <xref:System.Threading.ManualResetEvent?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2ee70-132">A synchronization primitive similar to <xref:System.Threading.ManualResetEvent?displayProperty=nameWithType>.</span></span> <span data-ttu-id="2ee70-133"><xref:System.Threading.ManualResetEventSlim> è più semplice, ma può essere usata solo per la comunicazione all'interno di un processo.</span><span class="sxs-lookup"><span data-stu-id="2ee70-133"><xref:System.Threading.ManualResetEventSlim> is lighter-weight but can only be used for intra-process communication.</span></span>|  
|<xref:System.Threading.SemaphoreSlim?displayProperty=nameWithType>|<span data-ttu-id="2ee70-134">Primitiva di sincronizzazione che limita il numero di thread che possono accedere simultaneamente a una risorsa o a un pool di risorse.</span><span class="sxs-lookup"><span data-stu-id="2ee70-134">A synchronization primitive that limits the number of threads that can concurrently access a resource or a pool of resources.</span></span> <span data-ttu-id="2ee70-135">Per altre informazioni, vedere [Semaphore e SemaphoreSlim](../../../docs/standard/threading/semaphore-and-semaphoreslim.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-135">For more information, see [Semaphore and SemaphoreSlim](../../../docs/standard/threading/semaphore-and-semaphoreslim.md).</span></span>|  
|<xref:System.Threading.SpinLock?displayProperty=nameWithType>|<span data-ttu-id="2ee70-136">Primitiva di blocco a esclusione reciproca che fa in modo che il thread che prova ad acquisire il blocco rimanga in attesa in un ciclo, o *spin*, per un determinato periodo di tempo prima di sospendere il quantum.</span><span class="sxs-lookup"><span data-stu-id="2ee70-136">A mutual exclusion lock primitive that causes the thread that is trying to acquire the lock to wait in a loop, or *spin*, for a period of time before yielding its quantum.</span></span> <span data-ttu-id="2ee70-137">Negli scenari in cui si prevede che l'attesa nel blocco sarà breve, <xref:System.Threading.SpinLock> offre prestazioni migliori di altre forme di blocco.</span><span class="sxs-lookup"><span data-stu-id="2ee70-137">In scenarios where the wait for the lock is expected to be short, <xref:System.Threading.SpinLock> offers better performance than other forms of locking.</span></span> <span data-ttu-id="2ee70-138">Per altre informazioni, vedere [SpinLock](../../../docs/standard/threading/spinlock.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-138">For more information, see [SpinLock](../../../docs/standard/threading/spinlock.md).</span></span>|  
|<xref:System.Threading.SpinWait?displayProperty=nameWithType>|<span data-ttu-id="2ee70-139">Tipo leggero di piccole dimensioni che ruoterà per un periodo di tempo specificato e infine metterà il thread in uno stato di attesa se il numero spin viene superato.</span><span class="sxs-lookup"><span data-stu-id="2ee70-139">A small, lightweight type that will spin for a specified time and eventually put the thread into a wait state if the spin count is exceeded.</span></span>  <span data-ttu-id="2ee70-140">Per altre informazioni, vedere [SpinWait](../../../docs/standard/threading/spinwait.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-140">For more information, see [SpinWait](../../../docs/standard/threading/spinwait.md).</span></span>|  
  
 <span data-ttu-id="2ee70-141">Per altre informazioni, vedere:</span><span class="sxs-lookup"><span data-stu-id="2ee70-141">For more information, see:</span></span>  
  
- [<span data-ttu-id="2ee70-142">Procedura: utilizzare SpinLock per la sincronizzazione di basso livelloHow to: Use SpinLock for Low-Level Synchronization</span><span class="sxs-lookup"><span data-stu-id="2ee70-142">How to: Use SpinLock for Low-Level Synchronization</span></span>](../../../docs/standard/threading/how-to-use-spinlock-for-low-level-synchronization.md)  
  
- <span data-ttu-id="2ee70-143">[Procedura: sincronizzare operazioni simultanee con una barriera](../../../docs/standard/threading/how-to-synchronize-concurrent-operations-with-a-barrier.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-143">[How to: Synchronize Concurrent Operations with a Barrier](../../../docs/standard/threading/how-to-synchronize-concurrent-operations-with-a-barrier.md).</span></span>  
  
## <a name="lazy-initialization-classes"></a><span data-ttu-id="2ee70-144">Classi di inizializzazione differita</span><span class="sxs-lookup"><span data-stu-id="2ee70-144">Lazy Initialization Classes</span></span>  
 <span data-ttu-id="2ee70-145">Con l'inizializzazione differita, la memoria per un oggetto non viene allocata fino a quando non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="2ee70-145">With lazy initialization, the memory for an object is not allocated until it is needed.</span></span> <span data-ttu-id="2ee70-146">L'inizializzazione differita può migliorare le prestazioni distribuendo le allocazioni degli oggetti in modo uniforme per l'intera durata di un programma.</span><span class="sxs-lookup"><span data-stu-id="2ee70-146">Lazy initialization can improve performance by spreading object allocations evenly across the lifetime of a program.</span></span> <span data-ttu-id="2ee70-147">È possibile abilitare l'inizializzazione differita per qualsiasi tipo personalizzato eseguendo il wrapping del tipo <xref:System.Lazy%601>.</span><span class="sxs-lookup"><span data-stu-id="2ee70-147">You can enable lazy initialization for any custom type by wrapping the type <xref:System.Lazy%601>.</span></span>  
  
 <span data-ttu-id="2ee70-148">La tabella seguente elenca i nuovi tipi di inizializzazione differita:</span><span class="sxs-lookup"><span data-stu-id="2ee70-148">The following table lists the lazy initialization types:</span></span>  
  
|<span data-ttu-id="2ee70-149">Type</span><span class="sxs-lookup"><span data-stu-id="2ee70-149">Type</span></span>|<span data-ttu-id="2ee70-150">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2ee70-150">Description</span></span>|  
|----------|-----------------|  
|<xref:System.Lazy%601?displayProperty=nameWithType>|<span data-ttu-id="2ee70-151">Fornisce l'inizializzazione differita leggera e thread-safe.</span><span class="sxs-lookup"><span data-stu-id="2ee70-151">Provides lightweight, thread-safe lazy-initialization.</span></span>|  
|<xref:System.Threading.ThreadLocal%601?displayProperty=nameWithType>|<span data-ttu-id="2ee70-152">Fornisce un valore con inizializzazione differita per ogni thread e ogni thread richiama in modo differito la funzione di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="2ee70-152">Provides a lazily-initialized value on a per-thread basis, with each thread lazily-invoking the initialization function.</span></span>|  
|<xref:System.Threading.LazyInitializer?displayProperty=nameWithType>|<span data-ttu-id="2ee70-153">Fornisce metodi statici che evitano di dover allocare un'istanza di inizializzazione differita dedicata</span><span class="sxs-lookup"><span data-stu-id="2ee70-153">Provides static methods that avoid the need to allocate a dedicated, lazy-initialization instance.</span></span> <span data-ttu-id="2ee70-154">e usano invece i riferimenti per garantire che le destinazioni siano state inizializzate quando vi si accede.</span><span class="sxs-lookup"><span data-stu-id="2ee70-154">Instead, they use references to ensure targets have been initialized as they are accessed.</span></span>|  
  
 <span data-ttu-id="2ee70-155">Per altre informazioni, vedere [Inizializzazione differita](../../../docs/framework/performance/lazy-initialization.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-155">For more information, see [Lazy Initialization](../../../docs/framework/performance/lazy-initialization.md).</span></span>  
  
## <a name="aggregate-exceptions"></a><span data-ttu-id="2ee70-156">Eccezioni di aggregazione</span><span class="sxs-lookup"><span data-stu-id="2ee70-156">Aggregate Exceptions</span></span>  
 <span data-ttu-id="2ee70-157">Il tipo <xref:System.AggregateException?displayProperty=nameWithType> può essere usato per acquisire più eccezioni generate simultaneamente in thread separati e restituirle al thread di unione come un'unica eccezione.</span><span class="sxs-lookup"><span data-stu-id="2ee70-157">The <xref:System.AggregateException?displayProperty=nameWithType> type can be used to capture multiple exceptions that are thrown concurrently on separate threads, and return them to the joining thread as a single exception.</span></span> <span data-ttu-id="2ee70-158">I tipi <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> e <xref:System.Threading.Tasks.Parallel?displayProperty=nameWithType> e PLINQ usano ampiamente <xref:System.AggregateException> a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="2ee70-158">The <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> and <xref:System.Threading.Tasks.Parallel?displayProperty=nameWithType> types and PLINQ use <xref:System.AggregateException> extensively for this purpose.</span></span> <span data-ttu-id="2ee70-159">Per altre informazioni, vedere [Gestione delle eccezioni](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md) e [Procedura: Gestire le eccezioni in una query PLINQ](../../../docs/standard/parallel-programming/how-to-handle-exceptions-in-a-plinq-query.md).</span><span class="sxs-lookup"><span data-stu-id="2ee70-159">For more information, see [Exception Handling](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md) and [How to: Handle Exceptions in a PLINQ Query](../../../docs/standard/parallel-programming/how-to-handle-exceptions-in-a-plinq-query.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2ee70-160">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="2ee70-160">See also</span></span>

- <xref:System.Collections.Concurrent?displayProperty=nameWithType>
- <xref:System.Threading?displayProperty=nameWithType>
- [<span data-ttu-id="2ee70-161">Programmazione parallela</span><span class="sxs-lookup"><span data-stu-id="2ee70-161">Parallel Programming</span></span>](../../../docs/standard/parallel-programming/index.md)
