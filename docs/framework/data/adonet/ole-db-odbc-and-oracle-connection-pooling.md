---
title: Pool di connessioni OLE DB, ODBC e Oracle
ms.date: 03/30/2017
ms.assetid: 2bd83b1e-3ea9-43c4-bade-d9cdb9bbbb04
ms.openlocfilehash: 58ea5aa54a0f6acbc8d2400dd04eeba9ff498055
ms.sourcegitcommit: 8c99457955fc31785b36b3330c4ab6ce7984a7ba
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/29/2019
ms.locfileid: "75545036"
---
# <a name="ole-db-odbc-and-oracle-connection-pooling"></a><span data-ttu-id="4d8ce-102">Pool di connessioni OLE DB, ODBC e Oracle</span><span class="sxs-lookup"><span data-stu-id="4d8ce-102">OLE DB, ODBC, and Oracle connection pooling</span></span>

<span data-ttu-id="4d8ce-103">Il pool di connessioni consente di migliorare notevolmente le prestazioni e di aumentare la scalabilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-103">Pooling connections can significantly enhance the performance and scalability of your application.</span></span> <span data-ttu-id="4d8ce-104">In questa sezione viene illustrato il pool di connessioni per i provider di dati .NET Framework per OLE DB, ODBC e Oracle.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-104">This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC, and Oracle.</span></span>

## <a name="oledb"></a><span data-ttu-id="4d8ce-105">OleDb</span><span class="sxs-lookup"><span data-stu-id="4d8ce-105">OleDb</span></span>

<span data-ttu-id="4d8ce-106">Il provider di dati .NET Framework per OLE DB esegue automaticamente il pool di connessioni usando i pool di sessioni OLE DB.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-106">The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling.</span></span> <span data-ttu-id="4d8ce-107">È possibile usare gli argomenti di tipo stringa di connessione per abilitare o disabilitare i servizi OLE DB, incluso il pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-107">Connection string arguments can be used to enable or disable OLE DB services including pooling.</span></span> <span data-ttu-id="4d8ce-108">La stringa di connessione seguente, ad esempio, disabilita il pool di sessioni OLE DB e l'inserimento automatico negli elenchi delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-108">For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.</span></span>

```csharp
Provider=SQLOLEDB;OLE DB Services=-4;Data Source=localhost;Integrated Security=SSPI;
```

 <span data-ttu-id="4d8ce-109">Al termine dell'uso chiudere o eliminare sempre la connessione, in modo da restituirla al pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-109">We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool.</span></span> <span data-ttu-id="4d8ce-110">Le connessioni che non vengono chiuse in modo esplicito potrebbero non essere restituite al pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-110">Connections that are not explicitly closed may not get returned to the pool.</span></span> <span data-ttu-id="4d8ce-111">Ad esempio, una connessione che esce dall'ambito ma non viene chiusa in modo esplicito verrà restituita al pool di connessioni solo se è stata raggiunta la dimensione massima del pool e la connessione è ancora valida.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-111">For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.</span></span>

 <span data-ttu-id="4d8ce-112">Per ulteriori informazioni su OLE DB sessione o sul pool di risorse, nonché su come disabilitare il pool eseguendo l'override delle impostazioni predefinite del servizio OLE DB provider, vedere la [Guida per programmatori OLE DB](https://docs.microsoft.com/previous-versions/windows/desktop/ms713643(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="4d8ce-112">For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](https://docs.microsoft.com/previous-versions/windows/desktop/ms713643(v=vs.85)).</span></span>

## <a name="odbc"></a><span data-ttu-id="4d8ce-113">ODBC</span><span class="sxs-lookup"><span data-stu-id="4d8ce-113">ODBC</span></span>
 <span data-ttu-id="4d8ce-114">Il pool di connessioni per il provider di dati .NET Framework per ODBC è gestito da Gestione driver ODBC, che viene usato anche per la connessione e non è influenzato dal provider di dati .NET Framework per ODBC.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-114">Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.</span></span>

 <span data-ttu-id="4d8ce-115">Per abilitare o disabilitare il pool di connessioni, aprire **Amministrazione origine dati ODBC** nella cartella strumenti di amministrazione del pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-115">To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel.</span></span> <span data-ttu-id="4d8ce-116">La scheda **pool di connessioni** consente di specificare i parametri del pool di connessioni per ogni driver ODBC installato.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-116">The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed.</span></span> <span data-ttu-id="4d8ce-117">Le modifiche del pool di connessioni per uno specifico driver ODBC hanno effetto su tutte le applicazioni che utilizzano il driver ODBC.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-117">Connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.</span></span>

## <a name="oracleclient"></a><span data-ttu-id="4d8ce-118">OracleClient</span><span class="sxs-lookup"><span data-stu-id="4d8ce-118">OracleClient</span></span>
 <span data-ttu-id="4d8ce-119">Il provider di dati .NET Framework per Oracle fornisce automaticamente pool di connessioni per l'applicazione client ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-119">The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application.</span></span> <span data-ttu-id="4d8ce-120">È possibile inoltre specificare diversi modificatori delle stringhe di connessione per controllare il comportamento del pool. Per altre informazioni, vedere "Controllo del pool di connessioni con le parole chiave delle stringhe di connessione" in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-120">You can also supply several connection string modifiers to control connection pooling behavior (see "Controlling Connection Pooling with Connection String Keywords," later in this topic).</span></span>

### <a name="create-and-assign-pools"></a><span data-ttu-id="4d8ce-121">Creare e assegnare pool</span><span class="sxs-lookup"><span data-stu-id="4d8ce-121">Create and assign pools</span></span>
 <span data-ttu-id="4d8ce-122">Quando viene aperta una connessione, viene creato un pool di connessioni in base a un algoritmo esattamente corrispondente che associa il pool alla stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-122">When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection.</span></span> <span data-ttu-id="4d8ce-123">Ogni pool di connessioni è associato a una stringa di connessione distinta.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-123">Each connection pool is associated with a distinct connection string.</span></span> <span data-ttu-id="4d8ce-124">Quando viene aperta una nuova connessione, se la stringa di connessione non corrisponde esattamente a un pool esistente, viene creato un nuovo pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-124">When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.</span></span>

 <span data-ttu-id="4d8ce-125">Una volta creati, i pool di connessioni non vengono eliminati definitivamente fino a quando non termina il processo attivo.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-125">Once created, connection pools are not destroyed until the active process ends.</span></span> <span data-ttu-id="4d8ce-126">Per i pool che restano inattivi o vuoti vengono usate pochissime risorse di sistema.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-126">Maintaining inactive or empty pools uses very few system resources.</span></span>

### <a name="connection-addition"></a><span data-ttu-id="4d8ce-127">Aggiunta di connessioni</span><span class="sxs-lookup"><span data-stu-id="4d8ce-127">Connection Addition</span></span>
 <span data-ttu-id="4d8ce-128">Per ogni stringa di connessione univoca viene creato un pool di connessioni.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-128">A connection pool is created for each unique connection string.</span></span> <span data-ttu-id="4d8ce-129">Quando si crea un pool, vengono creati e aggiunti al pool più oggetti connessione in modo da soddisfare il requisito relativo alle dimensioni minime del pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-129">When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied.</span></span> <span data-ttu-id="4d8ce-130">Le connessioni vengono aggiunte al pool in base alle necessità, fino a raggiungere le dimensioni massime del pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-130">Connections are added to the pool as needed, up to the maximum pool size.</span></span>

 <span data-ttu-id="4d8ce-131">Quando viene richiesto un oggetto <xref:System.Data.OracleClient.OracleConnection>, esso viene ottenuto dal pool se è disponibile una connessione usabile.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-131">When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available.</span></span> <span data-ttu-id="4d8ce-132">Per essere usabile, la connessione non deve essere in uso, deve disporre di un contesto di transazione corrispondente oppure non deve essere associata ad alcun contesto di transazione e deve disporre, infine, di un collegamento valido al server.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-132">To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.</span></span>

 <span data-ttu-id="4d8ce-133">Se le dimensioni massime del pool sono state raggiunte e non è disponibile alcuna connessione usabile, la richiesta viene accodata.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-133">If the maximum pool size has been reached and no usable connection is available, the request is queued.</span></span> <span data-ttu-id="4d8ce-134">Con la funzione di pool delle connessioni questi requisiti vengono soddisfatti tramite la riallocazione delle connessioni rilasciate nel pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-134">The connection pooler satisfies these requests by reallocating connections as they are released back into the pool.</span></span> <span data-ttu-id="4d8ce-135">Una volta chiuse o eliminate, le connessioni vengono rilasciate nel pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-135">Connections are released back into the pool when they are closed or disposed.</span></span>

### <a name="connection-removal"></a><span data-ttu-id="4d8ce-136">Rimozione della connessione</span><span class="sxs-lookup"><span data-stu-id="4d8ce-136">Connection Removal</span></span>
 <span data-ttu-id="4d8ce-137">Il pool di connessione rimuove una connessione dal pool dopo che è rimasta inattiva per un periodo di tempo prolungato o se il pool rileva che la connessione al server è stata interrotta.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-137">The connection pooler removes a connection from the pool after it has been idle for an extended period of time or if the pooler detects that the connection with the server has been severed.</span></span> <span data-ttu-id="4d8ce-138">Questa operazione può essere rilevata solo dopo il tentativo di comunicare con il server.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-138">This can be detected only after attempting to communicate with the server.</span></span> <span data-ttu-id="4d8ce-139">Se viene individuata una connessione al server che non è più attiva, la connessione viene contrassegnata come non valida.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-139">If a connection is found that is no longer connected to the server, it is marked as invalid.</span></span> <span data-ttu-id="4d8ce-140">La funzione di pool delle connessioni analizza periodicamente i pool di connessioni alla ricerca di oggetti che sono stati rilasciati nel pool e che sono contrassegnati come non validi.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-140">The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid.</span></span> <span data-ttu-id="4d8ce-141">Queste connessioni vengono rimosse in modo permanente.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-141">These connections are then permanently removed.</span></span>

 <span data-ttu-id="4d8ce-142">Se esiste una connessione a un server non più disponibile, la connessione può essere recuperata dal pool anche se nessuna connessione è stata rilevata come interrotta e pertanto non è stata contrassegnata come non valida.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-142">If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid.</span></span> <span data-ttu-id="4d8ce-143">Quando si verifica questa situazione, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-143">When this occurs, an exception is generated.</span></span> <span data-ttu-id="4d8ce-144">È necessario, tuttavia, chiudere la connessione in modo da rilasciarla nel pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-144">However, you must still close the connection in order to release it back into the pool.</span></span>

 <span data-ttu-id="4d8ce-145">Non chiamare `Close` o `Dispose` su un oggetto `Connection`, `DataReader` o su qualsiasi altro oggetto gestito nel metodo `Finalize` della classe.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-145">Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class.</span></span> <span data-ttu-id="4d8ce-146">Nei finalizzatori rilasciare solo le risorse non gestite che la classe controlla direttamente.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-146">In a finalizer, only release unmanaged resources that your class owns directly.</span></span> <span data-ttu-id="4d8ce-147">Se nella classe non sono presenti risorse non gestite, non includere un metodo `Finalize` nella relativa definizione della classe.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-147">If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition.</span></span> <span data-ttu-id="4d8ce-148">Per altre informazioni, vedere [Garbage Collection](../../../standard/garbage-collection/index.md).</span><span class="sxs-lookup"><span data-stu-id="4d8ce-148">For more information, see [Garbage Collection](../../../standard/garbage-collection/index.md).</span></span>

### <a name="transaction-support"></a><span data-ttu-id="4d8ce-149">Supporto per le transazioni</span><span class="sxs-lookup"><span data-stu-id="4d8ce-149">Transaction Support</span></span>
 <span data-ttu-id="4d8ce-150">Le connessioni vengono recuperate dal pool e assegnate in base al contesto della transazione.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-150">Connections are drawn from the pool and assigned based on transaction context.</span></span> <span data-ttu-id="4d8ce-151">Il contesto del thread richiedente e la connessione assegnata devono corrispondere.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-151">The context of the requesting thread and the assigned connection must match.</span></span> <span data-ttu-id="4d8ce-152">Ogni pool di connessioni viene pertanto suddiviso in connessioni senza alcun contesto di transazione associato e in *N* suddivisioni, ognuna delle quali contiene connessioni con un particolare contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-152">Therefore, each connection pool is subdivided into connections with no associated transaction context and into *N* subdivisions that each contain connections with a particular transaction context.</span></span>

 <span data-ttu-id="4d8ce-153">Una volta chiusa, la connessione viene rilasciata nel pool e nella suddivisione appropriata in base al relativo contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-153">When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context.</span></span> <span data-ttu-id="4d8ce-154">La connessione può quindi essere chiusa senza generare un errore anche se è ancora in sospeso una transazione distribuita.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-154">Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending.</span></span> <span data-ttu-id="4d8ce-155">Questo sistema consente di eseguire o interrompere la transazione distribuita in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-155">This allows you to commit or abort the distributed transaction at a later time.</span></span>

### <a name="control-connection-pooling-with-connection-string-keywords"></a><span data-ttu-id="4d8ce-156">Controllare il pool di connessioni con le parole chiave della stringa di connessione</span><span class="sxs-lookup"><span data-stu-id="4d8ce-156">Control Connection Pooling with Connection String Keywords</span></span>
 <span data-ttu-id="4d8ce-157">La proprietà <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> dell'oggetto <xref:System.Data.OracleClient.OracleConnection> supporta le coppie chiave/valore della stringa di connessione che possono essere usare per regolare il comportamento della logica del pool di connessioni.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-157">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.</span></span>

 <span data-ttu-id="4d8ce-158">La tabella seguente descrive i valori <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> che consentono di regolare il comportamento del pool di connessioni.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-158">The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior.</span></span>

|<span data-ttu-id="4d8ce-159">Name</span><span class="sxs-lookup"><span data-stu-id="4d8ce-159">Name</span></span>|<span data-ttu-id="4d8ce-160">Default</span><span class="sxs-lookup"><span data-stu-id="4d8ce-160">Default</span></span>|<span data-ttu-id="4d8ce-161">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4d8ce-161">Description</span></span>|
|----------|-------------|-----------------|
|`Connection Lifetime`|<span data-ttu-id="4d8ce-162">0</span><span class="sxs-lookup"><span data-stu-id="4d8ce-162">0</span></span>|<span data-ttu-id="4d8ce-163">Quando una connessione viene restituita al pool, l'ora di creazione viene confrontata con l'ora corrente e la connessione viene eliminata definitivamente se l'intervallo è superiore al valore in secondi della durata della connessione specificato da `Connection Lifetime`.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-163">When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`.</span></span> <span data-ttu-id="4d8ce-164">Questa è utile nelle configurazioni cluster per applicare il bilanciamento del carico tra un server in esecuzione e un server appena portato online.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-164">This is useful in clustered configurations to force load balancing between a running server and a server just brought online.</span></span><br /><br /> <span data-ttu-id="4d8ce-165">Un valore zero (0) imposta il timeout massimo delle connessioni in pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-165">A value of zero (0) will cause pooled connections to have the maximum time-out.</span></span>|
|`Enlist`|<span data-ttu-id="4d8ce-166">'true'</span><span class="sxs-lookup"><span data-stu-id="4d8ce-166">'true'</span></span>|<span data-ttu-id="4d8ce-167">Se l'impostazione è `true`, la funzione di pool inserisce automaticamente la connessione nel contesto della transazione corrente del thread di creazione, se è disponibile un contesto di transazione.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-167">When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.</span></span>|
|`Max Pool Size`|<span data-ttu-id="4d8ce-168">100</span><span class="sxs-lookup"><span data-stu-id="4d8ce-168">100</span></span>|<span data-ttu-id="4d8ce-169">Numero massimo di connessioni consentite nel pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-169">The maximum number of connections allowed in the pool.</span></span>|
|`Min Pool Size`|<span data-ttu-id="4d8ce-170">0</span><span class="sxs-lookup"><span data-stu-id="4d8ce-170">0</span></span>|<span data-ttu-id="4d8ce-171">Numero minimo di connessioni gestite nel pool.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-171">The minimum number of connections maintained in the pool.</span></span>|
|`Pooling`|<span data-ttu-id="4d8ce-172">'true'</span><span class="sxs-lookup"><span data-stu-id="4d8ce-172">'true'</span></span>|<span data-ttu-id="4d8ce-173">Se l'impostazione è `true`, la connessione viene recuperata dal pool appropriato o, se necessario, creata e aggiunta al pool appropriato.</span><span class="sxs-lookup"><span data-stu-id="4d8ce-173">When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.</span></span>|

## <a name="see-also"></a><span data-ttu-id="4d8ce-174">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4d8ce-174">See also</span></span>

- [<span data-ttu-id="4d8ce-175">Pool di connessioni</span><span class="sxs-lookup"><span data-stu-id="4d8ce-175">Connection Pooling</span></span>](connection-pooling.md)
- [<span data-ttu-id="4d8ce-176">Performance Counters</span><span class="sxs-lookup"><span data-stu-id="4d8ce-176">Performance Counters</span></span>](performance-counters.md)
- [<span data-ttu-id="4d8ce-177">Panoramica di ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4d8ce-177">ADO.NET Overview</span></span>](ado-net-overview.md)
