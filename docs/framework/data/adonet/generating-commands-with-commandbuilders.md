---
title: Generazione di comandi tramite CommandBuilders
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 6e3fb8b5-373b-4f9e-ab03-a22693df8e91
ms.openlocfilehash: 76c2a6cb0661a0e39fc3a0dd599fcbb3c046f382
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79149612"
---
# <a name="generating-commands-with-commandbuilders"></a><span data-ttu-id="1df6a-102">Generazione di comandi tramite CommandBuilders</span><span class="sxs-lookup"><span data-stu-id="1df6a-102">Generating Commands with CommandBuilders</span></span>
<span data-ttu-id="1df6a-103">Se la proprietà `SelectCommand` viene specificata in modo dinamico in fase di esecuzione, ad esempio mediante uno strumento per query che accetta un comando testuale dell'utente, potrebbe non essere possibile specificare l'appropriato `InsertCommand`, `UpdateCommand` o `DeleteCommand` in fase di progettazione.</span><span class="sxs-lookup"><span data-stu-id="1df6a-103">When the `SelectCommand` property is dynamically specified at run time, such as through a query tool that takes a textual command from the user, you may not be able to specify the appropriate `InsertCommand`, `UpdateCommand`, or `DeleteCommand` at design time.</span></span> <span data-ttu-id="1df6a-104">Se <xref:System.Data.DataTable> esegue il mapping o viene generato da una singola tabella di database, è possibile usare l'oggetto <xref:System.Data.Common.DbCommandBuilder> per generare automaticamente gli oggetti `DeleteCommand`, `InsertCommand` e `UpdateCommand` di <xref:System.Data.Common.DbDataAdapter>.</span><span class="sxs-lookup"><span data-stu-id="1df6a-104">If your <xref:System.Data.DataTable> maps to or is generated from a single database table, you can take advantage of the <xref:System.Data.Common.DbCommandBuilder> object to automatically generate the `DeleteCommand`, `InsertCommand`, and `UpdateCommand` of the <xref:System.Data.Common.DbDataAdapter>.</span></span>  
  
 <span data-ttu-id="1df6a-105">Come requisito minimo, è necessario impostare la proprietà `SelectCommand` affinché la generazione automatica del comando venga eseguita correttamente.</span><span class="sxs-lookup"><span data-stu-id="1df6a-105">As a minimum requirement, you must set the `SelectCommand` property in order for automatic command generation to work.</span></span> <span data-ttu-id="1df6a-106">Lo schema della tabella recuperato dalla proprietà `SelectCommand` determina la sintassi delle istruzioni INSERT, UPDATE e DELETE generate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="1df6a-106">The table schema retrieved by the `SelectCommand` property determines the syntax of the automatically generated INSERT, UPDATE, and DELETE statements.</span></span>  
  
 <span data-ttu-id="1df6a-107"><xref:System.Data.Common.DbCommandBuilder> deve eseguire `SelectCommand` in modo da restituire i metadati necessari per creare i comandi SQL INSERT, UPDATE e DELETE.</span><span class="sxs-lookup"><span data-stu-id="1df6a-107">The <xref:System.Data.Common.DbCommandBuilder> must execute the `SelectCommand` in order to return the metadata necessary to construct the INSERT, UPDATE, and DELETE SQL commands.</span></span> <span data-ttu-id="1df6a-108">Di conseguenza, è necessario un ulteriore percorso all'origine dati che può ridurre le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="1df6a-108">As a result, an extra trip to the data source is necessary, and this can hinder performance.</span></span> <span data-ttu-id="1df6a-109">Per ottenere prestazioni ottimali, specificare i comandi in modo esplicito anziché usare <xref:System.Data.Common.DbCommandBuilder>.</span><span class="sxs-lookup"><span data-stu-id="1df6a-109">To achieve optimal performance, specify your commands explicitly rather than using the <xref:System.Data.Common.DbCommandBuilder>.</span></span>  
  
 <span data-ttu-id="1df6a-110">È inoltre necessario che `SelectCommand` restituisca almeno una chiave primaria o una colonna univoca.</span><span class="sxs-lookup"><span data-stu-id="1df6a-110">The `SelectCommand` must also return at least one primary key or unique column.</span></span> <span data-ttu-id="1df6a-111">In caso contrario, viene generata un'eccezione `InvalidOperation` e i comandi non vengono generati.</span><span class="sxs-lookup"><span data-stu-id="1df6a-111">If none are present, an `InvalidOperation` exception is generated, and the commands are not generated.</span></span>  
  
 <span data-ttu-id="1df6a-112">Quando è associato a un `DataAdapter`, <xref:System.Data.Common.DbCommandBuilder> genera automaticamente le proprietà `InsertCommand`, `UpdateCommand` e `DeleteCommand` del `DataAdapter`, se queste sono riferimenti Null.</span><span class="sxs-lookup"><span data-stu-id="1df6a-112">When associated with a `DataAdapter`, the <xref:System.Data.Common.DbCommandBuilder> automatically generates the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties of the `DataAdapter` if they are null references.</span></span> <span data-ttu-id="1df6a-113">Se esiste già un oggetto `Command` per una proprietà, viene usato l'oggetto `Command` esistente.</span><span class="sxs-lookup"><span data-stu-id="1df6a-113">If a `Command` already exists for a property, the existing `Command` is used.</span></span>  
  
 <span data-ttu-id="1df6a-114">Le visualizzazioni di database create dall'unione di due o più tabelle non vengono considerate un'unica tabella di database.</span><span class="sxs-lookup"><span data-stu-id="1df6a-114">Database views that are created by joining two or more tables together are not considered a single database table.</span></span> <span data-ttu-id="1df6a-115">In questo caso non è possibile usare <xref:System.Data.Common.DbCommandBuilder> per generare automaticamente i comandi ed è necessario specificarli in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="1df6a-115">In this instance you cannot use the <xref:System.Data.Common.DbCommandBuilder> to automatically generate commands; you must specify your commands explicitly.</span></span> <span data-ttu-id="1df6a-116">Per informazioni sull'impostazione esplicita `DataSet` dei comandi per risolvere gli aggiornamenti in una nuova origine dati, vedere [Aggiornamento delle origini dati con DataAdapter](updating-data-sources-with-dataadapters.md).</span><span class="sxs-lookup"><span data-stu-id="1df6a-116">For information about explicitly setting commands to resolve updates to a `DataSet` back to the data source, see [Updating Data Sources with DataAdapters](updating-data-sources-with-dataadapters.md).</span></span>  
  
 <span data-ttu-id="1df6a-117">È possibile eseguire il mapping dei parametri di output alla riga aggiornata di un `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="1df6a-117">You might want to map output parameters back to the updated row of a `DataSet`.</span></span> <span data-ttu-id="1df6a-118">Un'attività comune sarebbe il recupero del valore di un campo identità generato automaticamente o del timestamp da un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="1df6a-118">One common task would be retrieving the value of an automatically generated identity field or time stamp from the data source.</span></span> <span data-ttu-id="1df6a-119">Per impostazione predefinita, <xref:System.Data.Common.DbCommandBuilder> non esegue il mapping dei parametri di output sulle colonne in una riga aggiornata.</span><span class="sxs-lookup"><span data-stu-id="1df6a-119">The <xref:System.Data.Common.DbCommandBuilder> will not map output parameters to columns in an updated row by default.</span></span> <span data-ttu-id="1df6a-120">In questo caso è necessario specificare il comando in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="1df6a-120">In this instance you must specify your command explicitly.</span></span> <span data-ttu-id="1df6a-121">Per un esempio di mapping di un campo Identity generato automaticamente a una colonna di una riga inserita, vedere Recupero di [valori Identity o Autonumber](retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="1df6a-121">For an example of mapping an automatically generated identity field back to a column of an inserted row, see [Retrieving Identity or Autonumber Values](retrieving-identity-or-autonumber-values.md).</span></span>  
  
## <a name="rules-for-automatically-generated-commands"></a><span data-ttu-id="1df6a-122">Regole per i comandi generati automaticamente</span><span class="sxs-lookup"><span data-stu-id="1df6a-122">Rules for Automatically Generated Commands</span></span>  
 <span data-ttu-id="1df6a-123">Nella tabella seguente vengono illustrate le regole per generare automaticamente i comandi.</span><span class="sxs-lookup"><span data-stu-id="1df6a-123">The following table shows the rules for how automatically generated commands are generated.</span></span>  
  
|<span data-ttu-id="1df6a-124">Comando</span><span class="sxs-lookup"><span data-stu-id="1df6a-124">Command</span></span>|<span data-ttu-id="1df6a-125">Regola</span><span class="sxs-lookup"><span data-stu-id="1df6a-125">Rule</span></span>|  
|-------------|----------|  
|`InsertCommand`|<span data-ttu-id="1df6a-126">Consente di inserire una riga nell'origine dati per ogni riga della tabella con una proprietà <xref:System.Data.DataRow.RowState%2A> uguale a <xref:System.Data.DataRowState.Added>.</span><span class="sxs-lookup"><span data-stu-id="1df6a-126">Inserts a row at the data source for all rows in the table with a <xref:System.Data.DataRow.RowState%2A> of <xref:System.Data.DataRowState.Added>.</span></span> <span data-ttu-id="1df6a-127">I valori vengono inseriti in tutte le colonne aggiornabili, quindi non nelle colonne di identità, espressioni o timestamp.</span><span class="sxs-lookup"><span data-stu-id="1df6a-127">Inserts values for all columns that are updateable (but not columns such as identities, expressions, or timestamps).</span></span>|  
|`UpdateCommand`|<span data-ttu-id="1df6a-128">Aggiorna le righe nell'origine dati per tutte le righe della tabella con `RowState` uguale a <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="1df6a-128">Updates rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="1df6a-129">I valori vengono aggiornati in tutte le colonne aggiornabili, quindi non nelle colonne di identità o di espressioni.</span><span class="sxs-lookup"><span data-stu-id="1df6a-129">Updates the values of all columns except for columns that are not updateable, such as identities or expressions.</span></span> <span data-ttu-id="1df6a-130">Vengono aggiornate tutte le righe in cui i valori delle colonne nell'origine dati corrispondono ai valori delle colonne della chiave primaria della riga e in cui le restanti colonne dell'origine dati corrispondono ai valori originali della riga.</span><span class="sxs-lookup"><span data-stu-id="1df6a-130">Updates all rows where the column values at the data source match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="1df6a-131">Per altre informazioni, vedere la sezione "Modello di concorrenza ottimistica per aggiornamenti ed eliminazioni" contenuta in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="1df6a-131">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
|`DeleteCommand`|<span data-ttu-id="1df6a-132">Elimina le righe nell'origine dati per tutte le righe della tabella con `RowState` uguale a <xref:System.Data.DataRowState.Deleted>.</span><span class="sxs-lookup"><span data-stu-id="1df6a-132">Deletes rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Deleted>.</span></span> <span data-ttu-id="1df6a-133">Vengono eliminate tutte le righe in cui i valori delle colonne corrispondono ai valori delle colonne della chiave primaria della riga e in cui le restanti colonne dell'origine dati corrispondono ai valori originali della riga.</span><span class="sxs-lookup"><span data-stu-id="1df6a-133">Deletes all rows where the column values match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="1df6a-134">Per altre informazioni, vedere la sezione "Modello di concorrenza ottimistica per aggiornamenti ed eliminazioni" contenuta in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="1df6a-134">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
  
## <a name="optimistic-concurrency-model-for-updates-and-deletes"></a><span data-ttu-id="1df6a-135">Modello di concorrenza ottimistica per aggiornamenti ed eliminazioni</span><span class="sxs-lookup"><span data-stu-id="1df6a-135">Optimistic Concurrency Model for Updates and Deletes</span></span>  
 <span data-ttu-id="1df6a-136">La logica per la generazione automatica dei comandi per le istruzioni UPDATE e DELETE si basa sulla *concorrenza ottimistica,* ovvero i record non sono bloccati per la modifica e possono essere modificati da altri utenti o processi in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="1df6a-136">The logic for generating commands automatically for UPDATE and DELETE statements is based on *optimistic concurrency*--that is, records are not locked for editing and can be modified by other users or processes at any time.</span></span> <span data-ttu-id="1df6a-137">Poiché un record può essere modificato dopo che è stato restituito dall'istruzione SELECT, ma prima che sia eseguita l'istruzione UPDATE o DELETE, nell'istruzione UPDATE o DELETE generata automaticamente è contenuta una clausola WHERE, tale che una riga viene aggiornata solo se contiene tutti i valori originali e non è stata eliminata dall'origine dati.</span><span class="sxs-lookup"><span data-stu-id="1df6a-137">Because a record could have been modified after it was returned from the SELECT statement, but before the UPDATE or DELETE statement is issued, the automatically generated UPDATE or DELETE statement contains a WHERE clause, specifying that a row is only updated if it contains all original values and has not been deleted from the data source.</span></span> <span data-ttu-id="1df6a-138">In questo modo si evita di sovrascrivere i nuovi dati.</span><span class="sxs-lookup"><span data-stu-id="1df6a-138">This is done to avoid overwriting new data.</span></span> <span data-ttu-id="1df6a-139">Nei casi in cui un comando Update generato automaticamente tenta di aggiornare una riga che è stata eliminata o che non contiene i valori originali rilevati in <xref:System.Data.DataSet>, il comando non ha alcun effetto sui record e viene generata un'eccezione <xref:System.Data.DBConcurrencyException>.</span><span class="sxs-lookup"><span data-stu-id="1df6a-139">Where an automatically generated update attempts to update a row that has been deleted or that does not contain the original values found in the <xref:System.Data.DataSet>, the command does not affect any records, and a <xref:System.Data.DBConcurrencyException> is thrown.</span></span>  
  
 <span data-ttu-id="1df6a-140">Se si desidera che le istruzioni UPDATE o DELETE vengano completate a prescindere dai valori originali, è necessario impostare in modo esplicito `UpdateCommand` per il `DataAdapter` e non usare la generazione automatica dei comandi.</span><span class="sxs-lookup"><span data-stu-id="1df6a-140">If you want the UPDATE or DELETE to complete regardless of original values, you must explicitly set the `UpdateCommand` for the `DataAdapter` and not rely on automatic command generation.</span></span>  
  
## <a name="limitations-of-automatic-command-generation-logic"></a><span data-ttu-id="1df6a-141">Limiti della logica per la generazione automatica dei comandi</span><span class="sxs-lookup"><span data-stu-id="1df6a-141">Limitations of Automatic Command Generation Logic</span></span>  
 <span data-ttu-id="1df6a-142">I limiti che seguono si riferiscono alla generazione automatica dei comandi.</span><span class="sxs-lookup"><span data-stu-id="1df6a-142">The following limitations apply to automatic command generation.</span></span>  
  
### <a name="unrelated-tables-only"></a><span data-ttu-id="1df6a-143">Solo tabelle non correlate</span><span class="sxs-lookup"><span data-stu-id="1df6a-143">Unrelated Tables Only</span></span>  
 <span data-ttu-id="1df6a-144">La logica per la generazione automatica dei comandi genera un'istruzione INSERT, UPDATE o DELETE per le tabelle autonome senza tenere conto delle relazioni con altre tabelle nell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="1df6a-144">The automatic command generation logic generates INSERT, UPDATE, or DELETE statements for stand-alone tables without taking into account any relationships to other tables at the data source.</span></span> <span data-ttu-id="1df6a-145">Di conseguenza, è possibile che venga rilevato un errore quando si chiama `Update` per inviare le modifiche a una colonna che fa parte di un vincolo di chiave esterna nel database.</span><span class="sxs-lookup"><span data-stu-id="1df6a-145">As a result, you may encounter a failure when calling `Update` to submit changes for a column that participates in a foreign key constraint in the database.</span></span> <span data-ttu-id="1df6a-146">Per evitare questa eccezione, non usare <xref:System.Data.Common.DbCommandBuilder> per aggiornare le colonne incluse in un vincolo di chiave esterna e specificare in modo esplicito le istruzioni usate per eseguire l'operazione.</span><span class="sxs-lookup"><span data-stu-id="1df6a-146">To avoid this exception, do not use the <xref:System.Data.Common.DbCommandBuilder> for updating columns involved in a foreign key constraint; instead, explicitly specify the statements used to perform the operation.</span></span>  
  
### <a name="table-and-column-names"></a><span data-ttu-id="1df6a-147">Nomi di tabelle e colonne</span><span class="sxs-lookup"><span data-stu-id="1df6a-147">Table and Column Names</span></span>  
 <span data-ttu-id="1df6a-148">La logica per la generazione automatica dei comandi potrebbe non essere eseguita correttamente se i nomi delle colonne o delle tabelle contengono caratteri speciali quali spazi, punti, virgolette o altri caratteri non alfanumerici, anche se racchiusi tra parentesi.</span><span class="sxs-lookup"><span data-stu-id="1df6a-148">Automatic command generation logic may fail if column names or table names contain any special characters, such as spaces, periods, quotation marks, or other nonalphanumeric characters, even if delimited by brackets.</span></span> <span data-ttu-id="1df6a-149">A seconda del provider, l'impostazione dei parametri QuoteSuffix e QuotePrefix può consentire alla logica di generazione di elaborare gli spazi, ma non i caratteri speciali di escape.</span><span class="sxs-lookup"><span data-stu-id="1df6a-149">Depending on the provider, setting the QuotePrefix and QuoteSuffix parameters may allow the generation logic to process spaces, but it cannot escape special characters.</span></span> <span data-ttu-id="1df6a-150">Sono supportati nomi di tabella completi sotto forma di *catalog.schema.table.*</span><span class="sxs-lookup"><span data-stu-id="1df6a-150">Fully qualified table names in the form of *catalog.schema.table* are supported.</span></span>  
  
## <a name="using-the-commandbuilder-to-automatically-generate-an-sql-statement"></a><span data-ttu-id="1df6a-151">Uso di CommandBuilder per generare automaticamente un'istruzione SQL</span><span class="sxs-lookup"><span data-stu-id="1df6a-151">Using the CommandBuilder to Automatically Generate an SQL Statement</span></span>  
 <span data-ttu-id="1df6a-152">Per generare automaticamente le istruzioni SQL per un oggetto `DataAdapter`, impostare innanzitutto la proprietà `SelectCommand` di `DataAdapter`. Creare quindi un oggetto `CommandBuilder` e specificare come argomento l'oggetto `DataAdapter` per il quale l'oggetto `CommandBuilder` genererà automaticamente le istruzioni SQL.</span><span class="sxs-lookup"><span data-stu-id="1df6a-152">To automatically generate SQL statements for a `DataAdapter`, first set the `SelectCommand` property of the `DataAdapter`, then create a `CommandBuilder` object, and specify as an argument the `DataAdapter` for which the `CommandBuilder` will automatically generate SQL statements.</span></span>  
  
```vb  
' Assumes that connection is a valid SqlConnection object
' inside of a Using block.  
Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  
  "SELECT * FROM dbo.Customers", connection)  
Dim builder As SqlCommandBuilder = New SqlCommandBuilder(adapter)  
builder.QuotePrefix = "["  
builder.QuoteSuffix = "]"  
```  
  
```csharp  
// Assumes that connection is a valid SqlConnection object  
// inside of a using block.  
SqlDataAdapter adapter = new SqlDataAdapter(  
  "SELECT * FROM dbo.Customers", connection);  
SqlCommandBuilder builder = new SqlCommandBuilder(adapter);  
builder.QuotePrefix = "[";  
builder.QuoteSuffix = "]";  
```  
  
## <a name="modifying-the-selectcommand"></a><span data-ttu-id="1df6a-153">Modifica di SelectCommand</span><span class="sxs-lookup"><span data-stu-id="1df6a-153">Modifying the SelectCommand</span></span>  
 <span data-ttu-id="1df6a-154">Se si modifica `CommandText` di `SelectCommand` dopo la generazione automatica di un comando INSERT, UPDATE o DELETE, è possibile che venga generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="1df6a-154">If you modify the `CommandText` of the `SelectCommand` after the INSERT, UPDATE, or DELETE commands have been automatically generated, an exception may occur.</span></span> <span data-ttu-id="1df6a-155">Se l'oggetto `SelectCommand.CommandText` modificato contiene informazioni sullo schema che non sono coerenti con l'oggetto `SelectCommand.CommandText` usato durante la generazione automatica del comando di inserimento, aggiornamento o eliminazione, nelle future chiamate al metodo `DataAdapter.Update` potrebbe essere eseguito un tentativo di accesso a colonne che non esistono più nella tabella corrente a cui `SelectCommand` fa riferimento e verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="1df6a-155">If the modified `SelectCommand.CommandText` contains schema information that is inconsistent with the `SelectCommand.CommandText` used when the insert, update, or delete commands were automatically generated, future calls to the `DataAdapter.Update` method may attempt to access columns that no longer exist in the current table referenced by the `SelectCommand`, and an exception will be thrown.</span></span>  
  
 <span data-ttu-id="1df6a-156">È possibile aggiornare le informazioni sullo schema usate da `CommandBuilder` per generare automaticamente i comandi chiamando il metodo `RefreshSchema` di `CommandBuilder`.</span><span class="sxs-lookup"><span data-stu-id="1df6a-156">You can refresh the schema information used by the `CommandBuilder` to automatically generate commands by calling the `RefreshSchema` method of the `CommandBuilder`.</span></span>  
  
 <span data-ttu-id="1df6a-157">Se si desidera conoscere il comando che è stato generato automaticamente, è possibile ottenere un riferimento ai comandi generati automaticamente tramite i metodi `GetInsertCommand`, `GetUpdateCommand` e `GetDeleteCommand` dell'oggetto `CommandBuilder` e selezionare la proprietà `CommandText`del comando associato.</span><span class="sxs-lookup"><span data-stu-id="1df6a-157">If you want to know what command was automatically generated, you can obtain a reference to the automatically generated commands by using the `GetInsertCommand`, `GetUpdateCommand`, and `GetDeleteCommand` methods of the `CommandBuilder` object and checking the `CommandText` property of the associated command.</span></span>  
  
 <span data-ttu-id="1df6a-158">Nell'esempio di codice seguente viene scritto sulla console il comando di aggiornamento che è stato generato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="1df6a-158">The following code example writes to the console the update command that was automatically generated.</span></span>  
  
```vb
Console.WriteLine(builder.GetUpdateCommand().CommandText)  
```

```csharp
Console.WriteLine(builder.GetUpdateCommand().CommandText);
```
  
 <span data-ttu-id="1df6a-159">Nell'esempio seguente viene ricreata la tabella `Customers` nel set di dati `custDS`.</span><span class="sxs-lookup"><span data-stu-id="1df6a-159">The following example recreates the `Customers` table in the `custDS` dataset.</span></span> <span data-ttu-id="1df6a-160">Il **RefreshSchema** metodo viene chiamato per aggiornare i comandi generati automaticamente con queste nuove informazioni di colonna.</span><span class="sxs-lookup"><span data-stu-id="1df6a-160">The **RefreshSchema** method is called to refresh the automatically generated commands with this new column information.</span></span>  
  
```vb  
' Assumes an open SqlConnection and SqlDataAdapter inside of a Using block.  
adapter.SelectCommand.CommandText = _  
  "SELECT CustomerID, ContactName FROM dbo.Customers"  
builder.RefreshSchema()  
  
custDS.Tables.Remove(custDS.Tables("Customers"))  
adapter.Fill(custDS, "Customers")  
```  
  
```csharp  
// Assumes an open SqlConnection and SqlDataAdapter inside of a using block.  
adapter.SelectCommand.CommandText =
  "SELECT CustomerID, ContactName FROM dbo.Customers";  
builder.RefreshSchema();  
  
custDS.Tables.Remove(custDS.Tables["Customers"]);  
adapter.Fill(custDS, "Customers");  
```  
  
## <a name="see-also"></a><span data-ttu-id="1df6a-161">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="1df6a-161">See also</span></span>

- [<span data-ttu-id="1df6a-162">Comandi e parametri</span><span class="sxs-lookup"><span data-stu-id="1df6a-162">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="1df6a-163">Esecuzione di un comandoExecuting a Command</span><span class="sxs-lookup"><span data-stu-id="1df6a-163">Executing a Command</span></span>](executing-a-command.md)
- [<span data-ttu-id="1df6a-164">DbConnection, DbCommand e DbException</span><span class="sxs-lookup"><span data-stu-id="1df6a-164">DbConnection, DbCommand and DbException</span></span>](dbconnection-dbcommand-and-dbexception.md)
- [<span data-ttu-id="1df6a-165">Panoramica di ADO.NET</span><span class="sxs-lookup"><span data-stu-id="1df6a-165">ADO.NET Overview</span></span>](ado-net-overview.md)
