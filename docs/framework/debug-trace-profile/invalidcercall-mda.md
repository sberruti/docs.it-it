---
title: MDA invalidCERCall
ms.date: 03/30/2017
helpviewer_keywords:
- invalid CER calls
- InvalidCERCall MDA
- MDAs (managed debugging assistants), CER calls
- constrained execution regions
- CER calls
- managed debugging assistants (MDAs), CER calls
ms.assetid: c4577410-602e-44e5-9dab-fea7c55bcdfe
ms.openlocfilehash: f8e467401f7c50898613c7cf6eca68a8a705431a
ms.sourcegitcommit: 9c54866bcbdc49dbb981dd55be9bbd0443837aa2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/14/2020
ms.locfileid: "77217388"
---
# <a name="invalidcercall-mda"></a><span data-ttu-id="c22b2-102">MDA invalidCERCall</span><span class="sxs-lookup"><span data-stu-id="c22b2-102">invalidCERCall MDA</span></span>
<span data-ttu-id="c22b2-103">L'assistente al debug gestito `invalidCERCall` viene attivato quando all'interno del grafico delle aree a esecuzione vincolata è presente una chiamata a un metodo che non include alcun contratto di affidabilità o che include un contratto eccessivamente debole.</span><span class="sxs-lookup"><span data-stu-id="c22b2-103">The `invalidCERCall` managed debugging assistant (MDA) is activated when there is a call within the constrained execution region (CER) graph to a method that has no reliability contract or an excessively weak contract.</span></span> <span data-ttu-id="c22b2-104">Un contratto debole è un contratto che dichiara che il peggior stato di danneggiamento ha un ambito più vasto rispetto all'istanza passata alla chiamata, ovvero lo stato di <xref:System.AppDomain> o del processo può risultare danneggiato o il risultato non è sempre calcolabile in modo deterministico quando la chiamata avviene all'interno di un'area a esecuzione vincolata.</span><span class="sxs-lookup"><span data-stu-id="c22b2-104">A weak contract is a contract that declares that the worst case state corruption is of greater scope than the instance passed to the call, that is, the <xref:System.AppDomain> or process state may become corrupted or that its result is not always deterministically computable when called within a CER.</span></span>  
  
## <a name="symptoms"></a><span data-ttu-id="c22b2-105">Sintomi</span><span class="sxs-lookup"><span data-stu-id="c22b2-105">Symptoms</span></span>  
 <span data-ttu-id="c22b2-106">Risultati imprevisti durante l'esecuzione di codice in un'area a esecuzione vincolata.</span><span class="sxs-lookup"><span data-stu-id="c22b2-106">Unexpected results when executing code in a CER.</span></span> <span data-ttu-id="c22b2-107">I sintomi non sono specifici.</span><span class="sxs-lookup"><span data-stu-id="c22b2-107">The symptoms are not specific.</span></span> <span data-ttu-id="c22b2-108">Potrebbero comprendere un'eccezione <xref:System.OutOfMemoryException> non prevista, un'eccezione <xref:System.Threading.ThreadAbortException> o altre eccezioni nella chiamata nel metodo non affidabile, che non è stato preparato in anticipo o protetto da eccezioni <xref:System.Threading.ThreadAbortException> in fase di esecuzione dal runtime.</span><span class="sxs-lookup"><span data-stu-id="c22b2-108">They could be an unexpected <xref:System.OutOfMemoryException>, a <xref:System.Threading.ThreadAbortException>, or other exceptions at the call into the unreliable method because the runtime did not prepare it ahead of time or protect it from <xref:System.Threading.ThreadAbortException> exceptions at run time.</span></span> <span data-ttu-id="c22b2-109">Una minaccia maggiore è costituita dal fatto che qualsiasi eccezione risultante dal metodo in fase di esecuzione può lasciare <xref:System.AppDomain> o il processo in uno stato instabile, che è un comportamento opposto agli obiettivi di un'area a esecuzione vincolata.</span><span class="sxs-lookup"><span data-stu-id="c22b2-109">A greater threat is that any exception resulting from the method at run time could leave the <xref:System.AppDomain> or process in an unstable state, which is contrary to the objective of a CER.</span></span> <span data-ttu-id="c22b2-110">Il motivo della creazione di un'area a esecuzione vincolata è evitare danneggiamenti dello stato come questo.</span><span class="sxs-lookup"><span data-stu-id="c22b2-110">The reason a CER is created is to avoid state corruptions such as this.</span></span> <span data-ttu-id="c22b2-111">I sintomi di uno stato danneggiato sono specifici dell'applicazione, perché la definizione di stato coerente varia a seconda dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c22b2-111">The symptoms of corrupt state are application specific because the definition of consistent state is different between applications.</span></span>  
  
## <a name="cause"></a><span data-ttu-id="c22b2-112">Causa</span><span class="sxs-lookup"><span data-stu-id="c22b2-112">Cause</span></span>  
 <span data-ttu-id="c22b2-113">Il codice all'interno di un'area a esecuzione vincolata chiama una funzione senza <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> o con un oggetto <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> debole, che non è compatibile con l'esecuzione in un'area a esecuzione vincolata.</span><span class="sxs-lookup"><span data-stu-id="c22b2-113">Code within a CER is calling a function with no <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> or with a weak <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> that is not compatible with running in a CER.</span></span>  
  
 <span data-ttu-id="c22b2-114">In termini di sintassi del contratto di affidabilità, un contratto debole è un contratto che non specifica un valore di enumerazione <xref:System.Runtime.ConstrainedExecution.Consistency> o che specifica il valore di <xref:System.Runtime.ConstrainedExecution.Consistency> come <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptProcess>, <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptAppDomain> o <xref:System.Runtime.ConstrainedExecution.Cer.None>.</span><span class="sxs-lookup"><span data-stu-id="c22b2-114">In terms of reliability contract syntax, a weak contract is a contract that does not specify a <xref:System.Runtime.ConstrainedExecution.Consistency> enumeration value or specifies a <xref:System.Runtime.ConstrainedExecution.Consistency> value of <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptProcess>, <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptAppDomain>, or <xref:System.Runtime.ConstrainedExecution.Cer.None>.</span></span> <span data-ttu-id="c22b2-115">Tutte queste condizioni indicano che il codice chiamato può impedire i tentativi di altro codice nell'area a esecuzione vincolata di mantenere uno stato coerente.</span><span class="sxs-lookup"><span data-stu-id="c22b2-115">Any of these conditions indicates that the code called may impede the efforts of the other code in the CER to maintain consistent state.</span></span>  <span data-ttu-id="c22b2-116">Le aree a esecuzione vincolata permettono al codice di gestire gli errori in modo molto deterministico, mantenendo le invarianti interne importanti per l'applicazione e consentendo l'esecuzione continua del codice anche in caso di errori temporanei come le eccezioni di memoria insufficiente.</span><span class="sxs-lookup"><span data-stu-id="c22b2-116">CERs allow code to treat errors in a very deterministic manner, maintaining internal invariants that are important to the application and allowing it to continue running in the face of transient errors such as out-of-memory exceptions.</span></span>  
  
 <span data-ttu-id="c22b2-117">L'attivazione di questo assistente al debug gestito indica la possibilità che il metodo chiamato nell'area a esecuzione vincolata possa non riuscire con un comportamento imprevisto per il chiamante o in modo da lasciare lo stato di <xref:System.AppDomain> o del processo danneggiato o non ripristinabile.</span><span class="sxs-lookup"><span data-stu-id="c22b2-117">The activation of this MDA indicates a possibility the method being called in the CER can fail in a way that the caller did not expect or that leaves the <xref:System.AppDomain> or process state corrupted or unrecoverable.</span></span> <span data-ttu-id="c22b2-118">Naturalmente, è possibile che il codice chiamato venga eseguito correttamente e che il problema sia semplicemente un contratto mancante.</span><span class="sxs-lookup"><span data-stu-id="c22b2-118">Of course, the called code might execute correctly and the problem is simply a missing contract.</span></span> <span data-ttu-id="c22b2-119">Tuttavia, i problemi correlati alla scrittura di codice affidabile sono impercettibili e l'assenza di un contratto è un buon indicatore del rischio che il codice non venga eseguito correttamente.</span><span class="sxs-lookup"><span data-stu-id="c22b2-119">However, the issues involved in writing reliable code are subtle and the absence of a contract is a good indicator the code might not execute correctly.</span></span> <span data-ttu-id="c22b2-120">I contratti sono indicatori del fatto che il programmatore ha creato il codice in modo affidabile e lasciano presupporre che queste garanzie resteranno immutate nelle versioni successive del codice.</span><span class="sxs-lookup"><span data-stu-id="c22b2-120">The contracts are indicators that the programmer has coded reliably and also promises that these guarantees will not change in future revisions of the code.</span></span>  <span data-ttu-id="c22b2-121">Questo significa che i contratti sono dichiarazioni di intenti e non solo dettagli di implementazione.</span><span class="sxs-lookup"><span data-stu-id="c22b2-121">That is, the contracts are declarations of intent and not just implementation details.</span></span>  
  
 <span data-ttu-id="c22b2-122">Poiché qualsiasi metodo con un contratto debole o inesistente può non riuscire in molti modi imprevisti, il runtime non tenta di rimuovere alcuno degli errori imprevisti dal metodo, introdotti, ad esempio, da una compilazione JIT inefficace, dal popolamento di dizionari di generics o da interruzioni dei thread.</span><span class="sxs-lookup"><span data-stu-id="c22b2-122">Because any method with a weak or nonexistent contract can potentially fail in many unpredictable ways, the runtime does not attempt to remove any of its own unpredictable failures from the method  that are introduced by lazy JIT-compiling, generics dictionary population, or thread aborts, for example.</span></span> <span data-ttu-id="c22b2-123">Di conseguenza, quando questo assistente al debug gestito viene attivato, indica che il runtime non ha incluso il metodo chiamato nell'area a esecuzione vincolata definita. Il grafico chiamate è stato terminato in questo nodo perché se si continua a preparare il sottoalbero, si rischia di contribuire a nascondere il possibile errore.</span><span class="sxs-lookup"><span data-stu-id="c22b2-123">That is, when this MDA is activated, it indicates that the runtime did not include the called method in the CER being defined; the call graph was terminated at this node because continuing to prepare this subtree would help mask the potential error.</span></span>  
  
## <a name="resolution"></a><span data-ttu-id="c22b2-124">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="c22b2-124">Resolution</span></span>  
 <span data-ttu-id="c22b2-125">Aggiungere un contratto di affidabilità valido alla funzione o evitare di usare questa chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="c22b2-125">Add a valid reliability contract to the function or avoid using that function call.</span></span>  
  
## <a name="effect-on-the-runtime"></a><span data-ttu-id="c22b2-126">Effetto sull'ambiente di esecuzione</span><span class="sxs-lookup"><span data-stu-id="c22b2-126">Effect on the Runtime</span></span>  
 <span data-ttu-id="c22b2-127">L'effetto della chiamata di un contratto debole da un'area a esecuzione vincolata può essere l'incapacità dell'area a esecuzione vincolata di completare le proprie operazioni.</span><span class="sxs-lookup"><span data-stu-id="c22b2-127">The effect of calling a weak contract from a CER could be the CER failure to complete its operations.</span></span> <span data-ttu-id="c22b2-128">Questo problema può provocare il danneggiamento dello stato del processo e di <xref:System.AppDomain>.</span><span class="sxs-lookup"><span data-stu-id="c22b2-128">This could lead to corruption of the <xref:System.AppDomain> process state.</span></span>  
  
## <a name="output"></a><span data-ttu-id="c22b2-129">Output</span><span class="sxs-lookup"><span data-stu-id="c22b2-129">Output</span></span>  
 <span data-ttu-id="c22b2-130">Di seguito è riportato un esempio di output generato dall'assistente al debug gestito.</span><span class="sxs-lookup"><span data-stu-id="c22b2-130">The following is sample output from this MDA.</span></span>  
  
 `Method 'MethodWithCer', while executing within a constrained execution region, makes a call at IL offset 0x000C to 'MethodWithWeakContract', which does not have a sufficiently strong reliability contract and might cause non-deterministic results.`  
  
## <a name="configuration"></a><span data-ttu-id="c22b2-131">Configurazione</span><span class="sxs-lookup"><span data-stu-id="c22b2-131">Configuration</span></span>  
  
```xml  
<mdaConfig>  
  <assistants>  
    <invalidCERCall />  
  </assistants>  
</mdaConfig>  
```  
  
## <a name="see-also"></a><span data-ttu-id="c22b2-132">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="c22b2-132">See also</span></span>

- <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareMethod%2A>
- <xref:System.Runtime.ConstrainedExecution>
- [<span data-ttu-id="c22b2-133">Diagnostica degli errori tramite gli assistenti al debug gestito</span><span class="sxs-lookup"><span data-stu-id="c22b2-133">Diagnosing Errors with Managed Debugging Assistants</span></span>](diagnosing-errors-with-managed-debugging-assistants.md)
