---
title: Ottimizzare le prestazioni 3D
ms.date: 03/30/2017
helpviewer_keywords:
- 3-D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 414a4677a1e05cd69c382e35194328d6ce1bddf9
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/24/2020
ms.locfileid: "76744600"
---
# <a name="maximize-wpf-3d-performance"></a>Ottimizzazione delle prestazioni tridimensionali di WPF
Quando si usa il [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] per creare controlli 3D e includere scene 3D nelle applicazioni, è importante prendere in considerazione l'ottimizzazione delle prestazioni. In questo argomento viene fornito un elenco di classi e proprietà 3D con implicazioni sulle prestazioni per l'applicazione, oltre a consigli per l'ottimizzazione delle prestazioni quando vengono utilizzate.  
  
 Questo argomento presuppone una conoscenza avanzata delle funzionalità di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 3D. I suggerimenti di questo documento si applicano al livello di rendering 2, approssimativamente definito come hardware che supporta pixel shader versione 2,0 e vertex shader versione 2,0. Per altri dettagli, vedere [livelli di rendering della grafica](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Effetti sulle prestazioni: alto  
  
|Gli|Indicazione|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Velocità del pennello (più veloce a più lenta):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (memorizzato nella cache)<br /><br /> <xref:System.Windows.Media.VisualBrush> (memorizzato nella cache)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (non memorizzato nella cache)<br /><br /> <xref:System.Windows.Media.VisualBrush> (non memorizzato nella cache)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Impostare `Viewport3D.ClipToBounds` su false ogni volta che non è necessario avere [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] ritagliare in modo esplicito il contenuto di una <xref:System.Windows.Controls.Viewport3D> al rettangolo Viewport3d. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] il ritaglio con anti-aliasing può essere molto lento e `ClipToBounds` è abilitato (lento) per impostazione predefinita in <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Impostare `Viewport3D.IsHitTestVisible` su false ogni volta che non è necessario [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] considerare il contenuto di una <xref:System.Windows.Controls.Viewport3D> quando si esegue l'hit test del mouse.  Il contenuto 3D di hit testing viene eseguito nel software e può essere lento con mesh di grandi dimensioni. per impostazione predefinita, <xref:System.Windows.UIElement.IsHitTestVisible%2A> è abilitato (lento) per <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Creare modelli diversi solo quando richiedono materiali o trasformazioni differenti.  In caso contrario, provare a unire molte istanze di <xref:System.Windows.Media.Media3D.GeometryModel3D> con gli stessi materiali e le stesse trasformazioni in alcune istanze di <xref:System.Windows.Media.Media3D.GeometryModel3D> e <xref:System.Windows.Media.Media3D.MeshGeometry3D> più grandi.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Animazione mesh: la modifica dei singoli vertici di una mesh in base ai singoli fotogrammi non è sempre efficiente in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].  Per ridurre al minimo l'impatto sulle prestazioni delle notifiche di modifica quando ogni vertice viene modificato, scollegare la mesh dalla struttura ad albero visuale prima di eseguire la modifica per ogni vertice.  Una volta modificata, la mesh viene ricollegata alla struttura ad albero visuale.  Inoltre, provare a ridurre al minimo le dimensioni dei mesh che verranno animate in questo modo.|  
|anti-aliasing 3D|Per aumentare la velocità di rendering, disabilitare il campionamento multiplo su un <xref:System.Windows.Controls.Viewport3D> impostando la proprietà associata <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> su `Aliased`.  Per impostazione predefinita, l'anti-aliasing 3D è abilitato in Windows con 4 campioni per pixel.|  
|Testo|Il testo in tempo reale in una scena 3D (Live perché si trova in un <xref:System.Windows.Media.DrawingBrush> o <xref:System.Windows.Media.VisualBrush>) può essere lento. Provare a usare invece le immagini del testo (tramite <xref:System.Windows.Media.Imaging.RenderTargetBitmap>), a meno che il testo non venga modificato.|  
|<xref:System.Windows.Media.TileBrush>|Se è necessario usare un <xref:System.Windows.Media.VisualBrush> o un <xref:System.Windows.Media.DrawingBrush> in una scena 3D perché il contenuto del pennello non è statico, provare a memorizzare nella cache il pennello, impostando la proprietà associata <xref:System.Windows.Media.RenderOptions.CachingHint%2A> su `Cache`.  Impostare le soglie di invalidamento di scala minime e massime (con le proprietà associate <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> e <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>) in modo che i pennelli memorizzati nella cache non vengano rigenerati troppo frequentemente, mantenendo al tempo stesso il livello di qualità desiderato.  Per impostazione predefinita, <xref:System.Windows.Media.DrawingBrush> e <xref:System.Windows.Media.VisualBrush> non vengono memorizzati nella cache, vale a dire che ogni volta che viene eseguito il rendering di un elemento disegnato con il pennello, è necessario eseguire di nuovo il rendering dell'intero contenuto del pennello in una superficie intermedia.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect> forza il rendering di tutti i contenuti interessati senza accelerazione hardware.  Per prestazioni ottimali, non utilizzare <xref:System.Windows.Media.Effects.BitmapEffect>.|  
  
## <a name="performance-impact-medium"></a>Effetto sulle prestazioni: medio  
  
|Gli|Indicazione|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Quando una mesh viene definita come triangoli adiacenti con vertici condivisi e i vertici hanno le stesse coordinate di posizione, normale e trama, definiscono ogni vertice condiviso una sola volta e quindi definiscono i triangoli in base all'indice con <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>.|  
|<xref:System.Windows.Media.ImageBrush>|Provare a ridurre al minimo le dimensioni della trama quando si dispone di un controllo esplicito sulle dimensioni (quando si usa un <xref:System.Windows.Media.Imaging.RenderTargetBitmap> e/o un <xref:System.Windows.Media.ImageBrush>).  Si noti che le trame con risoluzione inferiore possono ridurre la qualità visiva, quindi provare a trovare il giusto equilibrio tra qualità e prestazioni.|  
|Opacità|Quando si esegue il rendering di contenuto 3D traslucido (ad esempio riflessioni), usare le proprietà di opacità sui pennelli o i materiali (tramite <xref:System.Windows.Media.Brush.Opacity%2A> o <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>) invece di creare un <xref:System.Windows.Controls.Viewport3D> separato trasparente impostando `Viewport3D.Opacity` su un valore minore di 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Ridurre al minimo il numero di oggetti <xref:System.Windows.Controls.Viewport3D> in uso in una scena.  Inserire molti modelli 3D nello stesso oggetto Viewport3D anziché creare istanze Viewport3D separate per ogni modello.|  
|<xref:System.Windows.Freezable>|In genere è vantaggioso riutilizzare <xref:System.Windows.Media.Media3D.MeshGeometry3D>, <xref:System.Windows.Media.Media3D.GeometryModel3D>, pennelli e materiali.  Tutti sono con più elementi padre, dal momento che sono derivati da `Freezable`.|  
|<xref:System.Windows.Freezable>|Chiamare il metodo <xref:System.Windows.Freezable.Freeze%2A> sugli Freezable quando le relative proprietà rimarranno invariate nell'applicazione.  Il blocco può ridurre working set e aumentare la velocità.|  
|<xref:System.Windows.Media.Brush>|Utilizzare <xref:System.Windows.Media.ImageBrush> anziché <xref:System.Windows.Media.VisualBrush> o <xref:System.Windows.Media.DrawingBrush> quando il contenuto del pennello non viene modificato.  il contenuto 2D può essere convertito in un <xref:System.Windows.Controls.Image> tramite <xref:System.Windows.Media.Imaging.RenderTargetBitmap> e quindi usato in un <xref:System.Windows.Media.ImageBrush>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Non usare <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> a meno che non si debbano effettivamente visualizzare i visi indietro della <xref:System.Windows.Media.Media3D.GeometryModel3D>.|  
|<xref:System.Windows.Media.Media3D.Light>|Velocità chiara (veloce a più lenta):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Provare a ridurre le dimensioni dei mesh con i limiti seguenti:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20.001 istanze <xref:System.Windows.Media.Media3D.Point3D><br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60.003 istanze <xref:System.Int32>|  
|<xref:System.Windows.Media.Media3D.Material>|Velocità del materiale (più veloce a più lenta):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 3D non rifiuta esplicitamente i pennelli invisibili (pennelli di ambiente neri, Cancella pennelli e così via) in modo coerente.  Si consiglia di ometterli dalla scena.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Ogni <xref:System.Windows.Media.Media3D.Material> in un <xref:System.Windows.Media.Media3D.MaterialGroup> causa un altro passaggio di rendering, quindi includere molti materiali, anche materiali semplici, può aumentare significativamente le richieste di riempimento sulla GPU.  Ridurre al minimo il numero di materiali presenti nel <xref:System.Windows.Media.Media3D.MaterialGroup>.|  
  
## <a name="performance-impact-low"></a>Effetto sulle prestazioni: basso  
  
|Gli|Indicazione|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Quando non è necessaria un'animazione o una data binding, anziché usare un gruppo di trasformazione contenente più trasformazioni, usare una singola <xref:System.Windows.Media.Media3D.MatrixTransform3D>, impostando il prodotto come prodotto di tutte le trasformazioni che altrimenti sarebbero disponibili indipendentemente nel gruppo di trasformazione.|  
|<xref:System.Windows.Media.Media3D.Light>|Ridurre al minimo il numero di luci nella scena. Troppe luci in una scena forzano [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] a eseguire il fallback al rendering del software.  I limiti sono approssimativamente 110 <xref:System.Windows.Media.Media3D.DirectionalLight> oggetti, 70 <xref:System.Windows.Media.Media3D.PointLight> oggetti o 40 <xref:System.Windows.Media.Media3D.SpotLight> oggetti.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Separare gli oggetti mobili dagli oggetti statici inserendoli in istanze di <xref:System.Windows.Media.Media3D.ModelVisual3D> separate.  ModelVisual3D è "più pesante" di <xref:System.Windows.Media.Media3D.GeometryModel3D> perché memorizza nella cache i limiti trasformati.  GeometryModel3D è ottimizzato per essere un modello; ModelVisual3D è ottimizzato per essere un nodo di scena.  Usare ModelVisual3D per inserire le istanze condivise di GeometryModel3D nella scena.|  
|<xref:System.Windows.Media.Media3D.Light>|Ridurre al minimo il numero di volte in cui si modifica il numero di luci nella scena.  Ogni modifica del numero di luce impone una rigenerazione dello shader e la ricompilazione a meno che la configurazione non sia già stata eseguita in precedenza (e di conseguenza lo shader è stato memorizzato nella cache).|  
|Chiaro|Le luci nere non saranno visibili, ma verranno aggiunte al tempo di rendering; si consiglia di ometterli.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Per ridurre al minimo il tempo di costruzione delle raccolte di grandi dimensioni in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], ad esempio un <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>MeshGeometry3D's, <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>e <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>, pre-dimensionare le raccolte prima del popolamento del valore. Se possibile, passare le strutture di dati precompilate dei costruttori delle raccolte, ad esempio matrici o elenchi.|  
  
## <a name="see-also"></a>Vedere anche

- [Panoramica sulla grafica tridimensionale](3-d-graphics-overview.md)
