---
title: Metadati delle proprietà di dipendenza
ms.date: 03/30/2017
helpviewer_keywords:
- APIs [WPF], metadata
- dependency properties [WPF], metadata
- metadata [WPF], for dependency properties
- overriding metadata [WPF]
ms.assetid: d01ed009-b722-41bf-b82f-fe1a8cdc50dd
ms.openlocfilehash: 3d84510fce69e81929cbe9b6088e12aaf3409769
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186373"
---
# <a name="dependency-property-metadata"></a>Metadati delle proprietà di dipendenza
Il [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] sistema di proprietà include un sistema di report di metadati che va oltre ciò che può essere segnalato su una proprietà tramite la reflection o le caratteristiche generali di Common Language Runtime (CLR). I metadati di una proprietà di dipendenza possono anche essere assegnati in modo univoco dalla classe che definisce una proprietà di dipendenza, possono essere modificati quando la proprietà di dipendenza viene aggiunta a una classe diversa ed è possibile eseguirne specificatamente l'override tramite tutte le classi derivate che ereditano la proprietà di dipendenza dalla classe di base in fase di definizione.  

<a name="prerequisites"></a>
## <a name="prerequisites"></a>Prerequisites  
 Questo argomento presuppone la conoscenza delle proprietà di dipendenza dal punto di vista di un consumer delle proprietà di dipendenza esistenti nelle classi di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], nonché la lettura dell'argomento [Panoramica sulle proprietà di dipendenza](dependency-properties-overview.md). Per seguire gli esempi illustrati in questo argomento, è anche necessario conoscere [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] e saper scrivere applicazioni [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
<a name="dp_metadata_contents"></a>
## <a name="how-dependency-property-metadata-is-used"></a>Come usare i metadati delle proprietà di dipendenza  
 I metadati della proprietà di dipendenza sono un oggetto sul quale è possibile eseguire query per esaminare le caratteristiche di una proprietà di dipendenza. Anche il sistema di proprietà accede frequentemente ai metadati durante l'elaborazione di qualsiasi proprietà di dipendenza. L'oggetto metadati di una proprietà di dipendenza può contenere i seguenti tipi di informazioni:  
  
- Valore predefinito per la proprietà di dipendenza, se non è possibile determinare altri valori per la proprietà di dipendenza in base al valore locale, allo stile, all'ereditarietà e così via. Per una descrizione approfondita del modo in cui i valori predefiniti partecipano alla precedenza utilizzata dal sistema di proprietà durante l'assegnazione dei valori per le proprietà di dipendenza, vedere [Precedenza](dependency-property-value-precedence.md)dei valori delle proprietà di dipendenza .  
  
- I riferimenti a implementazioni di callback che influiscono sui comportamenti di coercizione o di notifica di modifica in base al tipo di proprietario. Notare che questi callback vengono spesso definiti con un livello di accesso non pubblico, pertanto in genere non è possibile ottenere i riferimenti effettivi dai metadati, a meno che i riferimenti non rientrino nell'ambito di accesso consentito. Per altre informazioni sui callback per le proprietà di dipendenza, vedere [Callback e convalida delle proprietà di dipendenza](dependency-property-callbacks-and-validation.md).  
  
- Se la proprietà di dipendenza in questione viene considerata come una proprietà a livello di framework WPF, i metadati potrebbero contenere caratteristiche della proprietà di dipendenza a livello di framework WPF, che segnalano informazioni e stato per servizi come la logica di ereditarietà delle proprietà e il motore di layout a livello di framework WPF. Per altre informazioni su questo aspetto dei metadati delle proprietà di dipendenza, vedere [Metadati delle proprietà del framework](framework-property-metadata.md).  
  
<a name="APIs"></a>
## <a name="metadata-apis"></a>API dei metadati  
 Il tipo che segnala la maggior parte delle <xref:System.Windows.PropertyMetadata> informazioni sui metadati utilizzate dal sistema di proprietà è la classe . Le istanze dei metadati possono essere specificate facoltativamente quando le proprietà di dipendenza vengono registrate nel sistema di proprietà e una seconda volta per i tipi che si aggiungono come proprietari o che eseguono l'override dei metadati ereditati dalla definizione della proprietà di dipendenza della classe di base. Per i casi in cui la registrazione <xref:System.Windows.PropertyMetadata> di una proprietà non specifica i metadati, viene creato un valore predefinito con i valori predefiniti per tale classe. I metadati registrati <xref:System.Windows.PropertyMetadata> vengono restituiti <xref:System.Windows.DependencyProperty.GetMetadata%2A> come quando si chiamano i vari <xref:System.Windows.DependencyObject> overload che ottengono metadati da una proprietà di dipendenza in un'istanza.  
  
 La <xref:System.Windows.PropertyMetadata> classe viene quindi derivata da per fornire metadati più specifici per le divisioni dell'architettura, ad esempio le classi a livello di framework WPFWPF. <xref:System.Windows.UIPropertyMetadata>aggiunge report di <xref:System.Windows.FrameworkPropertyMetadata> animazione e fornisce le proprietà a livello di framework WPF menzionate nella sezione precedente. Quando le proprietà di dipendenza vengono registrate, possono essere registrate con queste <xref:System.Windows.PropertyMetadata> classi derivate. Quando i metadati vengono <xref:System.Windows.PropertyMetadata> esaminati, è possibile eseguire il cast del tipo di base alle classi derivate in modo da poter esaminare le proprietà più specifiche.  
  
> [!NOTE]
> Le caratteristiche della proprietà <xref:System.Windows.FrameworkPropertyMetadata> che possono essere specificate in sono talvolta indicate in questa documentazione come "flags". Quando si creano nuove istanze di metadati da utilizzare nelle registrazioni delle proprietà <xref:System.Windows.FrameworkPropertyMetadataOptions> di dipendenza o negli override dei metadati, si specificano questi valori utilizzando l'enumerazione flagwise e quindi si forniscono valori possibilmente concatenati dell'enumerazione al <xref:System.Windows.FrameworkPropertyMetadata> costruttore. Tuttavia, una volta costruite, <xref:System.Windows.FrameworkPropertyMetadata> queste caratteristiche dell'opzione vengono esposte all'interno di una serie di proprietà booleane anziché come valore di enumerazione di costruzione. Le proprietà booleane consentono di verificare ogni istruzione condizionale anziché richiedere l'applicazione di una maschera a un valore di enumerazione basato su flag per ottenere le informazioni necessarie. Il costruttore utilizza <xref:System.Windows.FrameworkPropertyMetadataOptions> concatenato per mantenere ragionevole la lunghezza della firma del costruttore, mentre i metadati costruiti effettivi espone le proprietà discrete per rendere più intuitiva l'esecuzione di query sui metadati.  
  
<a name="override_or_subclass"></a>
## <a name="when-to-override-metadata-when-to-derive-a-class"></a>Esecuzione dell'override dei metadati e derivazione di una classe  
 Il sistema di proprietà di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] include funzionalità consolidate che consentono di modificare alcune caratteristiche delle proprietà di dipendenza senza richiederne una implementazione nuova e completa. Questo risultato si ottiene creando un'istanza diversa dei metadati della proprietà per la proprietà di dipendenza presente in un tipo particolare. Notare che le proprietà di dipendenza non sono per la maggior parte proprietà virtuali, pertanto, a rigor di termini, "una nuova implementazione" di queste proprietà nelle classi ereditate potrebbe essere realizzata solo nascondendo il membro esistente.  
  
 Se lo scenario che si tenta di abilitare per una proprietà di dipendenza in un tipo non può essere realizzato modificando le caratteristiche delle proprietà di dipendenza esistenti, potrebbe essere necessario creare una classe derivata e successivamente dichiarare una proprietà di dipendenza personalizzata nella classe derivata. Una proprietà di dipendenza personalizzata si comporta in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] modo identico alle proprietà di dipendenza definite dalle API. Per altri dettagli sulle proprietà di dipendenza personalizzate, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md).  
  
 Una caratteristica rilevante di una proprietà di dipendenza di cui non è possibile eseguire l'override è il tipo di valore. Se si eredita una proprietà di dipendenza che si comporta nel modo richiesto, ma è richiesto un tipo diverso per questa proprietà, sarà necessario implementare una proprietà di dipendenza personalizzata e forse collegare le proprietà tramite la conversione dei tipi oppure un'altra implementazione nella classe personalizzata. Inoltre, non è <xref:System.Windows.ValidateValueCallback>possibile sostituire un oggetto , poiché questo callback esiste nel campo di registrazione stesso e non all'interno dei relativi metadati.  
  
<a name="scenarios"></a>
## <a name="scenarios-for-changing-existing-metadata"></a>Scenari per la modifica dei metadati esistenti  
 Se si usano i metadati di una proprietà di dipendenza esistente, uno scenario comune per modificare i metadati della proprietà di dipendenza consiste nella modifica del valore predefinito. La modifica o l'aggiunta di callback del sistema di proprietà rappresenta uno scenario più avanzato. Questa operazione può essere necessaria quando l'implementazione di una classe derivata ha molte interrelazioni tra le proprietà di dipendenza. Una delle condizioni per poter disporre di un modello di programmazione che supporti l'utilizzo del codice e l'utilizzo dichiarativo consiste nella possibilità di impostare le proprietà in qualsiasi ordine. Le proprietà dipendenti devono quindi essere impostate JIT senza contesto e senza la possibilità di basarsi sulla conoscenza di un ordine di impostazione, come potrebbe accadere in un costruttore. Per altre informazioni su questo aspetto del sistema di proprietà, vedere [Callback e convalida delle proprietà di dipendenza](dependency-property-callbacks-and-validation.md). Notare che i callback di convalida non fanno parte dei metadati, ma dell'identificatore della proprietà di dipendenza. I callback di convalida non possono quindi essere modificati mediante l'override dei metadati.  
  
 In alcuni casi, è possibile che si decida di modificare le opzioni dei metadati delle proprietà a livello di framework WPF nelle proprietà di dipendenza esistenti. Queste opzioni consentono di comunicare alcune condizioni note relative alle proprietà a livello di framework WPF ad altri processi a livello di framework WPF, ad esempio il sistema di layout.  L'impostazione delle opzioni viene in genere eseguita solo quando si registra una nuova proprietà di <xref:System.Windows.DependencyProperty.OverrideMetadata%2A> dipendenza, ma è anche possibile modificare i metadati della proprietà a livello di framework WPF come parte di una chiamata o <xref:System.Windows.DependencyProperty.AddOwner%2A> . Per conoscere i valori specifici da usare e per altre informazioni, vedere [Metadati delle proprietà del framework](framework-property-metadata.md). Per altre informazioni relative alla modalità di impostazione di queste opzioni per una proprietà di dipendenza appena registrata, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md).  
  
<a name="dp_override_metadata"></a>
### <a name="overriding-metadata"></a>Override dei metadati  
 Lo scopo dell'override dei metadati è principalmente la possibilità di modificare i diversi comportamenti derivati dai metadati applicati alla proprietà di dipendenza esistente per il tipo. Le ragioni di questa operazione vengono spiegate più dettagliatamente nella sezione [Metadati](#dp_metadata_contents). Per altre informazioni e alcuni esempi di codice, vedere [Eseguire l'override dei metadati per una proprietà di dipendenza](how-to-override-metadata-for-a-dependency-property.md).  
  
 I metadati della proprietà possono essere forniti per<xref:System.Windows.DependencyProperty.Register%2A>una proprietà di dipendenza durante la chiamata di registrazione ( ). Tuttavia, in molti casi è possibile fornire metadati specifici del tipo per la classe, quando questa eredita tale proprietà di dipendenza. A tale scopo, <xref:System.Windows.DependencyProperty.OverrideMetadata%2A> è possibile chiamare il metodo .  Per un esempio [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dalle API, <xref:System.Windows.FrameworkElement> la classe è il <xref:System.Windows.UIElement.Focusable%2A> tipo che registra innanzitutto la proprietà di dipendenza. Tuttavia, <xref:System.Windows.Controls.Control> la classe esegue l'override dei metadati per la `false` `true`proprietà di dipendenza per <xref:System.Windows.UIElement.Focusable%2A> fornire il proprio valore predefinito iniziale, modificandolo da a , e in caso contrario riutilizza l'implementazione originale.  
  
 Quando si esegue l'override dei metadati, le diverse caratteristiche dei metadati vengono unite oppure sostituite.  
  
- <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A>viene unita. Se si aggiunge <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A>un nuovo callback, tale callback viene archiviato nei metadati. Se non si <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> specifica un nella sostituzione, il valore di viene <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> promosso come riferimento dal predecessore più vicino che lo ha specificato nei metadati.  
  
- Il comportamento effettivo <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> del sistema di proprietà per è che le implementazioni per tutti i proprietari di metadati nella gerarchia vengono mantenute e aggiunte a una tabella, con l'ordine di esecuzione dal sistema di proprietà è che i callback della classe più derivata vengono richiamati per primi.  
  
- <xref:System.Windows.PropertyMetadata.DefaultValue%2A>viene sostituito. Se non si <xref:System.Windows.PropertyMetadata.DefaultValue%2A> specifica un nella sostituzione, il valore di <xref:System.Windows.PropertyMetadata.DefaultValue%2A> proviene dal predecessore più vicino che lo ha specificato nei metadati.  
  
- <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A>le implementazioni vengono sostituite. Se si aggiunge <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A>un nuovo callback, tale callback viene archiviato nei metadati. Se non si <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> specifica un nella sostituzione, il valore di viene <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> promosso come riferimento dal predecessore più vicino che lo ha specificato nei metadati.  
  
- Il comportamento del sistema <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> di proprietà è che viene richiamato solo il nei metadati immediati. Non vengono <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> mantenuti riferimenti ad altre implementazioni nella gerarchia.  
  
 Questo comportamento viene <xref:System.Windows.PropertyMetadata.Merge%2A>implementato da e può essere sottoposto a override nelle classi di metadati derivate.  
  
#### <a name="overriding-attached-property-metadata"></a>Override dei metadati delle proprietà associate  
 In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], le proprietà associate vengono implementate come proprietà di dipendenza. In altri termini, dispongono anche di metadati della proprietà di cui le singole classi possono eseguire l'override. Le considerazioni sull'ambito per [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] una proprietà <xref:System.Windows.DependencyObject> associata in sono in genere che qualsiasi può avere una proprietà associata impostata su di essi. Pertanto, <xref:System.Windows.DependencyObject> qualsiasi classe derivata può eseguire l'override dei metadati per qualsiasi proprietà associata, come potrebbe essere impostata su un'istanza della classe. È possibile eseguire l'override dei valori predefiniti, dei callback o delle proprietà di segnalazione delle caratteristiche a livello di framework WPF. Se la proprietà associata viene impostata su un'istanza della classe, vengono applicate le caratteristiche dei metadati della proprietà di override. È possibile, ad esempio, eseguire l'override del valore predefinito, in modo che il valore di override venga segnalato come valore della proprietà associata nelle istanze della classe, tutte le volte che la proprietà non viene impostata diversamente.  
  
> [!NOTE]
> La <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> proprietà non è rilevante per le proprietà associate.  
  
<a name="dp_add_owner"></a>
### <a name="adding-a-class-as-an-owner-of-an-existing-dependency-property"></a>Aggiunta di un classe come proprietario di una proprietà di dipendenza esistente  
 Una classe può aggiungere se stessa come proprietario di una proprietà <xref:System.Windows.DependencyProperty.AddOwner%2A> di dipendenza che è già stata registrata, utilizzando il metodo . In questo modo, la classe può usare una proprietà di dipendenza registrata originariamente per un tipo diverso. In genere, la classe aggiunta non è una classe derivata del tipo che ha registrato per primo quella proprietà di dipendenza come proprietario. In realtà, in questo modo la classe e le relative classi derivate possono "ereditare" un'implementazione della proprietà di dipendenza senza che la classe proprietario originale e quella aggiunta si trovino nella stessa gerarchia di classi. Inoltre, la classe aggiunta (e tutte le classi derivate) possono quindi fornire metadati specifici sul tipo per la proprietà di dipendenza originale.  
  
 Oltre ad aggiungersi come proprietario tramite i metodi di utilità del sistema di proprietà, la classe aggiunta deve dichiarare ulteriori membri pubblici al proprio interno al fine di far partecipare completamente la proprietà di dipendenza nel sistema di proprietà con l'esposizione al codice e al markup. Una classe che aggiunge una proprietà di dipendenza esistente ha le stesse responsabilità, per quanto riguarda l'esposizione del modello a oggetti per quella proprietà di dipendenza, di una classe che definisce una nuova proprietà di dipendenza personalizzata. Il primo di questi membri da esporre è un campo dell'identificatore della proprietà di dipendenza. Questo campo deve `public static readonly` essere <xref:System.Windows.DependencyProperty>un campo di tipo , <xref:System.Windows.DependencyProperty.AddOwner%2A> assegnato al valore restituito della chiamata. Il secondo membro da definire è la proprietà "wrapper" di Common Language Runtime (CLR). Il wrapper rende molto più conveniente modificare la proprietà di <xref:System.Windows.DependencyObject.SetValue%2A> dipendenza nel codice (si evitano le chiamate a ogni volta e può effettuare tale chiamata solo una volta nel wrapper stesso). Il wrapper viene implementato con la stessa procedura valida per i wrapper implementati nella registrazione di una proprietà di dipendenza personalizzata. Per altre informazioni sull'implementazione di una proprietà di dipendenza, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md) e [Aggiungere un tipo di proprietario per una proprietà di dipendenza](how-to-add-an-owner-type-for-a-dependency-property.md).  
  
#### <a name="addowner-and-attached-properties"></a>AddOwner e proprietà associate  
 È possibile <xref:System.Windows.DependencyProperty.AddOwner%2A> chiamare una proprietà di dipendenza definita come proprietà associata dalla classe del proprietario. In genere, questa operazione viene eseguita per esporre la proprietà precedentemente associata come proprietà di dipendenza non associata. Il valore <xref:System.Windows.DependencyProperty.AddOwner%2A> restituito verrà quindi `public static readonly` esposto come campo da utilizzare come identificatore della proprietà di dipendenza e verrà definito le proprietà "wrapper" appropriate in modo che la proprietà venga visualizzata nella tabella dei membri e supporti un utilizzo della proprietà non associata nella classe.  
  
## <a name="see-also"></a>Vedere anche

- <xref:System.Windows.PropertyMetadata>
- <xref:System.Windows.DependencyObject>
- <xref:System.Windows.DependencyProperty>
- <xref:System.Windows.DependencyProperty.GetMetadata%2A>
- [Cenni preliminari sulle proprietà di dipendenza](dependency-properties-overview.md)
- [Metadati delle proprietà del framework](framework-property-metadata.md)
