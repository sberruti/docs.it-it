---
title: Formattazione del testo avanzata
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- formatting [WPF]
- text [WPF]
- typography [WPF], text formatting
ms.assetid: f0a7986e-f5b2-485c-a27d-f8e922022212
ms.openlocfilehash: d509de02cd1b3f645ee439c0b0eb33fd1ddbdb07
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/03/2020
ms.locfileid: "75636107"
---
# <a name="advanced-text-formatting"></a><span data-ttu-id="881c0-102">Formattazione del testo avanzata</span><span class="sxs-lookup"><span data-stu-id="881c0-102">Advanced Text Formatting</span></span>
<span data-ttu-id="881c0-103">Windows Presentation Foundation (WPF) fornisce un set di API affidabile per includere testo nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="881c0-103">Windows Presentation Foundation (WPF) provides a robust set of APIs for including text in your application.</span></span> <span data-ttu-id="881c0-104">Le API di layout e [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)], ad esempio <xref:System.Windows.Controls.TextBlock>, forniscono gli elementi più comuni e di uso generale per la presentazione del testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-104">Layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] APIs, such as <xref:System.Windows.Controls.TextBlock>, provide the most common and general-use elements for text presentation.</span></span> <span data-ttu-id="881c0-105">Il disegno di API, ad esempio <xref:System.Windows.Media.GlyphRunDrawing> e <xref:System.Windows.Media.FormattedText>, fornisce un mezzo per includere testo formattato nei disegni.</span><span class="sxs-lookup"><span data-stu-id="881c0-105">Drawing APIs, such as <xref:System.Windows.Media.GlyphRunDrawing> and <xref:System.Windows.Media.FormattedText>, provide a means for including formatted text in drawings.</span></span> <span data-ttu-id="881c0-106">Al livello più avanzato, WPF fornisce un motore di formattazione del testo estendibile per controllare ogni aspetto della presentazione del testo, ad esempio la gestione dell'archivio di testo, la gestione della formattazione delle esecuzioni del testo e la gestione di oggetti incorporati.</span><span class="sxs-lookup"><span data-stu-id="881c0-106">At the most advanced level, WPF provides an extensible text formatting engine to control every aspect of text presentation, such as text store management, text run formatting management, and embedded object management.</span></span>  
  
 <span data-ttu-id="881c0-107">In questo argomento viene fornita un'introduzione alla formattazione del testo WPF.</span><span class="sxs-lookup"><span data-stu-id="881c0-107">This topic provides an introduction to WPF text formatting.</span></span> <span data-ttu-id="881c0-108">Si concentra sull'implementazione del client e sull'uso del motore di formattazione del testo WPF.</span><span class="sxs-lookup"><span data-stu-id="881c0-108">It focuses on client implementation and use of the WPF text formatting engine.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="881c0-109">Tutti gli esempi di codice all'interno di questo documento sono disponibili nell'esempio relativo alla [formattazione avanzata del testo](https://go.microsoft.com/fwlink/?LinkID=159965).</span><span class="sxs-lookup"><span data-stu-id="881c0-109">All code examples within this document can be found in the [Advanced Text Formatting Sample](https://go.microsoft.com/fwlink/?LinkID=159965).</span></span>  

<a name="prereq"></a>   
## <a name="prerequisites"></a><span data-ttu-id="881c0-110">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="881c0-110">Prerequisites</span></span>  
 <span data-ttu-id="881c0-111">Questo argomento presuppone che l'utente abbia familiarità con le API di livello superiore usate per la presentazione del testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-111">This topic assumes that you are familiar with the higher level APIs used for text presentation.</span></span> <span data-ttu-id="881c0-112">La maggior parte degli scenari utente non richiede le API avanzate di formattazione del testo illustrate in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="881c0-112">Most user scenarios will not require the advanced text formatting APIs discussed in this topic.</span></span> <span data-ttu-id="881c0-113">Per un'introduzione alle diverse API di testo, vedere [documenti in WPF](documents-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="881c0-113">For an introduction to the different text APIs, see [Documents in WPF](documents-in-wpf.md).</span></span>  
  
<a name="section1"></a>   
## <a name="advanced-text-formatting"></a><span data-ttu-id="881c0-114">Formattazione del testo avanzata</span><span class="sxs-lookup"><span data-stu-id="881c0-114">Advanced Text Formatting</span></span>  
 <span data-ttu-id="881c0-115">Il layout del testo e i controlli [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in WPF forniscono le proprietà di formattazione che consentono di includere facilmente testo formattato nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="881c0-115">The text layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] controls in WPF provide formatting properties that allow you to easily include formatted text in your application.</span></span> <span data-ttu-id="881c0-116">Questi controlli espongono numerose proprietà per la gestione della presentazione del testo, inclusi il carattere tipografico, le dimensioni e il colore.</span><span class="sxs-lookup"><span data-stu-id="881c0-116">These controls expose a number of properties to handle the presentation of text, which includes its typeface, size, and color.</span></span> <span data-ttu-id="881c0-117">In circostanze normali, questi controlli sono in grado di gestire la maggior parte degli scenari di presentazione del testo nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="881c0-117">Under ordinary circumstances, these controls can handle the majority of text presentation in your application.</span></span> <span data-ttu-id="881c0-118">Tuttavia, alcuni scenari avanzati richiedono il controllo dell'archiviazione del testo e della presentazione del testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-118">However, some advanced scenarios require the control of text storage as well as text presentation.</span></span> <span data-ttu-id="881c0-119">WPF fornisce un motore di formattazione del testo estendibile a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="881c0-119">WPF provides an extensible text formatting engine for this purpose.</span></span>  
  
 <span data-ttu-id="881c0-120">Le funzionalità avanzate di formattazione del testo disponibili in WPF sono costituite da un motore di formattazione del testo, da un archivio di testo, da sequenze di testo e da proprietà di formattazione.</span><span class="sxs-lookup"><span data-stu-id="881c0-120">The advanced text formatting features found in WPF consist of a text formatting engine, a text store, text runs, and formatting properties.</span></span> <span data-ttu-id="881c0-121">Il motore di formattazione del testo <xref:System.Windows.Media.TextFormatting.TextFormatter>crea righe di testo da utilizzare per la presentazione.</span><span class="sxs-lookup"><span data-stu-id="881c0-121">The text formatting engine, <xref:System.Windows.Media.TextFormatting.TextFormatter>, creates lines of text to be used for presentation.</span></span> <span data-ttu-id="881c0-122">Questa operazione viene eseguita avviando il processo di formattazione della riga e chiamando il <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>del formattatore di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-122">This is achieved by initiating the line formatting process and calling the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span></span> <span data-ttu-id="881c0-123">Il formattatore di testo recupera le esecuzioni di testo dall'archivio di testo chiamando il metodo <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> dell'archivio.</span><span class="sxs-lookup"><span data-stu-id="881c0-123">The text formatter retrieves text runs from your text store by calling the store's <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="881c0-124">Gli oggetti <xref:System.Windows.Media.TextFormatting.TextRun> vengono quindi formati in <xref:System.Windows.Media.TextFormatting.TextLine> oggetti dal formattatore di testo e assegnati all'applicazione per l'ispezione o la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="881c0-124">The <xref:System.Windows.Media.TextFormatting.TextRun> objects are then formed into <xref:System.Windows.Media.TextFormatting.TextLine> objects by the text formatter and given to your application for inspection or display.</span></span>  
  
<a name="section2"></a>   
## <a name="using-the-text-formatter"></a><span data-ttu-id="881c0-125">Uso del formattatore di testo</span><span class="sxs-lookup"><span data-stu-id="881c0-125">Using the Text Formatter</span></span>  
 <span data-ttu-id="881c0-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> è il motore di formattazione del testo WPF e fornisce servizi per la formattazione e l'infrazione di righe di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> is the WPF text formatting engine and provides services for formatting and breaking text lines.</span></span> <span data-ttu-id="881c0-127">Il formattatore di testo può gestire diversi formati di carattere del testo e stili di paragrafo e include il supporto per il layout di testo internazionale.</span><span class="sxs-lookup"><span data-stu-id="881c0-127">The text formatter can handle different text character formats and paragraph styles, and includes support for international text layout.</span></span>  
  
 <span data-ttu-id="881c0-128">Diversamente da un'API di testo tradizionale, il <xref:System.Windows.Media.TextFormatting.TextFormatter> interagisce con un client di layout di testo tramite un set di metodi di callback.</span><span class="sxs-lookup"><span data-stu-id="881c0-128">Unlike a traditional text API, the <xref:System.Windows.Media.TextFormatting.TextFormatter> interacts with a text layout client through a set of callback methods.</span></span> <span data-ttu-id="881c0-129">Richiede che il client fornisca questi metodi in un'implementazione della classe <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="881c0-129">It requires the client to provide these methods in an implementation of the <xref:System.Windows.Media.TextFormatting.TextSource> class.</span></span> <span data-ttu-id="881c0-130">Nel diagramma seguente viene illustrata l'interazione del layout del testo tra l'applicazione client e <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span><span class="sxs-lookup"><span data-stu-id="881c0-130">The following diagram illustrates the text layout interaction between the client application and <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span></span>  
  
 ![Diagramma del client del layout di testo e TextFormatter](./media/advanced-text-formatting/text-layout-textformatter-interaction.png)  
  
 <span data-ttu-id="881c0-132">Il formattatore di testo viene utilizzato per recuperare le righe di testo formattato dall'archivio di testo, che è un'implementazione di <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="881c0-132">The text formatter is used to retrieve formatted text lines from the text store, which is an implementation of <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="881c0-133">Questa operazione viene eseguita creando prima un'istanza del formattatore di testo utilizzando il metodo <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="881c0-133">This is done by first creating an instance of the text formatter by using the <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A> method.</span></span> <span data-ttu-id="881c0-134">Questo metodo crea un'istanza del formattatore di testo e imposta i valori massimi di altezza e larghezza della riga.</span><span class="sxs-lookup"><span data-stu-id="881c0-134">This method creates an instance of the text formatter and sets the maximum line height and width values.</span></span> <span data-ttu-id="881c0-135">Non appena viene creata un'istanza del formattatore di testo, il processo di creazione della riga viene avviato chiamando il metodo <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span><span class="sxs-lookup"><span data-stu-id="881c0-135">As soon as an instance of the text formatter is created, the line creation process is started by calling the <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span> <span data-ttu-id="881c0-136"><xref:System.Windows.Media.TextFormatting.TextFormatter> richiama l'origine del testo per recuperare il testo e i parametri di formattazione per le esecuzioni del testo che formano una riga.</span><span class="sxs-lookup"><span data-stu-id="881c0-136"><xref:System.Windows.Media.TextFormatting.TextFormatter> calls back to the text source to retrieve the text and formatting parameters for the runs of text that form a line.</span></span>  
  
 <span data-ttu-id="881c0-137">L'esempio seguente illustra il processo di formattazione di un archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-137">In the following example, the process of formatting a text store is shown.</span></span> <span data-ttu-id="881c0-138">L'oggetto <xref:System.Windows.Media.TextFormatting.TextFormatter> viene utilizzato per recuperare righe di testo dall'archivio di testo e quindi formattare la riga di testo per il disegno nel <xref:System.Windows.Media.DrawingContext>.</span><span class="sxs-lookup"><span data-stu-id="881c0-138">The <xref:System.Windows.Media.TextFormatting.TextFormatter> object is used to retrieve text lines from the text store and then format the text line for drawing into the <xref:System.Windows.Media.DrawingContext>.</span></span>  
  
 [!code-csharp[TextFormatterExample#100](~/samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/Window1.xaml.cs#100)]
 [!code-vb[TextFormatterExample#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/Window1.xaml.vb#100)]  
  
<a name="section3"></a>   
## <a name="implementing-the-client-text-store"></a><span data-ttu-id="881c0-139">Implementazione dell'archivio di testo del client</span><span class="sxs-lookup"><span data-stu-id="881c0-139">Implementing the Client Text Store</span></span>  
 <span data-ttu-id="881c0-140">Quando si estende il motore di formattazione del testo, è necessario implementare e gestire tutti gli aspetti dell'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-140">When you extend the text formatting engine, you are required to implement and manage all aspects of the text store.</span></span> <span data-ttu-id="881c0-141">Non si tratta di un'attività elementare.</span><span class="sxs-lookup"><span data-stu-id="881c0-141">This is not a trivial task.</span></span> <span data-ttu-id="881c0-142">L'archivio di testo è responsabile del rilevamento delle proprietà delle sequenze di testo, delle proprietà dei paragrafi, degli oggetti incorporati e di altri contenuti simili.</span><span class="sxs-lookup"><span data-stu-id="881c0-142">The text store is responsible for tracking text run properties, paragraph properties, embedded objects, and other similar content.</span></span> <span data-ttu-id="881c0-143">Fornisce anche il formattatore di testo con singoli oggetti <xref:System.Windows.Media.TextFormatting.TextRun> che il formattatore di testo usa per creare <xref:System.Windows.Media.TextFormatting.TextLine> oggetti.</span><span class="sxs-lookup"><span data-stu-id="881c0-143">It also provides the text formatter with individual <xref:System.Windows.Media.TextFormatting.TextRun> objects which the text formatter uses to create <xref:System.Windows.Media.TextFormatting.TextLine> objects.</span></span>  
  
 <span data-ttu-id="881c0-144">Per gestire la virtualizzazione dell'archivio di testo, l'archivio di testo deve essere derivato da <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="881c0-144">To handle the virtualization of the text store, the text store must be derived from <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="881c0-145"><xref:System.Windows.Media.TextFormatting.TextSource> definisce il metodo usato dal formattatore di testo per recuperare le sequenze di testo dall'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-145"><xref:System.Windows.Media.TextFormatting.TextSource> defines the method the text formatter uses to retrieve text runs from the text store.</span></span> <span data-ttu-id="881c0-146"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> è il metodo utilizzato dal formattatore di testo per recuperare le esecuzioni di testo utilizzate nella formattazione della riga.</span><span class="sxs-lookup"><span data-stu-id="881c0-146"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is the method used by the text formatter to retrieve text runs used in line formatting.</span></span> <span data-ttu-id="881c0-147">La chiamata a <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> viene eseguita ripetutamente dal formattatore di testo fino a quando non si verifica una delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="881c0-147">The call to <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is repeatedly made by the text formatter until one of the following conditions occurs:</span></span>  
  
- <span data-ttu-id="881c0-148">Viene restituito un <xref:System.Windows.Media.TextFormatting.TextEndOfLine> o una sottoclasse.</span><span class="sxs-lookup"><span data-stu-id="881c0-148">A <xref:System.Windows.Media.TextFormatting.TextEndOfLine> or a subclass is returned.</span></span>  
  
- <span data-ttu-id="881c0-149">La larghezza accumulata delle esecuzioni di testo supera la lunghezza massima consentita nella chiamata per creare il formattatore di testo o la chiamata al metodo <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> del formattatore di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-149">The accumulated width of text runs exceeds the maximum line width specified in either the call to create the text formatter or the call to the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span>  
  
- <span data-ttu-id="881c0-150">Viene restituita una sequenza di nuova riga Unicode, ad esempio "CF", "LF" o "CRLF".</span><span class="sxs-lookup"><span data-stu-id="881c0-150">A Unicode newline sequence, such as "CF", "LF", or "CRLF", is returned.</span></span>  
  
<a name="section4"></a>   
## <a name="providing-text-runs"></a><span data-ttu-id="881c0-151">Inserimento delle sequenze di testo</span><span class="sxs-lookup"><span data-stu-id="881c0-151">Providing Text Runs</span></span>  
 <span data-ttu-id="881c0-152">Il fulcro del processo di formattazione del testo è rappresentato dall'interazione tra il formattatore di testo e l'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-152">The core of the text formatting process is the interaction between the text formatter and the text store.</span></span> <span data-ttu-id="881c0-153">L'implementazione di <xref:System.Windows.Media.TextFormatting.TextSource> fornisce il formattatore di testo con gli oggetti di <xref:System.Windows.Media.TextFormatting.TextRun> e le proprietà con le quali formattare le esecuzioni di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-153">Your implementation of <xref:System.Windows.Media.TextFormatting.TextSource> provides the text formatter with the <xref:System.Windows.Media.TextFormatting.TextRun> objects and the properties with which to format the text runs.</span></span> <span data-ttu-id="881c0-154">Questa interazione viene gestita dal metodo <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>, che viene chiamato dal formattatore di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-154">This interaction is handled by the <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method, which is called by the text formatter.</span></span>  
  
 <span data-ttu-id="881c0-155">Nella tabella seguente vengono illustrati alcuni degli oggetti <xref:System.Windows.Media.TextFormatting.TextRun> predefiniti.</span><span class="sxs-lookup"><span data-stu-id="881c0-155">The following table shows some of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects.</span></span>  
  
|<span data-ttu-id="881c0-156">Tipo di TextRun</span><span class="sxs-lookup"><span data-stu-id="881c0-156">TextRun Type</span></span>|<span data-ttu-id="881c0-157">Usage</span><span class="sxs-lookup"><span data-stu-id="881c0-157">Usage</span></span>|  
|------------------|-----------|  
|<xref:System.Windows.Media.TextFormatting.TextCharacters>|<span data-ttu-id="881c0-158">Sequenza di testo specializzata usata per passare nuovamente al formattatore di testo una rappresentazione dei glifi dei caratteri.</span><span class="sxs-lookup"><span data-stu-id="881c0-158">The specialized text run used to pass a representation of character glyphs back to the text formatter.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEmbeddedObject>|<span data-ttu-id="881c0-159">Sequenza di testo specializzata usata per fornire contenuto nel quale la misurazione, l'hit testing e il disegno vengono eseguite come un'unica operazione, ad esempio un pulsante o un'immagine all'interno del testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-159">The specialized text run used to provide content in which measuring, hit testing, and drawing is done in whole, such as a button or image within the text.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfLine>|<span data-ttu-id="881c0-160">Sequenza di testo specializzata usata per contrassegnare la fine di una riga.</span><span class="sxs-lookup"><span data-stu-id="881c0-160">The specialized text run used to mark the end of a line.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>|<span data-ttu-id="881c0-161">Sequenza di testo specializzata usata per contrassegnare la fine di un paragrafo.</span><span class="sxs-lookup"><span data-stu-id="881c0-161">The specialized text run used to mark the end of a paragraph.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfSegment>|<span data-ttu-id="881c0-162">Sequenza di testo specializzata usata per contrassegnare la fine di un segmento, ad esempio per terminare l'ambito interessato da un'esecuzione <xref:System.Windows.Media.TextFormatting.TextModifier> precedente.</span><span class="sxs-lookup"><span data-stu-id="881c0-162">The specialized text run used to mark the end of a segment, such as to end the scope affected by a previous <xref:System.Windows.Media.TextFormatting.TextModifier> run.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextHidden>|<span data-ttu-id="881c0-163">Sequenza di testo specializzata usata per contrassegnare un intervallo di caratteri nascosti.</span><span class="sxs-lookup"><span data-stu-id="881c0-163">The specialized text run used to mark a range of hidden characters.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextModifier>|<span data-ttu-id="881c0-164">Sequenza di testo specializzata usata per modificare le proprietà delle sequenze di testo nel relativo ambito.</span><span class="sxs-lookup"><span data-stu-id="881c0-164">The specialized text run used to modify properties of text runs in its scope.</span></span> <span data-ttu-id="881c0-165">L'ambito si estende alla successiva sequenza di testo <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> corrispondente o al <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>successivo.</span><span class="sxs-lookup"><span data-stu-id="881c0-165">The scope extends to the next matching <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> text run, or the next <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>.</span></span>|  
  
 <span data-ttu-id="881c0-166">Uno degli oggetti <xref:System.Windows.Media.TextFormatting.TextRun> predefiniti può essere sottoclassato.</span><span class="sxs-lookup"><span data-stu-id="881c0-166">Any of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects can be subclassed.</span></span> <span data-ttu-id="881c0-167">Ciò consente all'origine del testo di fornire al formattatore di testo sequenze di testo che includono dati personalizzati.</span><span class="sxs-lookup"><span data-stu-id="881c0-167">This allows your text source to provide the text formatter with text runs that include custom data.</span></span>  
  
 <span data-ttu-id="881c0-168">Nell'esempio seguente viene illustrato un metodo <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>.</span><span class="sxs-lookup"><span data-stu-id="881c0-168">The following example demonstrates a <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="881c0-169">Questo archivio di testo restituisce <xref:System.Windows.Media.TextFormatting.TextRun> oggetti al formattatore di testo per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="881c0-169">This text store returns <xref:System.Windows.Media.TextFormatting.TextRun> objects to the text formatter for processing.</span></span>  
  
 [!code-csharp[TextFormatterExample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/CustomTextSource.cs#101)]
 [!code-vb[TextFormatterExample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/CustomTextSource.vb#101)]  
  
> [!NOTE]
> <span data-ttu-id="881c0-170">In questo esempio, l'archivio di testo fornisce a tutto il testo le stesse proprietà.</span><span class="sxs-lookup"><span data-stu-id="881c0-170">In this example, the text store provides the same text properties to all of the text.</span></span> <span data-ttu-id="881c0-171">Gli archivi di testo avanzati devono implementare una gestione personalizzata dell'estensione in modo da consentire ai singoli caratteri di avere proprietà diverse.</span><span class="sxs-lookup"><span data-stu-id="881c0-171">Advanced text stores would need to implement their own span management to allow individual characters to have different properties.</span></span>  
  
<a name="section5"></a>   
## <a name="specifying-formatting-properties"></a><span data-ttu-id="881c0-172">Specifica delle proprietà di formattazione</span><span class="sxs-lookup"><span data-stu-id="881c0-172">Specifying Formatting Properties</span></span>  
 <span data-ttu-id="881c0-173">gli oggetti <xref:System.Windows.Media.TextFormatting.TextRun> vengono formattati usando le proprietà fornite dall'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="881c0-173"><xref:System.Windows.Media.TextFormatting.TextRun> objects are formatted by using properties provided by the text store.</span></span> <span data-ttu-id="881c0-174">Queste proprietà sono disponibili in due tipi, <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> e <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span><span class="sxs-lookup"><span data-stu-id="881c0-174">These properties come in two types, <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span></span> <span data-ttu-id="881c0-175"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> gestire le proprietà inclusivi di paragrafo, ad esempio <xref:System.Windows.TextAlignment> e <xref:System.Windows.FlowDirection>.</span><span class="sxs-lookup"><span data-stu-id="881c0-175"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> handle paragraph inclusive properties such as <xref:System.Windows.TextAlignment> and <xref:System.Windows.FlowDirection>.</span></span> <span data-ttu-id="881c0-176"><xref:System.Windows.Media.TextFormatting.TextRunProperties> sono proprietà che possono essere diverse per ogni sequenza di testo all'interno di un paragrafo, ad esempio il pennello in primo piano, <xref:System.Windows.Media.Typeface>e le dimensioni del carattere.</span><span class="sxs-lookup"><span data-stu-id="881c0-176"><xref:System.Windows.Media.TextFormatting.TextRunProperties> are properties that can be different for each text run within a paragraph, such as foreground brush, <xref:System.Windows.Media.Typeface>, and font size.</span></span> <span data-ttu-id="881c0-177">Per implementare il paragrafo personalizzato e i tipi di proprietà della sequenza di testo personalizzata, l'applicazione deve creare classi che derivano rispettivamente da <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> e <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span><span class="sxs-lookup"><span data-stu-id="881c0-177">To implement custom paragraph and custom text run property types, your application must create classes that derive from <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties> respectively.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="881c0-178">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="881c0-178">See also</span></span>

- [<span data-ttu-id="881c0-179">Funzionalità tipografiche di WPF</span><span class="sxs-lookup"><span data-stu-id="881c0-179">Typography in WPF</span></span>](typography-in-wpf.md)
- [<span data-ttu-id="881c0-180">Documenti in WPF</span><span class="sxs-lookup"><span data-stu-id="881c0-180">Documents in WPF</span></span>](documents-in-wpf.md)
