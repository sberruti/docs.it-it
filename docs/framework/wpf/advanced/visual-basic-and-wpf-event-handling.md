---
title: Visual Basic e la gestione degli eventi WPF
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 5625b63f2a2162f8f188476bfd61bde4c717f1dd
ms.sourcegitcommit: f8c36054eab877de4d40a705aacafa2552ce70e9
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/31/2019
ms.locfileid: "75559859"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="cea9e-102">Visual Basic e la gestione degli eventi WPF</span><span class="sxs-lookup"><span data-stu-id="cea9e-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="cea9e-103">Per il linguaggio Microsoft Visual Basic .NET in particolare, è possibile usare la parola chiave `Handles` specifica del linguaggio per associare i gestori eventi alle istanze, anziché collegare i gestori eventi agli attributi o usare il metodo <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="cea9e-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="cea9e-104">Tuttavia, la tecnica `Handles` per collegare gestori alle istanze presenta alcuni limiti, in quanto la sintassi `Handles` non è in grado di supportare alcune delle funzioni degli eventi indirizzati specifiche del sistema di eventi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cea9e-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="cea9e-105">Uso di "Handles" in un'applicazione WPF</span><span class="sxs-lookup"><span data-stu-id="cea9e-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="cea9e-106">I gestori eventi connessi a istanze ed eventi tramite `Handles` devono essere definiti tutti all'interno della dichiarazione di classe parziale dell'istanza. Ciò vale anche per i gestori eventi assegnati tramite valori di attributo negli elementi.</span><span class="sxs-lookup"><span data-stu-id="cea9e-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="cea9e-107">È possibile specificare solo `Handles` per un elemento nella pagina che ha un valore di proprietà <xref:System.Windows.FrameworkContentElement.Name%2A> (o [direttiva x:Name](../../../desktop-wpf/xaml-services/xname-directive.md) dichiarata).</span><span class="sxs-lookup"><span data-stu-id="cea9e-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="cea9e-108">Ciò è dovuto al fatto che il <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] crea il riferimento all'istanza necessario per supportare il formato di riferimento dell' *istanza. evento* richiesto dalla sintassi `Handles`.</span><span class="sxs-lookup"><span data-stu-id="cea9e-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="cea9e-109">L'unico elemento che può essere utilizzato per `Handles` senza un riferimento <xref:System.Windows.FrameworkContentElement.Name%2A> è l'istanza dell'elemento radice che definisce la classe parziale.</span><span class="sxs-lookup"><span data-stu-id="cea9e-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="cea9e-110">È possibile assegnare lo stesso gestore a più elementi separando i riferimenti *Istanza.Evento* dopo `Handles` con delle virgole.</span><span class="sxs-lookup"><span data-stu-id="cea9e-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="cea9e-111">È possibile usare `Handles` per assegnare più gestori allo stesso riferimento *Istanza.Evento*.</span><span class="sxs-lookup"><span data-stu-id="cea9e-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="cea9e-112">Non attribuire alcuna importanza all'ordine in cui vengono forniti i gestori nel riferimento `Handles`. È necessario presupporre che gestori dello stesso evento possono essere richiamati in qualsiasi ordine.</span><span class="sxs-lookup"><span data-stu-id="cea9e-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="cea9e-113">Per rimuovere un gestore aggiunto con `Handles` nella dichiarazione, è possibile chiamare <xref:System.Windows.UIElement.RemoveHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="cea9e-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="cea9e-114">È possibile usare `Handles` per collegare i gestori per gli eventi indirizzati, purché i gestori vengano collegati a istanze che definiscono l'evento gestito nelle rispettive tabelle di membri.</span><span class="sxs-lookup"><span data-stu-id="cea9e-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="cea9e-115">Per gli eventi indirizzati, i gestori collegati con `Handles` seguono le stesse regole di routing dei gestori collegati come [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributi o con la firma comune di <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="cea9e-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="cea9e-116">Ciò significa che se l'evento è già contrassegnato come gestito (la proprietà <xref:System.Windows.RoutedEventArgs.Handled%2A> nei dati dell'evento viene `True`), i gestori collegati con `Handles` non vengono richiamati in risposta a tale istanza di evento.</span><span class="sxs-lookup"><span data-stu-id="cea9e-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="cea9e-117">L'evento potrebbe essere contrassegnato come gestito dai gestori dell'istanza in un altro elemento della route o dalla gestione delle classi nell'elemento corrente o negli elementi precedenti della route.</span><span class="sxs-lookup"><span data-stu-id="cea9e-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="cea9e-118">Per gli eventi di input che supportano eventi accoppiati di tunneling e di bubbling, è possibile che la route di tunneling abbia contrassegnato la coppia di eventi come gestita.</span><span class="sxs-lookup"><span data-stu-id="cea9e-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="cea9e-119">Per altre informazioni sugli eventi indirizzati, vedere [Cenni preliminari sugli eventi indirizzati](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="cea9e-119">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="cea9e-120">Limitazioni di "Handle" per l'aggiunta di gestori</span><span class="sxs-lookup"><span data-stu-id="cea9e-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="cea9e-121">`Handles` non può fare riferimento ai gestori per gli eventi associati.</span><span class="sxs-lookup"><span data-stu-id="cea9e-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="cea9e-122">È necessario usare il metodo della funzione di accesso `add` per quello specifico evento associato oppure gli attributi dell'evento *nometipo.nomeevento* in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cea9e-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="cea9e-123">Per informazioni dettagliate, vedere [Cenni preliminari sugli eventi indirizzati](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="cea9e-123">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="cea9e-124">Per gli eventi indirizzati, è possibile usare `Handles` unicamente per assegnare gestori per le istanze in cui quell'evento è presente nella tabella dei membri dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="cea9e-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="cea9e-125">Tuttavia, con gli eventi indirizzati in generale, un elemento padre può essere un listener per un evento degli elementi figlio anche se l'elemento padre non dispone di quell'evento nella relativa tabella dei membri.</span><span class="sxs-lookup"><span data-stu-id="cea9e-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="cea9e-126">Nella sintassi dell'attributo, ciò può essere specificato tramite un formato di attributo *nometipo.nomemembro* che qualifica il tipo che definisce effettivamente l'evento che si vuole gestire.</span><span class="sxs-lookup"><span data-stu-id="cea9e-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="cea9e-127">Ad esempio, un `Page` padre (senza `Click` evento definito) può restare in ascolto degli eventi click del pulsante assegnando un gestore attributi nel formato `Button.Click`.</span><span class="sxs-lookup"><span data-stu-id="cea9e-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="cea9e-128">Tuttavia, `Handles` non supporta il formato *nometipo.nomemembro*, in quanto deve supportare un formato *Istanza.Evento* in conflitto.</span><span class="sxs-lookup"><span data-stu-id="cea9e-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="cea9e-129">Per informazioni dettagliate, vedere [Cenni preliminari sugli eventi indirizzati](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="cea9e-129">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="cea9e-130">`Handles` non è in grado di associare gestori richiamati per eventi che sono già contrassegnati come gestiti.</span><span class="sxs-lookup"><span data-stu-id="cea9e-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="cea9e-131">Al contrario, è necessario usare il codice e chiamare l'overload `handledEventsToo` di <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="cea9e-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="cea9e-132">Non usare la sintassi `Handles` nel codice Visual Basic quando si specifica un gestore eventi per lo stesso evento in XAML.</span><span class="sxs-lookup"><span data-stu-id="cea9e-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="cea9e-133">In questo caso, il gestore eventi viene chiamato due volte.</span><span class="sxs-lookup"><span data-stu-id="cea9e-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="cea9e-134">Come WPF implementa la funzionalità "Handles"</span><span class="sxs-lookup"><span data-stu-id="cea9e-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="cea9e-135">Quando viene compilata una pagina di [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)], il file intermedio dichiara `Friend` `WithEvents` riferimenti a ogni elemento della pagina che dispone di una <xref:System.Windows.FrameworkContentElement.Name%2A> set di proprietà (o [direttiva x:Name](../../../desktop-wpf/xaml-services/xname-directive.md) dichiarata).</span><span class="sxs-lookup"><span data-stu-id="cea9e-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="cea9e-136">Ogni istanza denominata è potenzialmente un elemento che può essere assegnato a un gestore tramite `Handles`.</span><span class="sxs-lookup"><span data-stu-id="cea9e-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="cea9e-137">In Visual Studio, IntelliSense consente di visualizzare il completamento per cui sono disponibili elementi per un riferimento `Handles` in una pagina.</span><span class="sxs-lookup"><span data-stu-id="cea9e-137">Within Visual Studio, IntelliSense can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="cea9e-138">Tuttavia, tale operazione potrebbe richiedere un passaggio di compilazione che consenta al file intermedio di popolare tutti i riferimenti `Friends`.</span><span class="sxs-lookup"><span data-stu-id="cea9e-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cea9e-139">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="cea9e-139">See also</span></span>

- <xref:System.Windows.UIElement.AddHandler%2A>
- [<span data-ttu-id="cea9e-140">Contrassegno degli eventi indirizzati come gestiti e gestione delle classi</span><span class="sxs-lookup"><span data-stu-id="cea9e-140">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="cea9e-141">Cenni preliminari sugli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="cea9e-141">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="cea9e-142">Cenni preliminari su XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="cea9e-142">XAML Overview (WPF)</span></span>](../../../desktop-wpf/fundamentals/xaml.md)
