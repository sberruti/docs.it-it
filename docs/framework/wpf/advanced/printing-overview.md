---
title: Cenni preliminari sulla stampa
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 902d51341850b5245b9fa6410b1954b2ab373bbc
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187205"
---
# <a name="printing-overview"></a><span data-ttu-id="6e6d5-102">Cenni preliminari sulla stampa</span><span class="sxs-lookup"><span data-stu-id="6e6d5-102">Printing Overview</span></span>
<span data-ttu-id="6e6d5-103">Con Microsoft .NET Framework, gli sviluppatori di applicazioni che utilizzano Windows Presentation Foundation (WPF) dispongono di un nuovo set completo di API di gestione del sistema di stampa e stampa.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="6e6d5-104">Con Windows Vista, alcuni di questi miglioramenti del sistema di stampa sono disponibili anche per gli sviluppatori che creano applicazioni Windows Form e gli sviluppatori che utilizzano codice non gestito.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-104">With Windows Vista, some of these print system enhancements are also available to developers creating Windows Forms applications and developers using unmanaged code.</span></span> <span data-ttu-id="6e6d5-105">Alla base di questa nuova funzionalità vi sono il nuovo formato di file XML Paper Specification (XPS) e il percorso di stampa XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="6e6d5-106">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>
## <a name="about-xps"></a><span data-ttu-id="6e6d5-107">Informazioni su XPS</span><span class="sxs-lookup"><span data-stu-id="6e6d5-107">About XPS</span></span>  
 <span data-ttu-id="6e6d5-108">XPS è un formato di documento elettronico, un formato di file di spool e un linguaggio di descrizione della pagina.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="6e6d5-109">Si tratta di un formato di documento aperto che utilizza XML, Open Packaging Conventions (OPC) e altri standard di settore per creare documenti multipiattaforma.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="6e6d5-110">XPS semplifica il processo di creazione, condivisione, stampa, visualizzazione e archiviazione dei documenti digitali.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="6e6d5-111">Per ulteriori informazioni su XPS, consultate [Documenti XPS.](/windows/desktop/printdocs/documents)</span><span class="sxs-lookup"><span data-stu-id="6e6d5-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="6e6d5-112">Diverse tecniche per la stampa di contenuto basato su XPS utilizzando WPFWPF sono illustrate in Stampa di [file XPS](how-to-programmatically-print-xps-files.md)a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="6e6d5-113">Può essere utile fare riferimento a tali esempi durante la lettura di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="6e6d5-114">Gli sviluppatori di codice non gestito devono consultare la documentazione relativa alla [funzione MXDC_ESCAPE](/windows/desktop/printdocs/mxdc-escape).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="6e6d5-115">Gli sviluppatori di Windows Form <xref:System.Drawing.Printing> devono utilizzare l'API nello spazio dei nomi che non supporta il percorso di stampa XPS completo, ma supporta un percorso di stampa ibrido da GDI a XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="6e6d5-116">Vedere **Architettura del percorso di stampa** più avanti.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>
## <a name="xps-print-path"></a><span data-ttu-id="6e6d5-117">Percorso di stampa XPS</span><span class="sxs-lookup"><span data-stu-id="6e6d5-117">XPS Print Path</span></span>  
 <span data-ttu-id="6e6d5-118">Il percorso di stampa XPS (XML Paper Specification) è una nuova funzionalità di Windows che ridefinisce la modalità di gestione della stampa nelle applicazioni Windows.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="6e6d5-119">Poiché XPS può sostituire un linguaggio di presentazione del documento (ad esempio RTF), un formato dello spooler di stampa (ad esempio WMF) e un linguaggio di descrizione della pagina (ad esempio PCL o Postscript); il nuovo percorso di stampa mantiene il formato XPS dalla pubblicazione dell'applicazione all'elaborazione finale nel driver o nel dispositivo di stampa.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="6e6d5-120">Il percorso di stampa XPS si basa sul modello di driver della stampante XPS (XPSDrv), che offre diversi vantaggi per gli sviluppatori, ad esempio "ciò che si vede è ciò che si ottiene" (WYSIWYG), il supporto del colore migliorato e le prestazioni di stampa notevolmente migliorate.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="6e6d5-121">Per ulteriori informazioni su XPSDrv, vedere la documentazione di [Windows Driver Kit.](/windows-hardware/drivers/)</span><span class="sxs-lookup"><span data-stu-id="6e6d5-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="6e6d5-122">Il funzionamento dello spooler di stampa per i documenti XPS è essenzialmente lo stesso delle versioni precedenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="6e6d5-123">Tuttavia, è stato migliorato per supportare il percorso di stampa XPS oltre al percorso di stampa GDI esistente.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="6e6d5-124">Il nuovo percorso di stampa utilizza in modo nativo un file di spool XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="6e6d5-125">Mentre i driver della stampante in modalità utente scritti per le versioni precedenti di Windows continueranno a funzionare, è necessario un driver della stampante XPS (XPSDrv) per utilizzare il percorso di stampa XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="6e6d5-126">I vantaggi del percorso di stampa XPS sono significativi e includono:</span><span class="sxs-lookup"><span data-stu-id="6e6d5-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="6e6d5-127">Supporto per la stampa WYSIWYG</span><span class="sxs-lookup"><span data-stu-id="6e6d5-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="6e6d5-128">Supporto nativo di profili colori avanzati che includono 32 bit per canale (bpc), CMYK, colori con nome, molteplici inchiostri e supporto nativo di trasparenza e sfumature.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="6e6d5-129">Miglioramento delle prestazioni di stampa per le applicazioni basate su .NET Framework e Win32.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-129">Improved print performance for both .NET Framework and Win32 based applications.</span></span>  
  
- <span data-ttu-id="6e6d5-130">Formato XPS standard del settore.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="6e6d5-131">Per gli scenari di stampa di base, è disponibile un'API semplice e intuitiva con un unico punto di ingresso per l'interfaccia utente, la configurazione e l'invio di processi.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="6e6d5-132">Per scenari avanzati, è disponibile un supporto aggiuntivo per la personalizzazione dell'[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] (o nessuna [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]), la stampa sincrona o asincrona e le funzionalità di stampa in modalità batch.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="6e6d5-133">Entrambe le opzioni forniscono supporto di stampa in modalità di attendibilità completa o parziale.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="6e6d5-134">XPS è stato progettato tenendo presente l'estendibilità.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="6e6d5-135">Utilizzando il framework di estendibilità, le funzionalità e le funzionalità possono essere aggiunte a XPS in modo modulare.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="6e6d5-136">Le funzionalità di estensibilità includono:</span><span class="sxs-lookup"><span data-stu-id="6e6d5-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="6e6d5-137">Schema di stampa.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-137">Print Schema.</span></span> <span data-ttu-id="6e6d5-138">Lo schema pubblico viene aggiornato regolarmente e consente la rapida estensione delle funzionalità del dispositivo</span><span class="sxs-lookup"><span data-stu-id="6e6d5-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="6e6d5-139">Vedere **PrintTicket e PrintCapabilities** più avanti.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="6e6d5-140">Pipeline del filtro estensibile.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="6e6d5-141">La pipeline di filtro XPS Printer Driver (XPSDrv) è stata progettata per consentire la stampa diretta e scalabile di documenti XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="6e6d5-142">Per ulteriori informazioni, vedere [Driver della stampante XPSDrv](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>
  
### <a name="print-path-architecture"></a><span data-ttu-id="6e6d5-143">Architettura del percorso di stampa</span><span class="sxs-lookup"><span data-stu-id="6e6d5-143">Print Path Architecture</span></span>  
 <span data-ttu-id="6e6d5-144">Mentre entrambe le applicazioni Win32 e .NET Framework supportano XPS, le applicazioni Win32 e Windows Form utilizzano una conversione da GDI a XPS per creare contenuto in formato XPS per il driver della stampante XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-144">While both Win32 and .NET Framework applications support XPS, Win32 and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="6e6d5-145">Queste applicazioni non sono necessarie per utilizzare il percorso di stampa XPS e possono continuare a utilizzare la stampa basata su Enhanced Metafile (EMF).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="6e6d5-146">Tuttavia, la maggior parte delle funzionalità e dei miglioramenti XPS sono disponibili solo per le applicazioni destinate al percorso di stampa XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="6e6d5-147">Per consentire l'utilizzo di stampanti basate su XPSDrv da parte di applicazioni Win32 e Windows Form, il driver della stampante XPS (XPSDrv) supporta la conversione di GDI in formato XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-147">To enable the use of XPSDrv-based printers by Win32 and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="6e6d5-148">Il modello XPSDrv fornisce inoltre un convertitore per il formato da XPS a GDI in modo che le applicazioni Win32 possano stampare documenti XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-148">The XPSDrv model also provides a converter for XPS to GDI format so that Win32 applications can print XPS Documents.</span></span> <span data-ttu-id="6e6d5-149">Per le applicazioni WPFWPF, la <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> conversione del formato <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> XPS <xref:System.Windows.Xps.XpsDocumentWriter> in formato GDI viene eseguita automaticamente dai metodi e della classe ogni volta che la coda di stampa di destinazione dell'operazione di scrittura non dispone di un driver XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="6e6d5-150">Le applicazioni Windows Form non possono stampare documenti XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="6e6d5-151">Nella figura seguente viene illustrato il sottosistema di stampa e vengono definite le parti fornite da Microsoft e le parti definite dai fornitori di software e hardware:</span><span class="sxs-lookup"><span data-stu-id="6e6d5-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![Screenshot mostra il sistema di stampa XPS.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="6e6d5-153">Stampa XPS di base</span><span class="sxs-lookup"><span data-stu-id="6e6d5-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="6e6d5-154">WPFWPF definisce un'API di base e avanzata.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="6e6d5-155">Per le applicazioni che non richiedono un'ampia personalizzazione della stampa o l'accesso all'intero set di funzionalità XPS, è disponibile il supporto di stampa di base.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="6e6d5-156">Il supporto di stampa di base viene esposto tramite un controllo finestra di dialogo di stampa che richiede una configurazione minima e offre un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] già familiare all'utente.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="6e6d5-157">Molte funzionalità XPS sono disponibili utilizzando questo modello di stampa semplificato.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="6e6d5-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="6e6d5-158">PrintDialog</span></span>  
 <span data-ttu-id="6e6d5-159">Il <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> controllo fornisce un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]unico punto di ingresso per l'invio di processi XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="6e6d5-160">Per informazioni su come creare un'istanza del controllo e come usarlo, vedere [Richiamare una finestra di dialogo di stampa](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="6e6d5-161">Stampa XPS avanzata</span><span class="sxs-lookup"><span data-stu-id="6e6d5-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="6e6d5-162">Per accedere al set completo di funzionalità XPS, è necessario utilizzare l'API di stampa avanzata.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="6e6d5-163">Diverse API rilevanti sono descritte più dettagliatamente di seguito.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="6e6d5-164">Per un elenco completo delle API del percorso <xref:System.Windows.Xps> <xref:System.Printing> di stampa XPS, vedere i riferimenti allo spazio dei nomi e .</span><span class="sxs-lookup"><span data-stu-id="6e6d5-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="6e6d5-165">PrintTicket e PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="6e6d5-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="6e6d5-166">Le <xref:System.Printing.PrintTicket> <xref:System.Printing.PrintCapabilities> classi e sono alla base delle funzionalità XPS avanzate.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="6e6d5-167">Entrambi i tipi di oggetti sono strutture formattate in XML di funzionalità orientate alla stampa, ad esempio regole di confronto, stampa fronte-retro, graffatura e così via. Queste strutture sono definite dallo schema di stampa.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="6e6d5-168">Un oggetto <xref:System.Printing.PrintTicket> indica a una stampante come elaborare un processo di stampa.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="6e6d5-169">La classe <xref:System.Printing.PrintCapabilities> consente di definire le funzionalità di una stampante.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="6e6d5-170">Eseguendo una query delle funzionalità di una stampante, è possibile creare un oggetto <xref:System.Printing.PrintTicket> per usare in modo completo tutte le funzionalità supportate di una stampante.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="6e6d5-171">Analogamente, è possibile evitare le funzionalità non supportate.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="6e6d5-172">L'esempio riportato di seguito illustra come eseguire una query della classe <xref:System.Printing.PrintCapabilities> di una stampante e creare un oggetto <xref:System.Printing.PrintTicket> tramite il codice.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="6e6d5-173">PrintServer e PrintQueue</span><span class="sxs-lookup"><span data-stu-id="6e6d5-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="6e6d5-174">La classe <xref:System.Printing.PrintServer> rappresenta un server di stampa di rete, mentre la classe <xref:System.Printing.PrintQueue> rappresenta una stampante e la coda del processo di output a essa associata.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="6e6d5-175">Insieme, queste API consentono la gestione avanzata dei processi di stampa di un server.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="6e6d5-176">La classe <xref:System.Printing.PrintServer>, o una delle relative classi derivate, consente di gestire la classe <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="6e6d5-177">Il metodo <xref:System.Printing.PrintQueue.AddJob%2A> consente di inserire un nuovo processo di stampa nella coda.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="6e6d5-178">L'esempio di codice riportato di seguito illustra come creare un oggetto <xref:System.Printing.LocalPrintServer> e come accedere al relativo oggetto <xref:System.Printing.PrintQueue> predefinito tramite il codice.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="6e6d5-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="6e6d5-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="6e6d5-180">Un <xref:System.Windows.Xps.XpsDocumentWriter>oggetto , <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> con <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> i suoi numerosi metodi e <xref:System.Printing.PrintQueue>, viene utilizzato per scrivere documenti XPS in un file .</span><span class="sxs-lookup"><span data-stu-id="6e6d5-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="6e6d5-181">Ad esempio, <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> il metodo viene utilizzato per <xref:System.Printing.PrintTicket> restituire un documento XPS e in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="6e6d5-182">Il <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> metodo viene utilizzato per restituire <xref:System.Printing.PrintTicket> un documento XPS e in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="6e6d5-183">L'esempio riportato di seguito illustra come creare un oggetto <xref:System.Windows.Xps.XpsDocumentWriter> tramite codice.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="6e6d5-184">I metodi <xref:System.Printing.PrintQueue.AddJob%2A> consentono anche di stampare in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="6e6d5-185">Vedere [Stampa di file XPS a livello di codice](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="6e6d5-186">per informazioni dettagliate.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>
## <a name="gdi-print-path"></a><span data-ttu-id="6e6d5-187">Percorso di stampa GDI</span><span class="sxs-lookup"><span data-stu-id="6e6d5-187">GDI Print Path</span></span>  
 <span data-ttu-id="6e6d5-188">Mentre le applicazioni WPFWPF supportano in modo nativo il percorso di stampa XPS, le applicazioni Win32 e Windows Form possono anche sfruttare alcune funzionalità di XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-188">While WPF applications natively support the XPS print path, Win32 and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="6e6d5-189">Il driver della stampante XPS (XPSDrv) è in grado di convertire l'output basato su GDI in formato XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="6e6d5-190">Per gli scenari avanzati, la conversione personalizzata del contenuto è supportata tramite [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="6e6d5-191">Analogamente, le applicazioni WPFWPF possono anche restituire il <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> percorso di <xref:System.Windows.Xps.XpsDocumentWriter> stampa GDI chiamando uno dei metodi o della classe e designando una stampante non XpsDrv come coda di stampa di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="6e6d5-192">Per le applicazioni che non richiedono funzionalità o supporto XPS, il percorso di stampa GDI corrente rimane invariato.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="6e6d5-193">Per ulteriori materiale di riferimento sul percorso di stampa GDI e sulle varie opzioni di conversione XPS, vedere [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) e [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="6e6d5-194">Modello di driver XPSDrv</span><span class="sxs-lookup"><span data-stu-id="6e6d5-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="6e6d5-195">Il percorso di stampa XPS migliora l'efficienza dello spooler utilizzando XPS come formato di spool di stampa nativo durante la stampa su una stampante o un driver abilitato per XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="6e6d5-196">Il processo di spooling semplificato elimina la necessità di generare un file di spooling intermedio, ad esempio un file di dati EMF, prima che il documento venga sottoposto a spooling.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="6e6d5-197">Grazie a file di spool di dimensioni inferiori, il percorso di stampa XPS può ridurre il traffico di rete e migliorare le prestazioni di stampa.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="6e6d5-198">EMF è un formato chiuso che rappresenta l'output dell'applicazione come una serie di chiamate in GDI per i servizi di rendering.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="6e6d5-199">A differenza di EMF, il formato di spool XPS rappresenta il documento effettivo senza richiedere un'ulteriore interpretazione durante l'output su un driver della stampante basato su XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="6e6d5-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="6e6d5-200">I driver possono agire direttamente sui dati nel formato.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="6e6d5-201">Questa funzionalità elimina le conversioni dei dati e dello spazio colore necessarie quando si utilizzano file EMF e driver di stampa basati su GDI.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="6e6d5-202">Le dimensioni dei file di spooling sono in genere ridotte quando si utilizzano documenti XPS destinati a un driver della stampante XPS (XPSDrv) rispetto ai rispettivi equivalenti EMF; tuttavia, ci sono eccezioni:</span><span class="sxs-lookup"><span data-stu-id="6e6d5-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="6e6d5-203">Una grafica vettoriale molto complessa, a più livelli o scritta in modo inappropriato può presentare dimensioni maggiori rispetto alla relativa versione bitmap.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="6e6d5-204">Per scopi di visualizzazione, i file XPS incorporano tipi di carattere del dispositivo, nonché tipi di caratteri basati sul computer. Al contrario, i file di spooling GDI non incorporano alcun tipo di carattere del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="6e6d5-205">Tuttavia, entrambi i tipi di carattere presentano sottoinsiemi (vedere di seguito) e i driver della stampante possono rimuovere i tipi di carattere del dispositivo prima di trasmettere il file alla stampante.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="6e6d5-206">La riduzione delle dimensioni di spooling viene eseguita tramite molteplici meccanismi:</span><span class="sxs-lookup"><span data-stu-id="6e6d5-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="6e6d5-207">**Incorporamento di sottoinsiemi di tipi di carattere**.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-207">**Font subsetting**.</span></span> <span data-ttu-id="6e6d5-208">Solo i caratteri utilizzati all'interno del documento effettivo vengono memorizzati nel file XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="6e6d5-209">**Supporto grafico avanzato**.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="6e6d5-210">Il supporto nativo per le primitive di trasparenza e sfumatura evita la rasterizzazione del contenuto nel documento XPS.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="6e6d5-211">**Identificazione di risorse comuni**.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-211">**Identification of common resources**.</span></span> <span data-ttu-id="6e6d5-212">Le risorse usate più volte (ad esempio un'immagine che rappresenta un logo aziendale) sono considerate risorse condivise e vengono caricate solo una volta.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="6e6d5-213">**Compressione zip**.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-213">**ZIP compression**.</span></span> <span data-ttu-id="6e6d5-214">Tutti i documenti XPS utilizzano la compressione zip.</span><span class="sxs-lookup"><span data-stu-id="6e6d5-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6e6d5-215">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6e6d5-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="6e6d5-216">Argomenti relativi alle procedure</span><span class="sxs-lookup"><span data-stu-id="6e6d5-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="6e6d5-217">Documenti in WPF</span><span class="sxs-lookup"><span data-stu-id="6e6d5-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="6e6d5-218">Documenti XPS</span><span class="sxs-lookup"><span data-stu-id="6e6d5-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="6e6d5-219">Serializzazione e archiviazione di documenti</span><span class="sxs-lookup"><span data-stu-id="6e6d5-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="6e6d5-220">Convertitore di documenti XPS Microsoft (MXDC)</span><span class="sxs-lookup"><span data-stu-id="6e6d5-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
