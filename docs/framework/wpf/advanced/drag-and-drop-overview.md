---
title: Cenni preliminari sul trascinamento della selezione
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- drag-and-drop [WPF], implementing
- drag sources [WPF], drag-and-drop
- data transfer [WPF], drag-and-drop
- drag-and-drop [WPF], about
- drag-and-drop [WPF], events
- drop targets [WPF], drag-and-drop
ms.assetid: 1a5b27b0-0ac5-4cdf-86c0-86ac0271fa64
ms.openlocfilehash: dd42af77300a7a93bbcbfa4c8f1fc365fc3f5da1
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79185973"
---
# <a name="drag-and-drop-overview"></a><span data-ttu-id="91cb6-102">Cenni preliminari sul trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="91cb6-102">Drag and Drop Overview</span></span>
<span data-ttu-id="91cb6-103">Questo argomento fornisce una panoramica del supporto per il trascinamento della selezione nelle applicazioni [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="91cb6-103">This topic provides an overview of drag-and-drop support in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] applications.</span></span> <span data-ttu-id="91cb6-104">Per trascinamento della selezione si intende di solito un metodo di trasferimento dei dati, in cui si usa un mouse (o un altro dispositivo di puntamento) per selezionare uno o più oggetti, si trascinano questi oggetti su un obiettivo di rilascio desiderato nell'[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] e li si rilascia.</span><span class="sxs-lookup"><span data-stu-id="91cb6-104">Drag-and-drop commonly refers to a method of data transfer that involves using a mouse (or some other pointing device) to select one or more objects, dragging these objects over some desired drop target in the [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)], and dropping them.</span></span>  

<a name="Drag_and_Drop_Support"></a>
## <a name="drag-and-drop-support-in-wpf"></a><span data-ttu-id="91cb6-105">Supporto del trascinamento della selezione in WPF</span><span class="sxs-lookup"><span data-stu-id="91cb6-105">Drag-and-Drop Support in WPF</span></span>  
 <span data-ttu-id="91cb6-106">Nelle operazioni di trascinamento della selezione in genere sono coinvolte due parti: un'origine di trascinamento da cui ha origine l'oggetto trascinato e un obiettivo di rilascio che riceve l'oggetto rilasciato.</span><span class="sxs-lookup"><span data-stu-id="91cb6-106">Drag-and-drop operations typically involve two parties: a drag source from which the dragged object originates and a drop target which receives the dropped object.</span></span>  <span data-ttu-id="91cb6-107">L'origine di trascinamento e l'obiettivo di rilascio possono essere elementi dell'interfaccia utente della stessa applicazione o di un'applicazione diversa.</span><span class="sxs-lookup"><span data-stu-id="91cb6-107">The drag source and drop target may be UI elements in the same application or a different application.</span></span>  
  
 <span data-ttu-id="91cb6-108">Il tipo e il numero di oggetti che possono essere manipolati con un trascinamento della selezione sono del tutto arbitrari.</span><span class="sxs-lookup"><span data-stu-id="91cb6-108">The type and number of objects that can be manipulated with drag-and-drop is completely arbitrary.</span></span> <span data-ttu-id="91cb6-109">Ad esempio file, cartelle e selezioni di contenuto sono alcuni degli oggetti più comuni manipolati con operazioni di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-109">For example, files, folders, and selections of content are some of the more common objects manipulated through drag-and-drop operations.</span></span>  
  
 <span data-ttu-id="91cb6-110">Le particolari azioni eseguite durante un'operazione di trascinamento della selezione sono specifiche dell'applicazione e spesso dipendono dal contesto.</span><span class="sxs-lookup"><span data-stu-id="91cb6-110">The particular actions performed during a drag-and-drop operation are application specific, and often determined by context.</span></span>  <span data-ttu-id="91cb6-111">Ad esempio, se si trascina una selezione di file da una cartella a un'altra sullo stesso dispositivo di archiviazione, i file vengono spostati per impostazione predefinita, mentre il trascinamento di file da una condivisione UNC (Universal Naming Convention) viene copiato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="91cb6-111">For example, dragging a selection of files from one folder to another on the same storage device moves the files by default, whereas dragging files from a Universal Naming Convention (UNC) share to a local folder copies the files by default.</span></span>  
  
 <span data-ttu-id="91cb6-112">Le funzionalità di trascinamento della selezione fornite da [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono estremamente flessibili e personalizzabili, per poter supportare svariati scenari di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-112">The drag-and-drop facilities provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are designed to be highly flexible and customizable to support a wide variety of drag-and-drop scenarios.</span></span>  <span data-ttu-id="91cb6-113">Il trascinamento della selezione supporta la manipolazione di oggetti in una sola applicazione o tra applicazioni diverse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-113">Drag-and-drop supports manipulating objects within a single application, or between different applications.</span></span> <span data-ttu-id="91cb6-114">Anche il trascinamento [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] della selezione tra le applicazioni e altre applicazioni Windows è completamente supportato.</span><span class="sxs-lookup"><span data-stu-id="91cb6-114">Dragging-and-dropping between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications and other Windows applications is also fully supported.</span></span>  
  
 <span data-ttu-id="91cb6-115">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], qualsiasi <xref:System.Windows.UIElement> o <xref:System.Windows.ContentElement> può partecipare al trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-115">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], any <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> can participate in drag-and-drop.</span></span> <span data-ttu-id="91cb6-116">Gli eventi e i metodi necessari per le operazioni di trascinamento della selezione vengono definiti nella classe <xref:System.Windows.DragDrop>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-116">The events and methods required for drag-and-drop operations are defined in the <xref:System.Windows.DragDrop> class.</span></span> <span data-ttu-id="91cb6-117">Le classi <xref:System.Windows.UIElement> e <xref:System.Windows.ContentElement> contengono alias per gli eventi associati <xref:System.Windows.DragDrop> in modo che gli eventi appaiano nell'elenco dei membri della classe quando un oggetto <xref:System.Windows.UIElement> o <xref:System.Windows.ContentElement> viene ereditato come elemento di base.</span><span class="sxs-lookup"><span data-stu-id="91cb6-117">The <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> classes contain aliases for the <xref:System.Windows.DragDrop> attached events so that the events appear in the class members list when a <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> is inherited as a base element.</span></span> <span data-ttu-id="91cb6-118">I gestori eventi associati a questi eventi vengono associati all'evento associato <xref:System.Windows.DragDrop> sottostante e ricevono la stessa istanza di dati dell'evento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-118">Event handlers that are attached to these events are attached to the underlying <xref:System.Windows.DragDrop> attached event and receive the same event data instance.</span></span> <span data-ttu-id="91cb6-119">Per altre informazioni, vedere l'evento <xref:System.Windows.UIElement.Drop?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-119">For more information, see the <xref:System.Windows.UIElement.Drop?displayProperty=nameWithType> event.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="91cb6-120">Il trascinamento della selezione OLE non funziona nell'area Internet.</span><span class="sxs-lookup"><span data-stu-id="91cb6-120">OLE drag-and-drop does not work while in the Internet zone.</span></span>  
  
<a name="Data_Transfer"></a>
## <a name="data-transfer"></a><span data-ttu-id="91cb6-121">Trasferimento dati</span><span class="sxs-lookup"><span data-stu-id="91cb6-121">Data Transfer</span></span>  
 <span data-ttu-id="91cb6-122">Il trascinamento della selezione rientra nell'ambito del trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-122">Drag-and-drop is part of the more general area of data transfer.</span></span> <span data-ttu-id="91cb6-123">Il trasferimento dei dati include operazioni di trascinamento della selezione e di copia e incolla.</span><span class="sxs-lookup"><span data-stu-id="91cb6-123">Data transfer includes drag-and-drop and copy-and-paste operations.</span></span> <span data-ttu-id="91cb6-124">Un'operazione di trascinamento della selezione è analoga a un'operazione di copia e incolla o taglia e incolla usata per trasferire dati da un oggetto o un'applicazione a un'altra usando gli Appunti di sistema.</span><span class="sxs-lookup"><span data-stu-id="91cb6-124">A drag-and-drop operation is analogous to a copy-and-paste or cut-and-paste operation that is used to transfer data from one object or application to another by using the system clipboard.</span></span> <span data-ttu-id="91cb6-125">Entrambi i tipi di operazioni richiedono:</span><span class="sxs-lookup"><span data-stu-id="91cb6-125">Both types of operations require:</span></span>  
  
- <span data-ttu-id="91cb6-126">Un oggetto di origine che fornisce i dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-126">A source object that provides the data.</span></span>  
  
- <span data-ttu-id="91cb6-127">Un modo per archiviare temporaneamente i dati trasferiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-127">A way to temporarily store the transferred data.</span></span>  
  
- <span data-ttu-id="91cb6-128">Un oggetto di destinazione che riceve i dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-128">A target object that receives the data.</span></span>  
  
 <span data-ttu-id="91cb6-129">In un'operazione di copia e incolla, vengono usati gli Appunti di sistema per archiviare temporaneamente i dati trasferiti. In un'operazione di trascinamento della selezione, viene usato un oggetto <xref:System.Windows.DataObject> per archiviare i dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-129">In a copy-and-paste operation, the system clipboard is used to temporarily store the transferred data; in a drag-and-drop operation, a <xref:System.Windows.DataObject> is used to store the data.</span></span> <span data-ttu-id="91cb6-130">Concettualmente, un oggetto dati è costituito da una o più coppie di un <xref:System.Object> contenente i dati effettivi e dal corrispondente identificatore di formato dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-130">Conceptually, a data object consists of one or more pairs of an <xref:System.Object> that contains the actual data, and a corresponding data format identifier.</span></span>  
  
 <span data-ttu-id="91cb6-131">L'origine di trascinamento avvia un'operazione di trascinamento della selezione chiamando il metodo <xref:System.Windows.DragDrop.DoDragDrop%2A?displayProperty=nameWithType> statico e passandogli i dati trasferiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-131">The drag source initiates a drag-and-drop operation by calling the static <xref:System.Windows.DragDrop.DoDragDrop%2A?displayProperty=nameWithType> method and passing the transferred data to it.</span></span> <span data-ttu-id="91cb6-132">Il metodo <xref:System.Windows.DragDrop.DoDragDrop%2A> eseguirà il wrapping automatico dei dati in <xref:System.Windows.DataObject>, se necessario.</span><span class="sxs-lookup"><span data-stu-id="91cb6-132">The <xref:System.Windows.DragDrop.DoDragDrop%2A> method will automatically wrap the data in a <xref:System.Windows.DataObject> if necessary.</span></span> <span data-ttu-id="91cb6-133">Per un maggiore controllo sul formato dei dati, è possibile eseguire il wrapping dei dati in un <xref:System.Windows.DataObject> prima di passarli al metodo <xref:System.Windows.DragDrop.DoDragDrop%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-133">For greater control over the data format, you can wrap the data in a <xref:System.Windows.DataObject> before passing it to the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="91cb6-134">L'obiettivo di rilascio è responsabile dell'estrazione dei dati dal <xref:System.Windows.DataObject>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-134">The drop target is responsible for extracting the data from the <xref:System.Windows.DataObject>.</span></span> <span data-ttu-id="91cb6-135">Per altre informazioni sull'uso degli oggetti dati, vedere [Dati e oggetti dati](data-and-data-objects.md).</span><span class="sxs-lookup"><span data-stu-id="91cb6-135">For more information about working with data objects, see [Data and Data Objects](data-and-data-objects.md).</span></span>  
  
 <span data-ttu-id="91cb6-136">L'origine e la destinazione di un'operazione di trascinamento della selezione sono elementi dell'interfaccia utente, ma i dati effettivamente trasferiti non hanno di solito una rappresentazione visiva.</span><span class="sxs-lookup"><span data-stu-id="91cb6-136">The source and target of a drag-and-drop operation are UI elements; however, the data that is actually being transferred typically does not have a visual representation.</span></span> <span data-ttu-id="91cb6-137">È possibile scrivere il codice per fornire una rappresentazione visiva dei dati trascinati, come accade quando si trascinano i file in Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-137">You can write code to provide a visual representation of the data that is dragged, such as occurs when dragging files in Windows Explorer.</span></span> <span data-ttu-id="91cb6-138">Per impostazione predefinita, viene fornito un feedback all'utente modificando il cursore per rappresentare l'effetto che l'operazione di trascinamento della selezione avrà sui dati, ad esempio se i dati verranno spostati o copiati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-138">By default, feedback is provided to the user by changing the cursor to represent the effect that the drag-and-drop operation will have on the data, such as whether the data will be moved or copied.</span></span>  
  
### <a name="drag-and-drop-effects"></a><span data-ttu-id="91cb6-139">Effetti di trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="91cb6-139">Drag-and-Drop Effects</span></span>  
 <span data-ttu-id="91cb6-140">Le operazioni di trascinamento della selezione possono avere effetti diversi sui dati trasferiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-140">Drag-and-drop operations can have different effects on the transferred data.</span></span> <span data-ttu-id="91cb6-141">Ad esempio, è possibile copiare i dati oppure spostarli.</span><span class="sxs-lookup"><span data-stu-id="91cb6-141">For example, you can copy the data or you can move the data.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="91cb6-142">definisce un'enumerazione <xref:System.Windows.DragDropEffects> che è possibile usare per specificare l'effetto di un'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-142">defines a <xref:System.Windows.DragDropEffects> enumeration that you can use to specify the effect of a drag-and-drop operation.</span></span> <span data-ttu-id="91cb6-143">Nell'origine di trascinamento, è possibile specificare gli effetti che verranno consentiti dall'origine nel metodo <xref:System.Windows.DragDrop.DoDragDrop%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-143">In the drag source, you can specify the effects that the source will allow in the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="91cb6-144">Nell'obiettivo di rilascio, è possibile specificare l'effetto previsto per la destinazione nella proprietà <xref:System.Windows.DragEventArgs.Effects%2A> della classe <xref:System.Windows.DragEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-144">In the drop target, you can specify the effect that the target intends in the <xref:System.Windows.DragEventArgs.Effects%2A> property of the <xref:System.Windows.DragEventArgs> class.</span></span> <span data-ttu-id="91cb6-145">Quando l'obiettivo di rilascio specifica l'effetto previsto nell'evento <xref:System.Windows.DragDrop.DragOver>, queste informazioni vengono passate nuovamente all'origine di trascinamento nell'evento <xref:System.Windows.DragDrop.GiveFeedback>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-145">When the drop target specifies its intended effect in the <xref:System.Windows.DragDrop.DragOver> event, that information is passed back to the drag source in the <xref:System.Windows.DragDrop.GiveFeedback> event.</span></span> <span data-ttu-id="91cb6-146">L'origine di trascinamento usa queste informazioni per informare l'utente dell'effetto sui dati previsto per l'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-146">The drag source uses this information to inform the user what effect the drop target intends to have on the data.</span></span> <span data-ttu-id="91cb6-147">Quando i dati vengono rilasciati, l'obiettivo di rilascio specifica il vero e proprio effetto nell'evento <xref:System.Windows.DragDrop.Drop>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-147">When the data is dropped, the drop target specifies its actual effect in the <xref:System.Windows.DragDrop.Drop> event.</span></span> <span data-ttu-id="91cb6-148">Queste informazioni vengono passate all'origine di trascinamento come valore restituito del metodo <xref:System.Windows.DragDrop.DoDragDrop%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-148">That information is passed back to the drag source as the return value of the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="91cb6-149">Se l'obiettivo di trascinamento restituisce un effetto non presente nell'elenco di origini di trascinamento di `allowedEffects`, l'operazione di trascinamento della selezione viene annullata e il trasferimento dati non viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="91cb6-149">If the drop target returns an effect that is not in the drag sources list of `allowedEffects`, the drag-and-drop operation is cancelled without any data transfer occurring.</span></span>  
  
 <span data-ttu-id="91cb6-150">È importante ricordare che in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)],i valori <xref:System.Windows.DragDropEffects> vengono usati solo per fornire la comunicazione tra l'origine di trascinamento e l'obiettivo di rilascio in relazione agli effetti dell'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-150">It is important to remember that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the <xref:System.Windows.DragDropEffects> values are only used to provide communication between the drag source and the drop target regarding the effects of the drag-and-drop operation.</span></span> <span data-ttu-id="91cb6-151">L'effetto vero e proprio dell'operazione di trascinamento della selezione dipende dal codice scritto nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-151">The actual effect of the drag-and-drop operation depends on you to write the appropriate code in your application.</span></span>  
  
 <span data-ttu-id="91cb6-152">L'obiettivo di rilascio, ad esempio, potrebbe specificare che l'effetto di rilascio dei dati è lo spostamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-152">For example, the drop target might specify that the effect of dropping data on it is to move the data.</span></span> <span data-ttu-id="91cb6-153">Tuttavia, per spostare i dati, è necessario sia aggiungerli all'elemento di destinazione che rimuoverli dall'elemento di origine.</span><span class="sxs-lookup"><span data-stu-id="91cb6-153">However, to move the data, it must be both added to the target element and removed from the source element.</span></span> <span data-ttu-id="91cb6-154">L'elemento di origine potrebbe indicare che consente lo spostamento dei dati, ma, se non si specifica il codice per rimuovere i dati dall'elemento di origine, come risultato finale i dati verranno copiati e non spostati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-154">The source element might indicate that it allows moving the data, but if you do not provide the code to remove the data from the source element, the end result will be that the data is copied, and not moved.</span></span>  
  
<a name="Drag_and_Drop_Events"></a>
## <a name="drag-and-drop-events"></a><span data-ttu-id="91cb6-155">Eventi del trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="91cb6-155">Drag-and-Drop Events</span></span>  
 <span data-ttu-id="91cb6-156">Le operazioni di trascinamento della selezione supportano un modello basato sugli eventi.</span><span class="sxs-lookup"><span data-stu-id="91cb6-156">Drag-and-drop operations support an event driven model.</span></span>  <span data-ttu-id="91cb6-157">Sia l'origine di trascinamento che l'obiettivo di rilascio usano un set standard di eventi per gestire le operazioni di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-157">Both the drag source and the drop target use a standard set of events to handle drag-and-drop operations.</span></span>  <span data-ttu-id="91cb6-158">Le tabelle seguenti riepilogano gli eventi di trascinamento della selezione standard.</span><span class="sxs-lookup"><span data-stu-id="91cb6-158">The following tables summarize the standard drag-and-drop events.</span></span> <span data-ttu-id="91cb6-159">Sono eventi associati nella <xref:System.Windows.DragDrop> classe.</span><span class="sxs-lookup"><span data-stu-id="91cb6-159">These are attached events on the <xref:System.Windows.DragDrop> class.</span></span> <span data-ttu-id="91cb6-160">Per altre informazioni sugli eventi associati, vedere [Cenni preliminari sugli eventi associati](attached-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="91cb6-160">For more information about attached events, see [Attached Events Overview](attached-events-overview.md).</span></span>  
  
### <a name="drag-source-events"></a><span data-ttu-id="91cb6-161">Eventi di origine di trascinamento</span><span class="sxs-lookup"><span data-stu-id="91cb6-161">Drag Source Events</span></span>  
  
|<span data-ttu-id="91cb6-162">Event</span><span class="sxs-lookup"><span data-stu-id="91cb6-162">Event</span></span>|<span data-ttu-id="91cb6-163">Summary</span><span class="sxs-lookup"><span data-stu-id="91cb6-163">Summary</span></span>|  
|-----------|-------------|  
|<xref:System.Windows.DragDrop.GiveFeedback>|<span data-ttu-id="91cb6-164">Questo evento si verifica continuamente durante un'operazione di trascinamento della selezione e consente all'origine di trascinamento di fornire informazioni all'utente.</span><span class="sxs-lookup"><span data-stu-id="91cb6-164">This event occurs continuously during a drag-and-drop operation, and enables the drop source to give feedback information to the user.</span></span> <span data-ttu-id="91cb6-165">Per fornire questo feedback, in genere viene modificato l'aspetto del puntatore del mouse per indicare gli effetti consentiti dall'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-165">This feedback is commonly given by changing the appearance of the mouse pointer to indicate the effects allowed by the drop target.</span></span>  <span data-ttu-id="91cb6-166">Si tratta di un evento di bubbling.</span><span class="sxs-lookup"><span data-stu-id="91cb6-166">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.QueryContinueDrag>|<span data-ttu-id="91cb6-167">Questo evento si verifica quando gli stati della tastiera o dei pulsanti del mouse cambiano durante un'operazione di trascinamento della selezione e consente all'origine di rilascio di annullare l'operazione di trascinamento a seconda degli stati di tastiera/pulsanti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-167">This event occurs when there is a change in the keyboard or mouse button states during a drag-and-drop operation, and enables the drop source to cancel the drag-and-drop operation depending on the key/button states.</span></span> <span data-ttu-id="91cb6-168">Si tratta di un evento di bubbling.</span><span class="sxs-lookup"><span data-stu-id="91cb6-168">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewGiveFeedback>|<span data-ttu-id="91cb6-169">Versione tunneling di <xref:System.Windows.DragDrop.GiveFeedback>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-169">Tunneling version of <xref:System.Windows.DragDrop.GiveFeedback>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewQueryContinueDrag>|<span data-ttu-id="91cb6-170">Versione tunneling di <xref:System.Windows.DragDrop.QueryContinueDrag>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-170">Tunneling version of <xref:System.Windows.DragDrop.QueryContinueDrag>.</span></span>|  
  
### <a name="drop-target-events"></a><span data-ttu-id="91cb6-171">Eventi dell'obiettivo di rilascio</span><span class="sxs-lookup"><span data-stu-id="91cb6-171">Drop Target Events</span></span>  
  
|<span data-ttu-id="91cb6-172">Event</span><span class="sxs-lookup"><span data-stu-id="91cb6-172">Event</span></span>|<span data-ttu-id="91cb6-173">Summary</span><span class="sxs-lookup"><span data-stu-id="91cb6-173">Summary</span></span>|  
|-----------|-------------|  
|<xref:System.Windows.DragDrop.DragEnter>|<span data-ttu-id="91cb6-174">Questo evento si verifica quando un oggetto viene trascinato entro il limite dell'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-174">This event occurs when an object is dragged into the drop target's boundary.</span></span> <span data-ttu-id="91cb6-175">Si tratta di un evento di bubbling.</span><span class="sxs-lookup"><span data-stu-id="91cb6-175">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.DragLeave>|<span data-ttu-id="91cb6-176">Questo evento si verifica quando un oggetto viene trascinato al di fuori del limite dell'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-176">This event occurs when an object is dragged out of the drop target's boundary.</span></span>  <span data-ttu-id="91cb6-177">Si tratta di un evento di bubbling.</span><span class="sxs-lookup"><span data-stu-id="91cb6-177">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.DragOver>|<span data-ttu-id="91cb6-178">Questo evento si verifica continuamente mentre un oggetto viene trascinato (spostato) entro il limite dell'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-178">This event occurs continuously while an object is dragged (moved) within the drop target's boundary.</span></span> <span data-ttu-id="91cb6-179">Si tratta di un evento di bubbling.</span><span class="sxs-lookup"><span data-stu-id="91cb6-179">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.Drop>|<span data-ttu-id="91cb6-180">Questo evento si verifica quando un oggetto viene rilasciato sull'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-180">This event occurs when an object is dropped on the drop target.</span></span>  <span data-ttu-id="91cb6-181">Si tratta di un evento di bubbling.</span><span class="sxs-lookup"><span data-stu-id="91cb6-181">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDragEnter>|<span data-ttu-id="91cb6-182">Versione tunneling di <xref:System.Windows.DragDrop.DragEnter>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-182">Tunneling version of <xref:System.Windows.DragDrop.DragEnter>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDragLeave>|<span data-ttu-id="91cb6-183">Versione tunneling di <xref:System.Windows.DragDrop.DragLeave>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-183">Tunneling version of <xref:System.Windows.DragDrop.DragLeave>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDragOver>|<span data-ttu-id="91cb6-184">Versione tunneling di <xref:System.Windows.DragDrop.DragOver>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-184">Tunneling version of <xref:System.Windows.DragDrop.DragOver>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDrop>|<span data-ttu-id="91cb6-185">Versione tunneling di <xref:System.Windows.DragDrop.Drop>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-185">Tunneling version of <xref:System.Windows.DragDrop.Drop>.</span></span>|  
  
 <span data-ttu-id="91cb6-186">Per gestire gli eventi di trascinamento della selezione per le istanze di un oggetto, aggiungere i gestori per gli eventi elencati nelle tabelle precedenti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-186">To handle drag-and-drop events for instances of an object, add handlers for the events listed in the preceding tables.</span></span> <span data-ttu-id="91cb6-187">Per gestire gli eventi di trascinamento della selezione a livello di classe, eseguire l'override dei corrispondenti metodi On\*Event e On\*PreviewEvent virtuali.</span><span class="sxs-lookup"><span data-stu-id="91cb6-187">To handle drag-and-drop events at the class level, override the corresponding virtual On\*Event and On\*PreviewEvent methods.</span></span> <span data-ttu-id="91cb6-188">Per altre informazioni, vedere [Gestione delle classi degli eventi indirizzati tramite classi di base dei controlli](marking-routed-events-as-handled-and-class-handling.md#Class_Handling_of_Routed_Events).</span><span class="sxs-lookup"><span data-stu-id="91cb6-188">For more information, see [Class Handling of Routed Events by Control Base Classes](marking-routed-events-as-handled-and-class-handling.md#Class_Handling_of_Routed_Events).</span></span>  
  
<a name="Implementing_Drag_And_Drop"></a>
## <a name="implementing-drag-and-drop"></a><span data-ttu-id="91cb6-189">Implementazione del trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="91cb6-189">Implementing Drag-and-Drop</span></span>  
 <span data-ttu-id="91cb6-190">Un elemento dell'interfaccia utente può essere un'origine di trascinamento, un obiettivo di rilascio o entrambi.</span><span class="sxs-lookup"><span data-stu-id="91cb6-190">A UI element can be a drag source, a drop target, or both.</span></span> <span data-ttu-id="91cb6-191">Per implementare il trascinamento della selezione di base, è necessario scrivere il codice per avviare l'operazione di trascinamento e per elaborare i dati rilasciati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-191">To implement basic drag-and-drop, you write code to initiate the drag-and-drop operation and to process the dropped data.</span></span> <span data-ttu-id="91cb6-192">È possibile migliorare l'esperienza di trascinamento della selezione gestendo gli eventi di trascinamento facoltativi.</span><span class="sxs-lookup"><span data-stu-id="91cb6-192">You can enhance the drag-and-drop experience by handling optional drag-and-drop events.</span></span>  
  
 <span data-ttu-id="91cb6-193">Per implementare il trascinamento della selezione di base, completare le seguenti attività:</span><span class="sxs-lookup"><span data-stu-id="91cb6-193">To implement basic drag-and-drop, you will complete the following tasks:</span></span>  
  
- <span data-ttu-id="91cb6-194">Identificare l'elemento che sarà un'origine di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-194">Identify the element that will be a drag source.</span></span> <span data-ttu-id="91cb6-195">Un'origine di trascinamento può essere un oggetto <xref:System.Windows.UIElement> o <xref:System.Windows.ContentElement>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-195">A drag source can be a <xref:System.Windows.UIElement> or a <xref:System.Windows.ContentElement>.</span></span>  
  
- <span data-ttu-id="91cb6-196">Creare un gestore eventi nell'origine di trascinamento che avvierà l'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-196">Create an event handler on the drag source that will initiate the drag-and-drop operation.</span></span> <span data-ttu-id="91cb6-197">L'evento è in genere <xref:System.Windows.UIElement.MouseMove>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-197">The event is typically the <xref:System.Windows.UIElement.MouseMove> event.</span></span>  
  
- <span data-ttu-id="91cb6-198">Nel gestore eventi dell'origine di trascinamento chiamare il metodo <xref:System.Windows.DragDrop.DoDragDrop%2A> per avviare l'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-198">In the drag source event handler, call the <xref:System.Windows.DragDrop.DoDragDrop%2A> method to initiate the drag-and-drop operation.</span></span> <span data-ttu-id="91cb6-199">Nella chiamata a <xref:System.Windows.DragDrop.DoDragDrop%2A> specificare l'origine di trascinamento, i dati da trasferire e gli effetti consentiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-199">In the <xref:System.Windows.DragDrop.DoDragDrop%2A> call, specify the drag source, the data to be transferred, and the allowed effects.</span></span>  
  
- <span data-ttu-id="91cb6-200">Identificare l'elemento che sarà un obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-200">Identify the element that will be a drop target.</span></span> <span data-ttu-id="91cb6-201">Un obiettivo di rilascio può essere un oggetto <xref:System.Windows.UIElement> o <xref:System.Windows.ContentElement>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-201">A drop target can be <xref:System.Windows.UIElement> or a <xref:System.Windows.ContentElement>.</span></span>  
  
- <span data-ttu-id="91cb6-202">Nell'obiettivo di rilascio impostare la proprietà <xref:System.Windows.UIElement.AllowDrop%2A> su `true`.</span><span class="sxs-lookup"><span data-stu-id="91cb6-202">On the drop target, set the <xref:System.Windows.UIElement.AllowDrop%2A> property to `true`.</span></span>  
  
- <span data-ttu-id="91cb6-203">Nell'obiettivo di rilascio creare un gestore dell'evento <xref:System.Windows.DragDrop.Drop> per elaborare i dati rilasciati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-203">In the drop target, create a <xref:System.Windows.DragDrop.Drop> event handler to process the dropped data.</span></span>  
  
- <span data-ttu-id="91cb6-204">Nel gestore dell'evento <xref:System.Windows.DragDrop.Drop> estrarre i dati da <xref:System.Windows.DragEventArgs> usando i metodi <xref:System.Windows.DataObject.GetDataPresent%2A> e <xref:System.Windows.DataObject.GetData%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-204">In the <xref:System.Windows.DragDrop.Drop> event handler, extract the data from the <xref:System.Windows.DragEventArgs> by using the <xref:System.Windows.DataObject.GetDataPresent%2A> and <xref:System.Windows.DataObject.GetData%2A> methods.</span></span>  
  
- <span data-ttu-id="91cb6-205">Nel gestore dell'evento <xref:System.Windows.DragDrop.Drop> usare i dati per eseguire l'operazione di trascinamento della selezione desiderata.</span><span class="sxs-lookup"><span data-stu-id="91cb6-205">In the <xref:System.Windows.DragDrop.Drop> event handler, use the data to perform the desired drag-and-drop operation.</span></span>  
  
 <span data-ttu-id="91cb6-206">È possibile migliorare l'implementazione del trascinamento della selezione creando un <xref:System.Windows.DataObject> personalizzato e gestendo eventi di origine di trascinamento e obiettivo di rilascio facoltativi, come mostrato nelle attività seguenti:</span><span class="sxs-lookup"><span data-stu-id="91cb6-206">You can enhance your drag-and-drop implementation by creating a custom <xref:System.Windows.DataObject> and by handling optional drag source and drop target events, as shown in the following tasks:</span></span>  
  
- <span data-ttu-id="91cb6-207">Per trasferire dati personalizzati o più elementi di dati, creare un <xref:System.Windows.DataObject> da passare al metodo <xref:System.Windows.DragDrop.DoDragDrop%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-207">To transfer custom data or multiple data items, create a <xref:System.Windows.DataObject> to pass to the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span>  
  
- <span data-ttu-id="91cb6-208">Per eseguire azioni aggiuntive durante un trascinamento, gestire gli eventi <xref:System.Windows.DragDrop.DragEnter>, <xref:System.Windows.DragDrop.DragOver> e <xref:System.Windows.DragDrop.DragLeave> nell'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-208">To perform additional actions during a drag, handle the <xref:System.Windows.DragDrop.DragEnter>, <xref:System.Windows.DragDrop.DragOver>, and <xref:System.Windows.DragDrop.DragLeave> events on the drop target.</span></span>  
  
- <span data-ttu-id="91cb6-209">Per modificare l'aspetto del puntatore del mouse, gestire l'evento <xref:System.Windows.DragDrop.GiveFeedback> nell'origine di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-209">To change the appearance of the mouse pointer, handle the <xref:System.Windows.DragDrop.GiveFeedback> event on the drag source.</span></span>  
  
- <span data-ttu-id="91cb6-210">Per modificare la modalità con cui annullare l'operazione di trascinamento della selezione, gestire l'evento <xref:System.Windows.DragDrop.QueryContinueDrag> nell'origine di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-210">To change how the drag-and-drop operation is canceled, handle the <xref:System.Windows.DragDrop.QueryContinueDrag> event on the drag source.</span></span>  
  
<a name="Drag_And_Drop_Example"></a>
## <a name="drag-and-drop-example"></a><span data-ttu-id="91cb6-211">Esempi di trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="91cb6-211">Drag-and-Drop Example</span></span>  
 <span data-ttu-id="91cb6-212">Questa sezione descrive come implementare il trascinamento della selezione per un elemento <xref:System.Windows.Shapes.Ellipse>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-212">This section describes how to implement drag-and-drop for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="91cb6-213"><xref:System.Windows.Shapes.Ellipse> è sia un'origine di trascinamento che un obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-213">The <xref:System.Windows.Shapes.Ellipse> is both a drag source and a drop target.</span></span> <span data-ttu-id="91cb6-214">I dati trasferiti sono la rappresentazione di stringa della proprietà <xref:System.Windows.Shapes.Shape.Fill%2A> dell'ellisse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-214">The transferred data is the string representation of the ellipse’s <xref:System.Windows.Shapes.Shape.Fill%2A> property.</span></span> <span data-ttu-id="91cb6-215">Il codice XAML seguente mostra l'elemento <xref:System.Windows.Shapes.Ellipse> e gli eventi relativi al trascinamento della selezione gestiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-215">The following XAML shows the <xref:System.Windows.Shapes.Ellipse> element and the drag-and-drop related events that it handles.</span></span> <span data-ttu-id="91cb6-216">Per i passaggi completi per implementare il trascinamento della selezione, vedere [Procedura dettagliata: abilitare il trascinamento della selezione in un controllo utente](walkthrough-enabling-drag-and-drop-on-a-user-control.md).</span><span class="sxs-lookup"><span data-stu-id="91cb6-216">For complete steps on how to implement drag-and-drop, see [Walkthrough: Enabling Drag and Drop on a User Control](walkthrough-enabling-drag-and-drop-on-a-user-control.md).</span></span>  
  
 [!code-xaml[DragDropSnippets#EllipseXaml](~/samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml#ellipsexaml)]  
  
### <a name="enabling-an-element-to-be-a-drag-source"></a><span data-ttu-id="91cb6-217">Impostazione di un elemento come origine di trascinamento</span><span class="sxs-lookup"><span data-stu-id="91cb6-217">Enabling an Element to be a Drag Source</span></span>  
 <span data-ttu-id="91cb6-218">Un oggetto che è un'origine di trascinamento è responsabile di:</span><span class="sxs-lookup"><span data-stu-id="91cb6-218">An object that is a drag source is responsible for:</span></span>  
  
- <span data-ttu-id="91cb6-219">Identificare quando si verifica un trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-219">Identifying when a drag occurs.</span></span>  
  
- <span data-ttu-id="91cb6-220">Avviare l'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-220">Initiating the drag-and-drop operation.</span></span>  
  
- <span data-ttu-id="91cb6-221">Identificare i dati da trasferire.</span><span class="sxs-lookup"><span data-stu-id="91cb6-221">Identifying the data to be transferred.</span></span>  
  
- <span data-ttu-id="91cb6-222">Specificare gli effetti che l'operazione di trascinamento della selezione può avere sui dati trasferiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-222">Specifying the effects that the drag-and-drop operation is allowed to have on the transferred data.</span></span>  
  
 <span data-ttu-id="91cb6-223">L'origine di trascinamento può anche fornire all'utente feedback relativo alle azioni consentite (spostamento, copia, nessuna) e può annullare l'operazione di trascinamento della selezione in base a un input utente aggiuntivo, ad esempio la pressione di ESC durante il trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-223">The drag source may also give feedback to the user regarding the allowed actions (move, copy, none), and can cancel the drag-and-drop operation based on additional user input, such as pressing the ESC key during the drag.</span></span>  
  
 <span data-ttu-id="91cb6-224">È responsabilità dell'applicazione determinare quando si verifica un trascinamento e quindi avviare l'operazione di trascinamento della selezione chiamando il metodo <xref:System.Windows.DragDrop.DoDragDrop%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-224">It is the responsibility of your application to determine when a drag occurs, and then initiate the drag-and-drop operation by calling the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="91cb6-225">Questo di solito avviene quando si verifica un evento <xref:System.Windows.UIElement.MouseMove> sull'elemento da trascinare mentre viene premuto un pulsante del mouse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-225">Typically, this is when a <xref:System.Windows.UIElement.MouseMove> event occurs over the element to be dragged while a mouse button is pressed.</span></span> <span data-ttu-id="91cb6-226">Il seguente esempio mostra come avviare un'operazione di trascinamento e rilascio dal gestore dell'evento <xref:System.Windows.UIElement.MouseMove> di un elemento <xref:System.Windows.Shapes.Ellipse> per impostarlo come origine di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-226">The following example shows how to initiate a drag-and-drop operation from the <xref:System.Windows.UIElement.MouseMove> event handler of an <xref:System.Windows.Shapes.Ellipse> element to make it a drag source.</span></span> <span data-ttu-id="91cb6-227">I dati trasferiti sono la rappresentazione di stringa della proprietà <xref:System.Windows.Shapes.Shape.Fill%2A> dell'ellisse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-227">The transferred data is the string representation of the ellipse’s <xref:System.Windows.Shapes.Shape.Fill%2A> property.</span></span>  
  
 [!code-csharp[DragDropSnippets#DoDragDrop](~/samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dodragdrop)]
 [!code-vb[DragDropSnippets#DoDragDrop](~/samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dodragdrop)]  
  
 <span data-ttu-id="91cb6-228">Nel gestore dell'evento <xref:System.Windows.UIElement.MouseMove> chiamare il metodo <xref:System.Windows.DragDrop.DoDragDrop%2A> per avviare l'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-228">Inside of the <xref:System.Windows.UIElement.MouseMove> event handler, call the <xref:System.Windows.DragDrop.DoDragDrop%2A> method to initiate the drag-and-drop operation.</span></span> <span data-ttu-id="91cb6-229">Il metodo <xref:System.Windows.DragDrop.DoDragDrop%2A> accetta tre parametri:</span><span class="sxs-lookup"><span data-stu-id="91cb6-229">The <xref:System.Windows.DragDrop.DoDragDrop%2A> method takes three parameters:</span></span>  
  
- <span data-ttu-id="91cb6-230">`dragSource`: riferimento all'oggetto dipendenza che è l'origine dei dati trasferiti. Di solito è l'origine dell'evento <xref:System.Windows.UIElement.MouseMove>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-230">`dragSource` – A reference to the dependency object that is the source of the transferred data; this is typically the source of the <xref:System.Windows.UIElement.MouseMove> event.</span></span>  
  
- <span data-ttu-id="91cb6-231">`data`: oggetto contenente i dati trasferiti, di cui è stato eseguito il wrapping in un <xref:System.Windows.DataObject>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-231">`data` - An object that contains the transferred data, wrapped in a <xref:System.Windows.DataObject>.</span></span>  
  
- <span data-ttu-id="91cb6-232">`allowedEffects`: uno dei valori dell'enumerazione <xref:System.Windows.DragDropEffects>, che specifica gli effetti consentiti dell'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-232">`allowedEffects` - One of the <xref:System.Windows.DragDropEffects> enumeration values that specifies the permitted effects of the drag-and-drop operation.</span></span>  
  
 <span data-ttu-id="91cb6-233">Qualsiasi oggetto serializzabile può essere passato nel parametro `data`.</span><span class="sxs-lookup"><span data-stu-id="91cb6-233">Any serializable object can be passed in the `data` parameter.</span></span> <span data-ttu-id="91cb6-234">Se il wrapping dei dati non è già stato eseguito in un <xref:System.Windows.DataObject>, verrà eseguito automaticamente in un nuovo <xref:System.Windows.DataObject>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-234">If the data is not already wrapped in a <xref:System.Windows.DataObject>, it will automatically be wrapped in a new <xref:System.Windows.DataObject>.</span></span> <span data-ttu-id="91cb6-235">Per passare più elementi di dati, è necessario creare il <xref:System.Windows.DataObject> manualmente e passarlo al metodo <xref:System.Windows.DragDrop.DoDragDrop%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-235">To pass multiple data items, you must create the <xref:System.Windows.DataObject> yourself, and pass it to the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="91cb6-236">Per altre informazioni, vedere [Dati e oggetti dati](data-and-data-objects.md).</span><span class="sxs-lookup"><span data-stu-id="91cb6-236">For more information, see [Data and Data Objects](data-and-data-objects.md).</span></span>  
  
 <span data-ttu-id="91cb6-237">Il parametro `allowedEffects` viene usato per specificare quali azioni l'origine di trascinamento consentirà di eseguire all'obiettivo di rilascio con i dati trasferiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-237">The `allowedEffects` parameter is used to specify what the drag source will allow the drop target to do with the transferred data.</span></span> <span data-ttu-id="91cb6-238">I valori comuni per un'origine di trascinamento sono <xref:System.Windows.DragDropEffects.Copy>, <xref:System.Windows.DragDropEffects.Move> e <xref:System.Windows.DragDropEffects.All>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-238">The common values for a drag source are <xref:System.Windows.DragDropEffects.Copy>, <xref:System.Windows.DragDropEffects.Move>, and <xref:System.Windows.DragDropEffects.All>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="91cb6-239">L'obiettivo di rilascio può anche specificare gli effetti previsti in risposta ai dati rilasciati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-239">The drop target is also able to specify what effects it intends in response to the dropped data.</span></span> <span data-ttu-id="91cb6-240">Ad esempio, se l'obiettivo di rilascio non riconosce il tipo di dati da rilasciare, può rifiutare i dati impostando gli effetti consentiti su <xref:System.Windows.DragDropEffects.None>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-240">For example, if the drop target does not recognize the data type to be dropped, it can refuse the data by setting its allowed effects to <xref:System.Windows.DragDropEffects.None>.</span></span> <span data-ttu-id="91cb6-241">In genere esegue questa operazione nel gestore dell'evento <xref:System.Windows.DragDrop.DragOver>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-241">It typically does this in its <xref:System.Windows.DragDrop.DragOver> event handler.</span></span>  
  
 <span data-ttu-id="91cb6-242">Un'origine di trascinamento può facoltativamente gestire gli eventi <xref:System.Windows.DragDrop.GiveFeedback> e <xref:System.Windows.DragDrop.QueryContinueDrag>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-242">A drag source can optionally handle the <xref:System.Windows.DragDrop.GiveFeedback> and <xref:System.Windows.DragDrop.QueryContinueDrag> events.</span></span> <span data-ttu-id="91cb6-243">Questi eventi hanno gestori predefiniti che vengono usati solo se non si contrassegnano gli eventi come gestiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-243">These events have default handlers that are used unless you mark the events as handled.</span></span> <span data-ttu-id="91cb6-244">In genere si ignorano questi eventi a meno che non esista un'esigenza specifica di modificarne il comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="91cb6-244">You will typically ignore these events unless you have a specific need to change their default behavior.</span></span>  
  
 <span data-ttu-id="91cb6-245">L'evento <xref:System.Windows.DragDrop.GiveFeedback> viene generato continuamente mentre l'origine di trascinamento viene trascinata.</span><span class="sxs-lookup"><span data-stu-id="91cb6-245">The <xref:System.Windows.DragDrop.GiveFeedback> event is raised continuously while the drag source is being dragged.</span></span> <span data-ttu-id="91cb6-246">Il gestore predefinito per questo evento controlla se l'origine di trascinamento sia su un obiettivo di rilascio valido.</span><span class="sxs-lookup"><span data-stu-id="91cb6-246">The default handler for this event checks whether the drag source is over a valid drop target.</span></span> <span data-ttu-id="91cb6-247">Se lo è, controlla gli effetti consentiti dell'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-247">If it is, it checks the allowed effects of the drop target.</span></span> <span data-ttu-id="91cb6-248">Fornisce quindi feedback all'utente finale sugli effetti di rilascio consentiti.</span><span class="sxs-lookup"><span data-stu-id="91cb6-248">It then gives feedback to the end user regarding the allowed drop effects.</span></span> <span data-ttu-id="91cb6-249">A questo scopo il cursore del mouse viene in genere sostituito con un cursore di non rilascio, di copia o di spostamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-249">This is typically done by changing the mouse cursor to a no-drop, copy, or move cursor.</span></span> <span data-ttu-id="91cb6-250">Si dovrebbe gestire questo evento solo se è necessario usare cursori personalizzati per fornire feedback all'utente.</span><span class="sxs-lookup"><span data-stu-id="91cb6-250">You should only handle this event if you need to use custom cursors to provide feedback to the user.</span></span> <span data-ttu-id="91cb6-251">Se si gestisce questo evento, assicurarsi di contrassegnarlo come gestito in modo che il gestore predefinito non esegua l'override del gestore.</span><span class="sxs-lookup"><span data-stu-id="91cb6-251">If you handle this event, be sure to mark it as handled so that the default handler does not override your handler.</span></span>  
  
 <span data-ttu-id="91cb6-252">L'evento <xref:System.Windows.DragDrop.QueryContinueDrag> viene generato continuamente mentre l'origine di trascinamento viene trascinata.</span><span class="sxs-lookup"><span data-stu-id="91cb6-252">The <xref:System.Windows.DragDrop.QueryContinueDrag> event is raised continuously while the drag source is being dragged.</span></span> <span data-ttu-id="91cb6-253">È possibile gestire questo evento per determinare quale azione termina l'operazione di trascinamento e rilascio in base allo stato dei tasti ESC, MAIUSC, CTRL e ALT, oltre che allo stato dei pulsanti del mouse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-253">You can handle this event to determine what action ends the drag-and-drop operation based on the state of the ESC, SHIFT, CTRL, and ALT keys, as well as the state of the mouse buttons.</span></span> <span data-ttu-id="91cb6-254">Il gestore predefinito per questo evento annulla l'operazione di trascinamento della selezione se viene premuto ESC e rilascia i dati se il pulsante del mouse viene rilasciato.</span><span class="sxs-lookup"><span data-stu-id="91cb6-254">The default handler for this event cancels the drag-and-drop operation if the ESC key is pressed, and drops the data if the mouse button is released.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="91cb6-255">Questi eventi vengono generati continuamente durante l'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-255">These events are raised continuously during the drag-and-drop operation.</span></span> <span data-ttu-id="91cb6-256">È quindi consigliabile evitare attività a elevato utilizzo di risorse nei gestori eventi.</span><span class="sxs-lookup"><span data-stu-id="91cb6-256">Therefore, you should avoid resource-intensive tasks in the event handlers.</span></span>  <span data-ttu-id="91cb6-257">Ad esempio, usare un cursore nella cache invece di creare un nuovo cursore ogni volta che viene generato l'evento <xref:System.Windows.DragDrop.GiveFeedback>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-257">For example, use a cached cursor instead of creating a new cursor each time the <xref:System.Windows.DragDrop.GiveFeedback> event is raised.</span></span>  
  
### <a name="enabling-an-element-to-be-a-drop-target"></a><span data-ttu-id="91cb6-258">Impostazione di un elemento come obiettivo di rilascio</span><span class="sxs-lookup"><span data-stu-id="91cb6-258">Enabling an Element to be a Drop Target</span></span>  
 <span data-ttu-id="91cb6-259">Un oggetto che è un obiettivo di rilascio è responsabile di:</span><span class="sxs-lookup"><span data-stu-id="91cb6-259">An object that is a drop target is responsible for:</span></span>  
  
- <span data-ttu-id="91cb6-260">Specificare che è un obiettivo di rilascio valido.</span><span class="sxs-lookup"><span data-stu-id="91cb6-260">Specifying that it is a valid drop target.</span></span>  
  
- <span data-ttu-id="91cb6-261">Rispondere all'origine di trascinamento quando viene trascinata sulla destinazione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-261">Responding to the drag source when it drags over the target.</span></span>  
  
- <span data-ttu-id="91cb6-262">Controllare che i dati trasferiti siano in un formato che può ricevere.</span><span class="sxs-lookup"><span data-stu-id="91cb6-262">Checking that the transferred data is in a format that it can receive.</span></span>  
  
- <span data-ttu-id="91cb6-263">Elaborare i dati rilasciati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-263">Processing the dropped data.</span></span>  
  
 <span data-ttu-id="91cb6-264">Per specificare che un elemento è un obiettivo di rilascio, si imposta la proprietà <xref:System.Windows.UIElement.AllowDrop%2A> su `true`.</span><span class="sxs-lookup"><span data-stu-id="91cb6-264">To specify that an element is a drop target, you set its <xref:System.Windows.UIElement.AllowDrop%2A> property to `true`.</span></span> <span data-ttu-id="91cb6-265">Gli eventi dell'obiettivo di rilascio verranno quindi generati nell'elemento per poterli gestire.</span><span class="sxs-lookup"><span data-stu-id="91cb6-265">The drop target events will then be raised on the element so that you can handle them.</span></span> <span data-ttu-id="91cb6-266">Durante un'operazione di trascinamento della selezione, nell'obiettivo di rilascio si verifica la sequenza di eventi seguente:</span><span class="sxs-lookup"><span data-stu-id="91cb6-266">During a drag-and-drop operation, the following sequence of events occurs on the drop target:</span></span>  
  
1. <xref:System.Windows.DragDrop.DragEnter>  
  
2. <xref:System.Windows.DragDrop.DragOver>  
  
3. <span data-ttu-id="91cb6-267"><xref:System.Windows.DragDrop.DragLeave> o <xref:System.Windows.DragDrop.Drop></span><span class="sxs-lookup"><span data-stu-id="91cb6-267"><xref:System.Windows.DragDrop.DragLeave> or <xref:System.Windows.DragDrop.Drop></span></span>  
  
 <span data-ttu-id="91cb6-268">L'evento <xref:System.Windows.DragDrop.DragEnter> si verifica quando i dati vengono trascinati entro il limite dell'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-268">The <xref:System.Windows.DragDrop.DragEnter> event occurs when the data is dragged into the drop target's boundary.</span></span> <span data-ttu-id="91cb6-269">In genere si gestisce questo evento per fornire un'anteprima degli effetti dell'operazione di trascinamento e rilascio, se appropriato per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-269">You typically handle this event to provide a preview of the effects of the drag-and-drop operation, if appropriate for your application.</span></span> <span data-ttu-id="91cb6-270">Non impostare la proprietà <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> nell'evento <xref:System.Windows.DragDrop.DragEnter>, perché verrà sovrascritta nell'evento <xref:System.Windows.DragDrop.DragOver>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-270">Do not set the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property in the <xref:System.Windows.DragDrop.DragEnter> event, as it will be overwritten in the <xref:System.Windows.DragDrop.DragOver> event.</span></span>  
  
 <span data-ttu-id="91cb6-271">Il seguente esempio mostra il gestore dell'evento <xref:System.Windows.DragDrop.DragEnter> per un elemento <xref:System.Windows.Shapes.Ellipse>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-271">The following example shows the <xref:System.Windows.DragDrop.DragEnter> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="91cb6-272">Questo codice visualizza in anteprima gli effetti dell'operazione di trascinamento della selezione salvando il pennello <xref:System.Windows.Shapes.Shape.Fill%2A> corrente.</span><span class="sxs-lookup"><span data-stu-id="91cb6-272">This code previews the effects of the drag-and-drop operation by saving the current <xref:System.Windows.Shapes.Shape.Fill%2A> brush.</span></span> <span data-ttu-id="91cb6-273">Usa quindi il metodo <xref:System.Windows.DataObject.GetDataPresent%2A> per controllare se il <xref:System.Windows.DataObject> che viene trascinato sull'ellisse contiene dati stringa convertibili in un <xref:System.Windows.Media.Brush>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-273">It then uses the <xref:System.Windows.DataObject.GetDataPresent%2A> method to check whether the <xref:System.Windows.DataObject> being dragged over the ellipse contains string data that can be converted to a <xref:System.Windows.Media.Brush>.</span></span> <span data-ttu-id="91cb6-274">In tal caso, i dati vengono estratti con il metodo <xref:System.Windows.DataObject.GetData%2A>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-274">If so, the data is extracted using the <xref:System.Windows.DataObject.GetData%2A> method.</span></span> <span data-ttu-id="91cb6-275">Vengono quindi convertiti in un <xref:System.Windows.Media.Brush> e applicati all'ellisse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-275">It is then converted to a <xref:System.Windows.Media.Brush> and applied to the ellipse.</span></span> <span data-ttu-id="91cb6-276">La modifica viene ripristinata nel gestore dell'evento <xref:System.Windows.DragDrop.DragLeave>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-276">The change is reverted in the <xref:System.Windows.DragDrop.DragLeave> event handler.</span></span> <span data-ttu-id="91cb6-277">Se i dati non possono essere convertiti in un <xref:System.Windows.Media.Brush>, non viene eseguita alcuna azione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-277">If the data cannot be converted to a <xref:System.Windows.Media.Brush>, no action is performed.</span></span>  
  
 [!code-csharp[DragDropSnippets#DragEnter](~/samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dragenter)]
 [!code-vb[DragDropSnippets#DragEnter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dragenter)]  
  
 <span data-ttu-id="91cb6-278">L'evento <xref:System.Windows.DragDrop.DragOver> si verifica in modo continuo mentre i dati vengono trascinati sull'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="91cb6-278">The <xref:System.Windows.DragDrop.DragOver> event occurs continuously while the data is dragged over the drop target.</span></span> <span data-ttu-id="91cb6-279">Questo evento è associato all'evento <xref:System.Windows.DragDrop.GiveFeedback> nell'origine di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-279">This event is paired with the <xref:System.Windows.DragDrop.GiveFeedback> event on the drag source.</span></span> <span data-ttu-id="91cb6-280">Nel gestore dell'evento <xref:System.Windows.DragDrop.DragOver>, si usano di solito i metodi <xref:System.Windows.DataObject.GetDataPresent%2A> e <xref:System.Windows.DataObject.GetData%2A> per controllare se i dati trasferiti sono in un formato che l'obiettivo di rilascio può elaborare.</span><span class="sxs-lookup"><span data-stu-id="91cb6-280">In the <xref:System.Windows.DragDrop.DragOver> event handler, you typically use the <xref:System.Windows.DataObject.GetDataPresent%2A> and <xref:System.Windows.DataObject.GetData%2A> methods to check whether the transferred data is in a format that the drop target can process.</span></span> <span data-ttu-id="91cb6-281">È anche possibile controllare se vengono premuti tasti di modifica, che in genere indicano se l'utente intende eseguire un'azione di copia o spostamento.</span><span class="sxs-lookup"><span data-stu-id="91cb6-281">You can also check whether any modifier keys are pressed, which will typically indicate whether the user intends a move or copy action.</span></span> <span data-ttu-id="91cb6-282">Dopo questi controlli, si imposta la proprietà <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> per notificare all'origine di trascinamento quale effetto avrà il rilascio dei dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-282">After these checks are performed, you set the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property to notify the drag source what effect dropping the data will have.</span></span> <span data-ttu-id="91cb6-283">L'origine di trascinamento riceve queste informazioni negli argomenti dell'evento <xref:System.Windows.DragDrop.GiveFeedback> e può impostare un cursore appropriato per fornire feedback all'utente.</span><span class="sxs-lookup"><span data-stu-id="91cb6-283">The drag source receives this information in the <xref:System.Windows.DragDrop.GiveFeedback> event args, and can set an appropriate cursor to give feedback to the user.</span></span>  
  
 <span data-ttu-id="91cb6-284">Il seguente esempio mostra il gestore dell'evento <xref:System.Windows.DragDrop.DragOver> per un elemento <xref:System.Windows.Shapes.Ellipse>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-284">The following example shows the <xref:System.Windows.DragDrop.DragOver> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="91cb6-285">Questo codice verifica se il <xref:System.Windows.DataObject> che viene trascinato sull'ellisse contiene dati stringa convertibili in un <xref:System.Windows.Media.Brush>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-285">This code checks to see if the <xref:System.Windows.DataObject> being dragged over the ellipse contains string data that can be converted to a <xref:System.Windows.Media.Brush>.</span></span> <span data-ttu-id="91cb6-286">In tal caso, imposta la proprietà <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> su <xref:System.Windows.DragDropEffects.Copy>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-286">If so, it sets the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property to <xref:System.Windows.DragDropEffects.Copy>.</span></span> <span data-ttu-id="91cb6-287">Questo indica all'origine di trascinamento che i dati possono essere copiati nell'ellisse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-287">This indicates to the drag source that the data can be copied to the ellipse.</span></span> <span data-ttu-id="91cb6-288">Se i dati non possono essere convertiti in un <xref:System.Windows.Media.Brush>, la proprietà <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> viene impostata su <xref:System.Windows.DragDropEffects.None>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-288">If the data cannot be converted to a <xref:System.Windows.Media.Brush>, the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property is set to <xref:System.Windows.DragDropEffects.None>.</span></span> <span data-ttu-id="91cb6-289">Questo indica all'origine di trascinamento che l'ellisse non è un obiettivo di rilascio valido per i dati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-289">This indicates to the drag source that the ellipse is not a valid drop target for the data.</span></span>  
  
 [!code-csharp[DragDropSnippets#DragOver](~/samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dragover)]
 [!code-vb[DragDropSnippets#DragOver](~/samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dragover)]  
  
 <span data-ttu-id="91cb6-290">L'evento <xref:System.Windows.DragDrop.DragLeave> si verifica quando i dati vengono trascinati all'esterno del limite della destinazione senza essere rilasciati.</span><span class="sxs-lookup"><span data-stu-id="91cb6-290">The <xref:System.Windows.DragDrop.DragLeave> event occurs when the data is dragged out of the target's boundary without being dropped.</span></span> <span data-ttu-id="91cb6-291">Si gestisce questo evento per annullare qualsiasi operazione eseguita nel gestore dell'evento <xref:System.Windows.DragDrop.DragEnter>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-291">You handle this event to undo anything that you did in the <xref:System.Windows.DragDrop.DragEnter> event handler.</span></span>  
  
 <span data-ttu-id="91cb6-292">Il seguente esempio mostra il gestore dell'evento <xref:System.Windows.DragDrop.DragLeave> per un elemento <xref:System.Windows.Shapes.Ellipse>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-292">The following example shows the <xref:System.Windows.DragDrop.DragLeave> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="91cb6-293">Questo codice annulla l'anteprima eseguita nel gestore dell'evento <xref:System.Windows.DragDrop.DragEnter> applicando l'oggetto <xref:System.Windows.Media.Brush> salvato all'ellisse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-293">This code undoes the preview performed in the <xref:System.Windows.DragDrop.DragEnter> event handler by applying the saved <xref:System.Windows.Media.Brush> to the ellipse.</span></span>  
  
 [!code-csharp[DragDropSnippets#DragLeave](~/samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dragleave)]
 [!code-vb[DragDropSnippets#DragLeave](~/samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dragleave)]  
  
 <span data-ttu-id="91cb6-294">L'evento <xref:System.Windows.DragDrop.Drop> si verifica quando i dati vengono rilasciati sull'obiettivo di rilascio. Per impostazione predefinita, questo avviene quando viene rilasciato il pulsante del mouse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-294">The <xref:System.Windows.DragDrop.Drop> event occurs when the data is dropped over the drop target; by default, this happens when the mouse button is released.</span></span> <span data-ttu-id="91cb6-295">Nel gestore dell'evento <xref:System.Windows.DragDrop.Drop>, si usa il metodo <xref:System.Windows.DataObject.GetData%2A> per estrarre i dati trasferiti dal <xref:System.Windows.DataObject> ed eseguire l'elaborazione dati richiesta dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-295">In the <xref:System.Windows.DragDrop.Drop> event handler, you use the <xref:System.Windows.DataObject.GetData%2A> method to extract the transferred data from the <xref:System.Windows.DataObject> and perform any data processing that your application requires.</span></span> <span data-ttu-id="91cb6-296">L'evento <xref:System.Windows.DragDrop.Drop> termina l'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-296">The <xref:System.Windows.DragDrop.Drop> event ends the drag-and-drop operation.</span></span>  
  
 <span data-ttu-id="91cb6-297">Il seguente esempio mostra il gestore dell'evento <xref:System.Windows.DragDrop.Drop> per un elemento <xref:System.Windows.Shapes.Ellipse>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-297">The following example shows the <xref:System.Windows.DragDrop.Drop> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="91cb6-298">Questo codice applica gli effetti dell'operazione di trascinamento della selezione ed è simile al codice nel gestore dell'evento <xref:System.Windows.DragDrop.DragEnter>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-298">This code applies the effects of the drag-and-drop operation, and is similar to the code in the <xref:System.Windows.DragDrop.DragEnter> event handler.</span></span> <span data-ttu-id="91cb6-299">Verifica se il <xref:System.Windows.DataObject> che viene trascinato sull'ellisse contiene dati stringa convertibili in un <xref:System.Windows.Media.Brush>.</span><span class="sxs-lookup"><span data-stu-id="91cb6-299">It checks to see if the <xref:System.Windows.DataObject> being dragged over the ellipse contains string data that can be converted to a <xref:System.Windows.Media.Brush>.</span></span> <span data-ttu-id="91cb6-300">In tal caso, <xref:System.Windows.Media.Brush> viene applicato all'ellisse.</span><span class="sxs-lookup"><span data-stu-id="91cb6-300">If so, the <xref:System.Windows.Media.Brush> is applied to the ellipse.</span></span> <span data-ttu-id="91cb6-301">Se i dati non possono essere convertiti in un <xref:System.Windows.Media.Brush>, non viene eseguita alcuna azione.</span><span class="sxs-lookup"><span data-stu-id="91cb6-301">If the data cannot be converted to a <xref:System.Windows.Media.Brush>, no action is performed.</span></span>  
  
 [!code-csharp[DragDropSnippets#Drop](~/samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#drop)]
 [!code-vb[DragDropSnippets#Drop](~/samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#drop)]  
  
## <a name="see-also"></a><span data-ttu-id="91cb6-302">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="91cb6-302">See also</span></span>

- <xref:System.Windows.Clipboard>
- [<span data-ttu-id="91cb6-303">Procedura dettagliata: abilitare il trascinamento della selezione in un controllo utente</span><span class="sxs-lookup"><span data-stu-id="91cb6-303">Walkthrough: Enabling Drag and Drop on a User Control</span></span>](walkthrough-enabling-drag-and-drop-on-a-user-control.md)
- [<span data-ttu-id="91cb6-304">Argomenti relativi alle procedure</span><span class="sxs-lookup"><span data-stu-id="91cb6-304">How-to Topics</span></span>](drag-and-drop-how-to-topics.md)
- [<span data-ttu-id="91cb6-305">Trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="91cb6-305">Drag and Drop</span></span>](drag-and-drop.md)
