---
title: Definizione e specifica degli errori
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- handling faults [WCF], specifying
- handling faults [WCF], defining
ms.assetid: c00c84f1-962d-46a7-b07f-ebc4f80fbfc1
ms.openlocfilehash: 10fc045cab995cca8d78e470d74ec9341e167308
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79176695"
---
# <a name="defining-and-specifying-faults"></a><span data-ttu-id="b6aa8-102">Definizione e specifica degli errori</span><span class="sxs-lookup"><span data-stu-id="b6aa8-102">Defining and Specifying Faults</span></span>
<span data-ttu-id="b6aa8-103">Gli errori SOAP forniscono informazioni sulla condizione di errore da un servizio a un client e, nel caso duplex, da un client a un servizio in modo interoperativo.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-103">SOAP faults convey error condition information from a service to a client and, in the duplex case, from a client to a service in an interoperable way.</span></span> <span data-ttu-id="b6aa8-104">In questo argomento viene illustrato quando e come definire il contenuto di un errore personalizzato e specificare quali operazioni possono restituire tale contenuto.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-104">This topic discusses when and how to define custom fault content and specify which operations can return them.</span></span> <span data-ttu-id="b6aa8-105">Per ulteriori informazioni su come un servizio, o client duplex, può inviare tali errori e come un client o un'applicazione di servizio gestisce questi errori, vedere [Invio e ricezione di errori](sending-and-receiving-faults.md).</span><span class="sxs-lookup"><span data-stu-id="b6aa8-105">For more information about how a service, or duplex client, can send those faults and how a client or service application handles these faults, see [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span> <span data-ttu-id="b6aa8-106">Per una panoramica della gestione degli errori nelle applicazioni Windows Communication Foundation (WCF), vedere [Specifica e gestione degli errori in contratti e servizi](specifying-and-handling-faults-in-contracts-and-services.md).</span><span class="sxs-lookup"><span data-stu-id="b6aa8-106">For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](specifying-and-handling-faults-in-contracts-and-services.md).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="b6aa8-107">Panoramica</span><span class="sxs-lookup"><span data-stu-id="b6aa8-107">Overview</span></span>  
 <span data-ttu-id="b6aa8-108">Gli errori SOAP dichiarati sono quelli in cui un'operazione presenta un <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> che specifica un tipo di errore SOAP personalizzato.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-108">Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type.</span></span> <span data-ttu-id="b6aa8-109">Gli errori SOAP non dichiarati sono quelli che non vengono specificati nel contratto per un'operazione.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-109">Undeclared SOAP faults are those that are not specified in the contract for an operation.</span></span> <span data-ttu-id="b6aa8-110">In questo argomento viene illustrato come identificare tali condizioni di errore e creare un contratto di errore per il servizio che i client possono usare per gestire correttamente tali condizioni di errore quando vengono segnalate dagli errori SOAP personalizzati.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-110">This topic helps you identify those error conditions and create a fault contract for your service that clients can use to properly handle those error conditions when notified by custom SOAP faults.</span></span> <span data-ttu-id="b6aa8-111">Le attività di base sono descritte di seguito, in ordine progressivo:</span><span class="sxs-lookup"><span data-stu-id="b6aa8-111">The basic tasks are, in order:</span></span>  
  
1. <span data-ttu-id="b6aa8-112">Definire le condizioni di errore che un client del servizio deve conoscere.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-112">Define the error conditions that a client of your service should know about.</span></span>  
  
2. <span data-ttu-id="b6aa8-113">Definire il contenuto personalizzato degli errori SOAP per tali condizioni di errore.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-113">Define the custom content of the SOAP faults for those error conditions.</span></span>  
  
3. <span data-ttu-id="b6aa8-114">Contrassegnare le operazioni in modo che gli specifici errori SOAP generati vengano esposti ai client in WSDL.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-114">Mark your operations so that the specific SOAP faults that they throw are exposed to clients in WSDL.</span></span>  
  
### <a name="defining-error-conditions-that-clients-should-know-about"></a><span data-ttu-id="b6aa8-115">Definizione delle condizioni di errore che i client devono conoscere</span><span class="sxs-lookup"><span data-stu-id="b6aa8-115">Defining Error Conditions That Clients Should Know About</span></span>  
 <span data-ttu-id="b6aa8-116">Gli errori SOAP sono messaggi descritti pubblicamente che contengono informazioni sugli errori per una particolare operazione.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-116">SOAP faults are publicly described messages that carry fault information for a particular operation.</span></span> <span data-ttu-id="b6aa8-117">Poiché vengono descritti insieme ad altri messaggi dell'operazione in WSDL, i client sono al corrente di tali errori e, pertanto, sono pronti a gestirli quando richiamano un'operazione.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-117">Because they are described along with other operation messages in WSDL, clients know and, therefore, expect to handle such faults when invoking an operation.</span></span> <span data-ttu-id="b6aa8-118">Tuttavia, poiché i servizi WCF vengono scritti in codice gestito, decidere quali condizioni di errore nel codice gestito devono essere convertite in errori e restituite al client offre l'opportunità di separare le condizioni di errore e i bug nel servizio dall'errore formale conversazione che hai con un cliente.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-118">But because WCF services are written in managed code, deciding which error conditions in managed code are to be converted into faults and returned to the client provides you the opportunity to separate error conditions and bugs in your service from the formal error conversation you have with a client.</span></span>  
  
 <span data-ttu-id="b6aa8-119">Ad esempio, nell'esempio di codice seguente è mostrata un'operazione che accetta due numeri interi e restituisce un altro numero intero.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-119">For example, the following code example shows an operation that takes two integers and returns another integer.</span></span> <span data-ttu-id="b6aa8-120">In questo caso possono essere generate molte eccezioni, pertanto quando si progetta il contratto di errori, è necessario determinare quali condizioni di errore sono importanti per il client.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-120">Several exceptions can be thrown here, so when designing the fault contract, you must determine which error conditions are important for your client.</span></span> <span data-ttu-id="b6aa8-121">In questo caso, il servizio deve rilevare l'eccezione <xref:System.DivideByZeroException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-121">In this case, the service should detect the <xref:System.DivideByZeroException?displayProperty=nameWithType> exception.</span></span>  
  
```csharp  
[ServiceContract]  
public class CalculatorService  
{  
    [OperationContract]
    int Divide(int a, int b)  
    {  
      if (b==0) throw new Exception("Division by zero!");  
      return a/b;  
    }  
}  
```  
  
```vb
<ServiceContract> _
Public Class CalculatorService
    <OperationContract> _
    Public Function Divide(a As Integer, b As Integer) As Integer
        If b = 0 Then Throw New DivideByZeroException("Division by zero!")
        Return a / b
    End Function
End Class
```
  
 <span data-ttu-id="b6aa8-122">Nell'esempio precedente l'operazione può restituire un errore SOAP personalizzato che sia specifico della divisione per zero, un errore personalizzato che sia specifico per le operazioni di matematica ma contenga informazioni specifiche per la divisione per zero, più errori per diverse situazioni di errore o nessun errore SOAP.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-122">In the preceding example the operation can either return a custom SOAP fault that is specific to dividing by zero, a custom fault that is specific to math operations but that contains information specific to dividing by zero, multiple faults for several different error situations, or no SOAP fault at all.</span></span>  
  
### <a name="define-the-content-of-error-conditions"></a><span data-ttu-id="b6aa8-123">Definire il contenuto delle condizioni di errore</span><span class="sxs-lookup"><span data-stu-id="b6aa8-123">Define the Content of Error Conditions</span></span>  
 <span data-ttu-id="b6aa8-124">Dopo aver identificato una condizione di errore adatta per restituire un errore SOAP personalizzato, il passaggio successivo consiste nel definire il contenuto di tale errore e verificare che la struttura del contenuto possa essere serializzata.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-124">Once an error condition has been identified as one that can usefully return a custom SOAP fault, the next step is to define the contents of that fault and ensure that the content structure can be serialized.</span></span> <span data-ttu-id="b6aa8-125">L'esempio di codice nella sezione precedente mostra un errore specifico per un'operazione `Divide`. Tuttavia se nel servizio `Calculator` sono presenti altre operazioni, un solo errore SOAP personalizzato può informare il client di tutte le condizioni di errore della calcolatrice, inclusa l'operazione `Divide`.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-125">The code example in the preceding section shows an error specific to a `Divide` operation, but if there are other operations on the `Calculator` service, then a single custom SOAP fault can inform the client of all calculator error conditions, `Divide` included.</span></span> <span data-ttu-id="b6aa8-126">Nell'esempio di codice seguente viene illustrata la creazione di un errore SOAP personalizzato, `MathFault`, che può segnalare gli errori generati usando tutte le operazioni di matematica, inclusa l'operazione `Divide`.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-126">The following code example shows the creation of a custom SOAP fault, `MathFault`, which can report errors made using all math operations, including `Divide`.</span></span> <span data-ttu-id="b6aa8-127">Mentre la classe può specificare un'operazione (la proprietà `Operation` ) e un valore che descrivono il problema (la proprietà `ProblemType` ), è necessario che la classe e queste proprietà siano serializzabili per essere trasferite al client in un errore SOAP personalizzato.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-127">While the class can specify an operation (the `Operation` property) and a value that describes the problem (the `ProblemType` property), the class and these properties must be serializable to be transferred to the client in a custom SOAP fault.</span></span> <span data-ttu-id="b6aa8-128">Pertanto, gli attributi <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> e <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> vengono usati per rendere il tipo e le relative proprietà serializzabili e interoperativi.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-128">Therefore, the <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> and <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> attributes are used to make the type and its properties serializable and as interoperable as possible.</span></span>  
  
 [!code-csharp[Faults#2](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#2)]
 [!code-vb[Faults#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#2)]  
  
 <span data-ttu-id="b6aa8-129">Per ulteriori informazioni su come garantire la serializzazione dei dati, vedere [Specifica del trasferimento dati nei contratti](./feature-details/specifying-data-transfer-in-service-contracts.md)di assistenza .</span><span class="sxs-lookup"><span data-stu-id="b6aa8-129">For more information about how to ensure your data is serializable, see [Specifying Data Transfer in Service Contracts](./feature-details/specifying-data-transfer-in-service-contracts.md).</span></span> <span data-ttu-id="b6aa8-130">Per un elenco del <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> supporto della serializzazione fornito, vedere [Tipi supportati dal serializzatore del contratto dati](./feature-details/types-supported-by-the-data-contract-serializer.md).</span><span class="sxs-lookup"><span data-stu-id="b6aa8-130">For a list of the serialization support that <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> provides, see [Types Supported by the Data Contract Serializer](./feature-details/types-supported-by-the-data-contract-serializer.md).</span></span>  
  
### <a name="mark-operations-to-establish-the-fault-contract"></a><span data-ttu-id="b6aa8-131">Contrassegnare le operazioni per stabilire il contratto di errore</span><span class="sxs-lookup"><span data-stu-id="b6aa8-131">Mark Operations to Establish the Fault Contract</span></span>  
 <span data-ttu-id="b6aa8-132">Dopo aver definito una struttura di dati serializzabile che viene restituita come parte di un errore SOAP personalizzato, l'ultimo passaggio consiste nel contrassegnare il contratto dell'operazione per indicare che genera un errore SOAP di quel tipo.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-132">Once a serializable data structure that is returned as part of a custom SOAP fault is defined, the last step is to mark your operation contract as throwing a SOAP fault of that type.</span></span> <span data-ttu-id="b6aa8-133">Per questo scopo, usare l'attributo <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> e passare il tipo di dati personalizzato costruito.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-133">To do this, use the <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> attribute and pass the type of the custom data type that you have constructed.</span></span> <span data-ttu-id="b6aa8-134">Nell'esempio di codice seguente viene illustrato come usare l'attributo <xref:System.ServiceModel.FaultContractAttribute> per specificare che l'operazione `Divide` può restituire un errore SOAP di tipo `MathFault`.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-134">The following code example shows how to use the <xref:System.ServiceModel.FaultContractAttribute> attribute to specify that the `Divide` operation can return a SOAP fault of type `MathFault`.</span></span> <span data-ttu-id="b6aa8-135">In questo modo anche le altre operazioni matematiche possono specificare che restituiscono un `MathFault`.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-135">Other math-based operations can now also specify that they can return a `MathFault`.</span></span>  
  
 [!code-csharp[Faults#1](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#1)]
 [!code-vb[Faults#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#1)]  
  
 <span data-ttu-id="b6aa8-136">È possibile specificare che un'operazione restituisce più di un errore personalizzato contrassegnando tale operazione con più attributi <xref:System.ServiceModel.FaultContractAttribute>.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-136">An operation can specify that it returns more than one custom fault by marking that operation with more than one <xref:System.ServiceModel.FaultContractAttribute> attribute.</span></span>  
  
 <span data-ttu-id="b6aa8-137">Il passaggio successivo, per implementare il contratto di errore nell'implementazione dell'operazione, è descritto nell'argomento [Invio e ricezione di errori](sending-and-receiving-faults.md).</span><span class="sxs-lookup"><span data-stu-id="b6aa8-137">The next step, to implement the fault contract in your operation implementation, is described in the topic [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span>  
  
#### <a name="soap-wsdl-and-interoperability-considerations"></a><span data-ttu-id="b6aa8-138">Considerazioni su SOAP, WSDL e sull'interoperabilità</span><span class="sxs-lookup"><span data-stu-id="b6aa8-138">SOAP, WSDL, and Interoperability Considerations</span></span>  
 <span data-ttu-id="b6aa8-139">In alcune circostanze, specialmente quando si interagisce con altre piattaforme, può essere importante controllare il modo in cui un errore viene visualizzato in un messaggio SOAP o il modo in cui viene descritto nei metadati WSDL.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-139">In some circumstances, especially when interoperating with other platforms, it may be important to control the way a fault appears in a SOAP message or the way it is described in the WSDL metadata.</span></span>  
  
 <span data-ttu-id="b6aa8-140">L'attributo <xref:System.ServiceModel.FaultContractAttribute> dispone della proprietà <xref:System.ServiceModel.FaultContractAttribute.Name%2A> che consente di controllare il nome dell'elemento di errore WSDL generato nei metadati per tale errore.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-140">The <xref:System.ServiceModel.FaultContractAttribute> attribute has a <xref:System.ServiceModel.FaultContractAttribute.Name%2A> property that allows control of the WSDL fault element name that is generated in the metadata for that fault.</span></span>  
  
 <span data-ttu-id="b6aa8-141">In base allo standard SOAP, a un errore può essere associato un elemento `Action`, un elemento `Code` e un elemento `Reason`.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-141">According to the SOAP standard, a fault can have an `Action`, a `Code`, and a `Reason`.</span></span> <span data-ttu-id="b6aa8-142">L'elemento `Action` è controllato dalla proprietà <xref:System.ServiceModel.FaultContractAttribute.Action%2A>.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-142">The `Action` is controlled by the <xref:System.ServiceModel.FaultContractAttribute.Action%2A> property.</span></span> <span data-ttu-id="b6aa8-143">Le proprietà <xref:System.ServiceModel.FaultException.Code%2A> e <xref:System.ServiceModel.FaultException.Reason%2A> fanno entrambe parte della classe <xref:System.ServiceModel.FaultException?displayProperty=nameWithType>, che costituisce la classe padre dell'eccezione generica <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-143">The <xref:System.ServiceModel.FaultException.Code%2A> property and <xref:System.ServiceModel.FaultException.Reason%2A> property are both properties of the <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> class, which is the parent class of the generic <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="b6aa8-144">La proprietà `Code` include un membro <xref:System.ServiceModel.FaultCode.SubCode%2A>.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-144">The `Code` property includes a <xref:System.ServiceModel.FaultCode.SubCode%2A> member.</span></span>  
  
 <span data-ttu-id="b6aa8-145">Quando si accede a componenti non del servizio che generano errori, sono presenti alcune limitazioni.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-145">When accessing non-services that generate faults, certain limitations exist.</span></span> <span data-ttu-id="b6aa8-146">WCF supporta solo gli errori con i tipi di dettaglio descritti dallo schema e compatibili con i contratti dati.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-146">WCF supports only faults with detail types that the schema describes and that are compatible with data contracts.</span></span> <span data-ttu-id="b6aa8-147">Ad esempio, come accennato in precedenza, WCF non supporta gli errori che utilizzano gli attributi XML nei relativi tipi di dettaglio o gli errori con più di un elemento di primo livello nella sezione dettaglio.</span><span class="sxs-lookup"><span data-stu-id="b6aa8-147">For example, as mentioned above, WCF does not support faults that use XML attributes in their detail types, or faults with more than one top-level element in the detail section.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b6aa8-148">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="b6aa8-148">See also</span></span>

- <xref:System.ServiceModel.FaultContractAttribute>
- <xref:System.Runtime.Serialization.DataContractAttribute>
- <xref:System.Runtime.Serialization.DataMemberAttribute>
- [<span data-ttu-id="b6aa8-149">Specifica e gestione degli errori in contratti e servizi</span><span class="sxs-lookup"><span data-stu-id="b6aa8-149">Specifying and Handling Faults in Contracts and Services</span></span>](specifying-and-handling-faults-in-contracts-and-services.md)
- [<span data-ttu-id="b6aa8-150">Invio e ricezione degli errori</span><span class="sxs-lookup"><span data-stu-id="b6aa8-150">Sending and Receiving Faults</span></span>](sending-and-receiving-faults.md)
- [<span data-ttu-id="b6aa8-151">Procedura: Dichiarare errori nei contratti di servizio</span><span class="sxs-lookup"><span data-stu-id="b6aa8-151">How to: Declare Faults in Service Contracts</span></span>](how-to-declare-faults-in-service-contracts.md)
- [<span data-ttu-id="b6aa8-152">Informazioni sul livello di protezione</span><span class="sxs-lookup"><span data-stu-id="b6aa8-152">Understanding Protection Level</span></span>](understanding-protection-level.md)
- [<span data-ttu-id="b6aa8-153">Procedura: Impostare la proprietà ProtectionLevel</span><span class="sxs-lookup"><span data-stu-id="b6aa8-153">How to: Set the ProtectionLevel Property</span></span>](how-to-set-the-protectionlevel-property.md)
- [<span data-ttu-id="b6aa8-154">Specifying Data Transfer in Service Contracts</span><span class="sxs-lookup"><span data-stu-id="b6aa8-154">Specifying Data Transfer in Service Contracts</span></span>](./feature-details/specifying-data-transfer-in-service-contracts.md)
