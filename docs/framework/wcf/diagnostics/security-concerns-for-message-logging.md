---
title: Problemi di sicurezza per la registrazione dei messaggi
ms.date: 03/30/2017
ms.assetid: 21f513f2-815b-47f3-85a6-03c008510038
ms.openlocfilehash: bb1a6ab84ceba27b398d397b4407a55aa02c4cae
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79185767"
---
# <a name="security-concerns-for-message-logging"></a><span data-ttu-id="89575-102">Problemi di sicurezza per la registrazione dei messaggi</span><span class="sxs-lookup"><span data-stu-id="89575-102">Security Concerns for Message Logging</span></span>
<span data-ttu-id="89575-103">In questo argomento viene illustrato come evitare che i dati riservati vengano esposti nei log dei messaggi e come proteggere gli eventi generati dalla registrazione dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="89575-103">This topic describes how you can protect sensitive data from being exposed in message logs, as well as events generated by message logging.</span></span>  
  
## <a name="security-concerns"></a><span data-ttu-id="89575-104">Problemi di sicurezza</span><span class="sxs-lookup"><span data-stu-id="89575-104">Security Concerns</span></span>  
  
### <a name="logging-sensitive-information"></a><span data-ttu-id="89575-105">Registrazione di informazioni riservate</span><span class="sxs-lookup"><span data-stu-id="89575-105">Logging Sensitive Information</span></span>  
 <span data-ttu-id="89575-106">Windows Communication Foundation (WCF) non modifica i dati nelle intestazioni e nel corpo specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="89575-106">Windows Communication Foundation (WCF) does not modify any data in application-specific headers and body.</span></span> <span data-ttu-id="89575-107">WCF inoltre non tiene traccia delle informazioni personali nelle intestazioni specifiche dell'applicazione o nei dati del corpo.</span><span class="sxs-lookup"><span data-stu-id="89575-107">WCF also does not track personal information in application-specific headers or body data.</span></span>  
  
 <span data-ttu-id="89575-108">Quando la registrazione dei messaggi è abilitata, le informazioni personali contenute nelle intestazioni specifiche dell'applicazione, ad esempio una stringa di query, e le informazioni contenute nel corpo, ad esempio un numero di carta di credito, possono divenire visibili nei log.</span><span class="sxs-lookup"><span data-stu-id="89575-108">When message logging is enabled, personal information in application-specific headers, such as, a query string; and body information, such as, a credit card number, can become visible in the logs.</span></span> <span data-ttu-id="89575-109">Il distributore dell'applicazione è responsabile dell'applicazione del controllo di accesso sui file di log e di configurazione.</span><span class="sxs-lookup"><span data-stu-id="89575-109">The application deployer is responsible for enforcing access control on the configuration and log files.</span></span> <span data-ttu-id="89575-110">Se non si desidera che questo tipo di informazioni sia visibile, è necessario disabilitare la registrazione oppure filtrare parte dei dati se si intende condividere i file registro.</span><span class="sxs-lookup"><span data-stu-id="89575-110">If you do not want this kind of information to be visible, you should disable logging, or filter out part of the data if you want to share the logs.</span></span>  
  
 <span data-ttu-id="89575-111">I suggerimenti seguenti consentono di impedire che il contenuto di un file di log venga esposto per errore:</span><span class="sxs-lookup"><span data-stu-id="89575-111">The following tips can help you to prevent the content of a log file from being exposed unintentionally:</span></span>  
  
- <span data-ttu-id="89575-112">Accertarsi che i file di log siano protetti da elenchi di controllo di accesso (ACL, Access Control Lists) in scenari sia WebHost che indipendenti.</span><span class="sxs-lookup"><span data-stu-id="89575-112">Ensure that the log files are protected by Access Control Lists (ACL) both in Web-host and self-host scenarios.</span></span>  
  
- <span data-ttu-id="89575-113">Scegliere un'estensione di file che non sia troppo facilmente disponibile quando si utilizza una richiesta Web.</span><span class="sxs-lookup"><span data-stu-id="89575-113">Choose a file extension that cannot be easily served using a Web request.</span></span> <span data-ttu-id="89575-114">L'estensione xml, ad esempio, non è una scelta sicura.</span><span class="sxs-lookup"><span data-stu-id="89575-114">For example, the .xml file extension is not a safe choice.</span></span> <span data-ttu-id="89575-115">Per un elenco di estensioni disponibili, consultare il manuale dell'amministratore di Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="89575-115">You can check the Internet Information Services (IIS) administration guide to see a list of extensions that can be served.</span></span>  
  
- <span data-ttu-id="89575-116">Specificare un percorso assoluto per il file di log, che non deve essere contenuto nella directory pubblica della radice virtuale di WebHost, per evitare che venga consultato da un interessato esterno mediante un browser Web.</span><span class="sxs-lookup"><span data-stu-id="89575-116">Specify an absolute path for the log file location, which should be outside of the Web host vroot public directory to prevent it from being accessed by an external party using a Web browser.</span></span>  
  
 <span data-ttu-id="89575-117">Per impostazione predefinita, le chiavi e le informazioni personali, ad esempio nome utente e password, non sono registrate in tracce e messaggi registrati.</span><span class="sxs-lookup"><span data-stu-id="89575-117">By default, keys and personally identifiable information (PII) such as username and password are not logged in traces and logged messages.</span></span> <span data-ttu-id="89575-118">Un amministratore del computer, tuttavia, può utilizzare l'attributo `enableLoggingKnownPII` nell'elemento `machineSettings` del file Machine.config per consentire alle applicazioni in esecuzione sul computer di registrare informazioni personali note (PII).</span><span class="sxs-lookup"><span data-stu-id="89575-118">A machine administrator, however, can use the `enableLoggingKnownPII` attribute in the `machineSettings` element of the Machine.config file to permit applications running on the machine to log known personally identifiable information (PII).</span></span> <span data-ttu-id="89575-119">La procedura viene illustrata nella configurazione seguente:</span><span class="sxs-lookup"><span data-stu-id="89575-119">The following configuration demonstrates how to do this:</span></span>  
  
```xml  
<configuration>  
   <system.serviceModel>  
      <machineSettings enableLoggingKnownPii="true"/>  
   </system.serviceModel>  
</configuration>
```  
  
 <span data-ttu-id="89575-120">I distributori di applicazioni possono quindi utilizzare l'attributo `logKnownPii` nel file App.config o Web.config per abilitare la registrazione di informazioni personali come segue:</span><span class="sxs-lookup"><span data-stu-id="89575-120">An application deployer can then use the `logKnownPii` attribute in either the App.config or Web.config file to enable PII logging as follows:</span></span>  
  
```xml  
<system.diagnostics>  
  <sources>  
      <source name="System.ServiceModel.MessageLogging"  
        logKnownPii="true">  
        <listeners>  
                 <add name="messages"  
                 type="System.Diagnostics.XmlWriterTraceListener"  
                 initializeData="c:\logs\messages.svclog" />  
          </listeners>  
      </source>  
    </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="89575-121">La registrazione di informazioni personali viene abilitata solo quando entrambe le impostazioni sono `true`.</span><span class="sxs-lookup"><span data-stu-id="89575-121">Only when both settings are `true` is PII logging enabled.</span></span> <span data-ttu-id="89575-122">La combinazione di due opzioni consente la registrazione di informazioni personali note per ogni applicazione.</span><span class="sxs-lookup"><span data-stu-id="89575-122">The combination of two switches allows the flexibility to log known PII for each application.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="89575-123">In [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] i flag `logEntireMessage` e `logKnownPii` devono essere impostati su `true` nel file Web.config o nel file App.config per abilitare la registrazione delle informazioni personali, come mostrato nel seguente esempio `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`.</span><span class="sxs-lookup"><span data-stu-id="89575-123">In [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] the `logEntireMessage` and `logKnownPii` flags must also be set to `true` in the Web.config file or the App.config file to enable PII logging, as show in the following example `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`.</span></span>  
  
 <span data-ttu-id="89575-124">Tenere presente che se si specificano due o più origini personalizzate in un file di configurazione, solo gli attributi della prima origine vengono letti.</span><span class="sxs-lookup"><span data-stu-id="89575-124">You should be aware that if you specify two or more custom sources in a configuration file, only the attributes of the first source are read.</span></span> <span data-ttu-id="89575-125">Gli altri vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="89575-125">The others are ignored.</span></span> <span data-ttu-id="89575-126">Questo implica che, per il file App.config seguente, le informazioni personali non vengono registrate per entrambe le origini anche se la registrazione di informazioni personali è abilitata in modo esplicito per la seconda origine.</span><span class="sxs-lookup"><span data-stu-id="89575-126">This means that, for the following App.config, file, PII is not logged for both sources even though PII logging is explicitly enabled for the second source.</span></span>  
  
```xml  
<system.diagnostics>  
   <sources>  
      <source name="System.ServiceModel.MessageLogging"  
              logKnownPii="false">  
              <listeners>  
                 <add name="messages"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\messages.svclog" />  
              </listeners>  
            </source>  
      <source name="System.ServiceModel"
              logKnownPii="true">  
              <listeners>  
                 <add name="traces"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\traces.svclog" />  
              </listeners>  
      </source>  
   </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="89575-127">Se l'elemento `<machineSettings enableLoggingKnownPii="Boolean"/>` esiste al di fuori del file Machine.config, il sistema genera un'eccezione <xref:System.Configuration.ConfigurationErrorsException>.</span><span class="sxs-lookup"><span data-stu-id="89575-127">If the `<machineSettings enableLoggingKnownPii="Boolean"/>` element exists outside the Machine.config file, the system throws a <xref:System.Configuration.ConfigurationErrorsException>.</span></span>  
  
 <span data-ttu-id="89575-128">Le modifiche diventano effettive solo dopo l'avvio o il riavvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="89575-128">The changes are effective only when the application starts or restarts.</span></span> <span data-ttu-id="89575-129">Un evento viene registrato all'avvio quando entrambi gli attributi sono impostati su `true`.</span><span class="sxs-lookup"><span data-stu-id="89575-129">An event is logged at startup when both attributes are set to `true`.</span></span> <span data-ttu-id="89575-130">Un evento viene inoltre registrato se `logKnownPii` è impostato su `true` ma `enableLoggingKnownPii` è `false`.</span><span class="sxs-lookup"><span data-stu-id="89575-130">An event is also logged if `logKnownPii` is set to `true` but `enableLoggingKnownPii` is `false`.</span></span>  
  
 <span data-ttu-id="89575-131">L'amministratore del computer e il distributore di applicazioni devono prestare molta attenzione durante l'utilizzo di queste due opzioni.</span><span class="sxs-lookup"><span data-stu-id="89575-131">The machine administrator and application deployer should exercise extreme caution when using these two switches.</span></span> <span data-ttu-id="89575-132">Se la registrazione di informazioni personali è abilitata, vengono registrate chiavi di sicurezza e informazioni personali.</span><span class="sxs-lookup"><span data-stu-id="89575-132">If PII logging is enabled, security keys and PII are logged.</span></span> <span data-ttu-id="89575-133">Se è disabilitata, i dati riservati e le informazioni specifiche dell'applicazione vengono comunque registrati nell'intestazione e nel corpo dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="89575-133">If it is disabled, sensitive and application-specific data is still logged in message headers and bodies.</span></span> <span data-ttu-id="89575-134">Per una discussione più approfondita sulla privacy e sulla protezione delle informazioni personali dall'esposizione, vedere [Privacy degli](https://docs.microsoft.com/previous-versions/dotnet/articles/aa480490(v=msdn.10))utenti .</span><span class="sxs-lookup"><span data-stu-id="89575-134">For a more thorough discussion about privacy and protecting PII from being exposed, see [User Privacy](https://docs.microsoft.com/previous-versions/dotnet/articles/aa480490(v=msdn.10)).</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="89575-135">Le PII non sono nascoste nei messaggi in formato non valido.</span><span class="sxs-lookup"><span data-stu-id="89575-135">PII is not hidden in malformed messages.</span></span> <span data-ttu-id="89575-136">Tali messaggi vengono registrati così come sono, senza alcuna modifica.</span><span class="sxs-lookup"><span data-stu-id="89575-136">Such messaged are logged as-is without any modification.</span></span> <span data-ttu-id="89575-137">Gli attributi menzionati prima non hanno alcun effetto su questa situazione.</span><span class="sxs-lookup"><span data-stu-id="89575-137">Attributes mentioned previously have no effect on this.</span></span>  
  
### <a name="custom-trace-listener"></a><span data-ttu-id="89575-138">Listener di traccia personalizzato</span><span class="sxs-lookup"><span data-stu-id="89575-138">Custom Trace Listener</span></span>  
 <span data-ttu-id="89575-139">L'aggiunta di un listener di traccia personalizzato sull'origine della traccia di registrazione messaggi è un privilegio che deve essere limitato all'amministratore.</span><span class="sxs-lookup"><span data-stu-id="89575-139">Adding a custom trace listener on the Message Logging trace source is a privilege that should be restricted to the administrator.</span></span> <span data-ttu-id="89575-140">Tale limitazione è dovuta al fatto che i listener personalizzati dannosi possono essere configurati per inviare messaggi in modalità remota, con la conseguente divulgazione di informazioni riservate.</span><span class="sxs-lookup"><span data-stu-id="89575-140">This is because malicious custom listeners can be configured to send messages remotely, which leads to sensitive information disclosure.</span></span> <span data-ttu-id="89575-141">Se, inoltre, si configura un listener personalizzato affinché invii messaggi in rete, ad esempio a un database remoto, è necessario applicare un controllo di accesso appropriato sui registri dei messaggi nel computer remoto.</span><span class="sxs-lookup"><span data-stu-id="89575-141">In addition, if you configure a custom listener to send messages on the wire, such as, to a remote database, you should enforce proper access control on the message logs in the remote machine.</span></span>  
  
## <a name="events-triggered-by-message-logging"></a><span data-ttu-id="89575-142">Eventi generati dalla registrazione dei messaggi</span><span class="sxs-lookup"><span data-stu-id="89575-142">Events Triggered by Message Logging</span></span>  
 <span data-ttu-id="89575-143">Di seguito vengono elencati tutti gli eventi emessi dalla registrazione dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="89575-143">The following lists all the events emitted by message logging.</span></span>  
  
- <span data-ttu-id="89575-144">Registrazioni messaggi attiva: questo evento viene emesso quando la registrazione messaggi è abilitata nella configurazione, o tramite WMI.</span><span class="sxs-lookup"><span data-stu-id="89575-144">Message logging on: This event is emitted when message logging is enabled in configuration, or through WMI.</span></span> <span data-ttu-id="89575-145">Il contenuto dell'evento è "Registrazione messaggi attivata.</span><span class="sxs-lookup"><span data-stu-id="89575-145">The content of the event is "Message logging has been turned on.</span></span> <span data-ttu-id="89575-146">È possibile che le informazioni riservate vengano registrate in forma non crittografata, anche se crittografate durante la trasmissione, ad esempio i corpi dei messaggi".</span><span class="sxs-lookup"><span data-stu-id="89575-146">Sensitive information may be logged in clear text, even if they were encrypted on the wire, for example, message bodies."</span></span>  
  
- <span data-ttu-id="89575-147">Registrazioni messaggi disattivata: questo evento viene emesso quando la registrazione messaggi è disabilitata tramite WMI.</span><span class="sxs-lookup"><span data-stu-id="89575-147">Message logging off: This event is emitted when message logging is disabled through WMI.</span></span> <span data-ttu-id="89575-148">Il contenuto dell'evento è "Registrazione messaggi disattivata".</span><span class="sxs-lookup"><span data-stu-id="89575-148">The content of the event is "Message logging has been turned off."</span></span>  
  
- <span data-ttu-id="89575-149">Registrazione informazioni personali note attiva: questo evento viene generato quando la registrazione di informazioni personali note è abilitata.</span><span class="sxs-lookup"><span data-stu-id="89575-149">Log Known PII On: This event is emitted when logging of known PII is enabled.</span></span> <span data-ttu-id="89575-150">Ciò si `enableLoggingKnownPii` verifica `machineSettings` quando l'attributo nell'elemento `true`del `logKnownPii` file Machine.config è impostato su e l'attributo dell'elemento `source` nel file App.config o Web.config è impostato su `true`.</span><span class="sxs-lookup"><span data-stu-id="89575-150">This happens when the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `true`, and the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`.</span></span>  
  
- <span data-ttu-id="89575-151">Registrazione informazioni personali note non consentita: questo evento viene emesso quando la registrazione delle informazioni personali note non è consentita.</span><span class="sxs-lookup"><span data-stu-id="89575-151">Log Known PII Not Allowed: This event is emitted when logging of known PII is not allowed.</span></span> <span data-ttu-id="89575-152">Ciò si `logKnownPii` verifica `source` quando l'attributo dell'elemento nel file `true`App.config `enableLoggingKnownPii` o `machineSettings` Web.config è impostato su `false`, ma l'attributo nell'elemento del file Machine.config è impostato su .</span><span class="sxs-lookup"><span data-stu-id="89575-152">This happens when the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`, but the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `false`.</span></span> <span data-ttu-id="89575-153">Non viene generata alcuna eccezione.</span><span class="sxs-lookup"><span data-stu-id="89575-153">No exception is thrown.</span></span>  
  
 <span data-ttu-id="89575-154">Questi eventi possono essere visualizzati nello strumento Visualizzatore eventi in dotazione con Windows.</span><span class="sxs-lookup"><span data-stu-id="89575-154">These events can be viewed in the Event Viewer tool that comes with Windows.</span></span> <span data-ttu-id="89575-155">Per ulteriori informazioni, vedere [Registrazione eventi](./event-logging/index.md).</span><span class="sxs-lookup"><span data-stu-id="89575-155">For more information on this, see [Event Logging](./event-logging/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="89575-156">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="89575-156">See also</span></span>

- [<span data-ttu-id="89575-157">Registrazione messaggi</span><span class="sxs-lookup"><span data-stu-id="89575-157">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="89575-158">Problemi di sicurezza e suggerimenti utili per la traccia</span><span class="sxs-lookup"><span data-stu-id="89575-158">Security Concerns and Useful Tips for Tracing</span></span>](./tracing/security-concerns-and-useful-tips-for-tracing.md)
