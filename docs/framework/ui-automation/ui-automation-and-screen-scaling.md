---
title: Automazione interfaccia utente e ridimensionamento dello schermo
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- scaling, screens
- screens, scaling
- UI (user interface), automation
- UI Automation
ms.assetid: 4380cad7-e509-448f-b9a5-6de042605fd4
ms.openlocfilehash: 2a68a74fa6aadcaba21f142d394a1f8a3d8af371
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79179973"
---
# <a name="ui-automation-and-screen-scaling"></a><span data-ttu-id="6e140-102">Automazione interfaccia utente e ridimensionamento dello schermo</span><span class="sxs-lookup"><span data-stu-id="6e140-102">UI Automation and Screen Scaling</span></span>
> [!NOTE]
> <span data-ttu-id="6e140-103">Questa documentazione è destinata agli sviluppatori di .NET Framework che vogliono usare le classi gestite di [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] definite nello spazio dei nomi <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="6e140-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="6e140-104">Per informazioni aggiornate su [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], vedere [Windows Automation API: automazione interfaccia utente](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="6e140-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
<span data-ttu-id="6e140-105">A partire da Windows Vista, Windows consente agli utenti di modificare l'impostazione di punti per pollice (dpi) in modo che la maggior parte degli elementi dell'interfaccia utente sullo schermo appaia più grande.</span><span class="sxs-lookup"><span data-stu-id="6e140-105">Starting with Windows Vista, Windows enables users to change the dots per inch (dpi) setting so that most user interface (UI) elements on the screen appear larger.</span></span> <span data-ttu-id="6e140-106">Anche se questa funzionalità è stata a lungo disponibile in Windows, nelle versioni precedenti il ridimensionamento doveva essere implementato dalle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="6e140-106">Although this feature has long been available in Windows, in previous versions the scaling had to be implemented by applications.</span></span> <span data-ttu-id="6e140-107">A partire da Windows Vista, Gestione finestre desktop esegue il ridimensionamento predefinito per tutte le applicazioni che non gestiscono il proprio ridimensionamento.</span><span class="sxs-lookup"><span data-stu-id="6e140-107">Starting with Windows Vista, the Desktop Window Manager performs default scaling for all applications that do not handle their own scaling.</span></span> <span data-ttu-id="6e140-108">Per le applicazioni client di automazione interfaccia utente è necessario tenere conto di questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="6e140-108">UI Automation client applications must take this feature into account.</span></span>  
  
<a name="Scaling_in_Windows_Vista"></a>
## <a name="scaling-in-windows-vista"></a><span data-ttu-id="6e140-109">Ridimensionamento in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="6e140-109">Scaling in Windows Vista</span></span>  
 <span data-ttu-id="6e140-110">L'impostazione dpi predefinita è 96, il che significa che 96 pixel occupano una larghezza o un'altezza di un pollice nozionale.</span><span class="sxs-lookup"><span data-stu-id="6e140-110">The default dpi setting is 96, which means that 96 pixels occupy a width or height of one notional inch.</span></span> <span data-ttu-id="6e140-111">La misura esatta di un pollice dipende dalle dimensioni e dalla risoluzione fisica del monitor.</span><span class="sxs-lookup"><span data-stu-id="6e140-111">The exact measure of an "inch" depends on the size and physical resolution of the monitor.</span></span> <span data-ttu-id="6e140-112">Ad esempio, su un monitor con una larghezza di 12 pollici e una risoluzione orizzontale di 1280 pixel, una riga orizzontale di 96 pixel si estende per circa 9/10 di un pollice.</span><span class="sxs-lookup"><span data-stu-id="6e140-112">For example, on a monitor 12 inches wide, at a horizontal resolution of 1280 pixels, a horizontal line of 96 pixels extends about 9/10 of an inch.</span></span>  
  
 <span data-ttu-id="6e140-113">La modifica dell'impostazione dpi non equivale a modificare la risoluzione dello schermo.</span><span class="sxs-lookup"><span data-stu-id="6e140-113">Changing the dpi setting is not the same as changing the screen resolution.</span></span> <span data-ttu-id="6e140-114">Con il ridimensionamento dpi, il numero di pixel fisici sullo schermo rimane invariato.</span><span class="sxs-lookup"><span data-stu-id="6e140-114">With dpi scaling, the number of physical pixels on the screen remains the same.</span></span> <span data-ttu-id="6e140-115">Il ridimensionamento viene tuttavia applicato alle dimensioni e alla posizione degli elementi dell' [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6e140-115">However, scaling is applied to the size and location of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements.</span></span> <span data-ttu-id="6e140-116">È possibile eseguire il ridimensionamento automaticamente con Gestione finestre desktop per il desktop e per le applicazioni che non richiedono tale funzionalità in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="6e140-116">This scaling can be performed automatically by the Desktop Window Manager (DWM) for the desktop and for applications that do not explicitly ask not to be scaled.</span></span>  
  
 <span data-ttu-id="6e140-117">In effetti, quando l'utente imposta il fattore di scala su 120 dpi, un pollice verticale o orizzontale sullo schermo diventa più grande del 25%.</span><span class="sxs-lookup"><span data-stu-id="6e140-117">In effect, when the user sets the scale factor to 120 dpi, a vertical or horizontal inch on the screen becomes bigger by 25 percent.</span></span> <span data-ttu-id="6e140-118">Tutte le dimensioni vengono ridimensionate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="6e140-118">All dimensions are scaled accordingly.</span></span> <span data-ttu-id="6e140-119">L'offset di una finestra dell'applicazione dai bordi superiore e sinistro dello schermo aumenta del 25%.</span><span class="sxs-lookup"><span data-stu-id="6e140-119">The offset of an application window from the top and left edges of the screen increases by 25 percent.</span></span> <span data-ttu-id="6e140-120">Se il ridimensionamento dell'applicazione è abilitato e l'applicazione non è compatibile con dpi, le [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] dimensioni della finestra aumentano nella stessa proporzione, insieme agli offset e alle dimensioni di tutti gli elementi in essa contenuti.</span><span class="sxs-lookup"><span data-stu-id="6e140-120">If application scaling is enabled and the application is not dpi-aware, the size of the window increases in the same proportion, along with the offsets and sizes of all [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements it contains.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6e140-121">Per impostazione predefinita, il dWM non esegue il ridimensionamento per le applicazioni non in grado di riconoscere dpi quando l'utente imposta il dpi su 120, ma lo esegue quando il dpi è impostato su un valore personalizzato di 144 o superiore.</span><span class="sxs-lookup"><span data-stu-id="6e140-121">By default, the DWM does not perform scaling for non-dpi-aware applications when the user sets the dpi to 120, but does perform it when the dpi is set to a custom value of 144 or higher.</span></span> <span data-ttu-id="6e140-122">È tuttavia possibile ignorare questo comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="6e140-122">However, the user can override the default behavior.</span></span>  
  
 <span data-ttu-id="6e140-123">Il ridimensionamento dello schermo crea nuove sfide per le applicazioni che dipendono dalle coordinate dello schermo.</span><span class="sxs-lookup"><span data-stu-id="6e140-123">Screen scaling creates new challenges for applications that are concerned in any way with screen coordinates.</span></span> <span data-ttu-id="6e140-124">Lo schermo contiene ora due sistemi di coordinate: fisico e logico.</span><span class="sxs-lookup"><span data-stu-id="6e140-124">The screen now contains two coordinate systems: physical and logical.</span></span> <span data-ttu-id="6e140-125">Le coordinate fisiche di un punto sono l'offset effettivo in pixel dalla parte superiore sinistra dell'origine.</span><span class="sxs-lookup"><span data-stu-id="6e140-125">The physical coordinates of a point are the actual offset in pixels from the top left of the origin.</span></span> <span data-ttu-id="6e140-126">Le coordinate logiche sono gli offset così come si presenterebbero se i pixel fossero ridimensionati.</span><span class="sxs-lookup"><span data-stu-id="6e140-126">The logical coordinates are the offsets as they would be if the pixels themselves were scaled.</span></span>  
  
 <span data-ttu-id="6e140-127">Si supponga di progettare una finestra di dialogo con un pulsante in corrispondenza delle coordinate (100, 48).</span><span class="sxs-lookup"><span data-stu-id="6e140-127">Suppose you design a dialog box with a button at coordinates (100, 48).</span></span> <span data-ttu-id="6e140-128">Quando questa finestra di dialogo viene visualizzata in corrispondenza dei 96 dpi predefiniti, il pulsante si trova in corrispondenza delle coordinate fisiche di (100, 48).</span><span class="sxs-lookup"><span data-stu-id="6e140-128">When this dialog box is displayed at the default 96 dpi, the button is located at physical coordinates of (100, 48).</span></span> <span data-ttu-id="6e140-129">A 120 dpi, si trova alle coordinate fisiche di (125, 60).</span><span class="sxs-lookup"><span data-stu-id="6e140-129">At 120 dpi, it is located at physical coordinates of (125, 60).</span></span> <span data-ttu-id="6e140-130">Ma le coordinate logiche sono le stesse in qualsiasi impostazione dpi: (100, 48).</span><span class="sxs-lookup"><span data-stu-id="6e140-130">But the logical coordinates are the same at any dpi setting: (100, 48).</span></span>  
  
 <span data-ttu-id="6e140-131">Le coordinate logiche sono importanti, perché rendono coerente il comportamento del sistema operativo e delle applicazioni indipendentemente dall'impostazione di dpi.</span><span class="sxs-lookup"><span data-stu-id="6e140-131">Logical coordinates are important, because they make the behavior of the operating system and applications consistent regardless of the dpi setting.</span></span> <span data-ttu-id="6e140-132">Ad esempio, la proprietà <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType> restituisce in genere le coordinate logiche.</span><span class="sxs-lookup"><span data-stu-id="6e140-132">For example, <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType> normally returns the logical coordinates.</span></span> <span data-ttu-id="6e140-133">Se si sposta il cursore su un elemento in una finestra di dialogo, vengono restituite le stesse coordinate indipendentemente dall'impostazione di dpi.</span><span class="sxs-lookup"><span data-stu-id="6e140-133">If you move the cursor over an element in a dialog box, the same coordinates are returned regardless of the dpi setting.</span></span> <span data-ttu-id="6e140-134">Se si disegna un controllo in corrispondenza di (100, 100), viene disegnato in tali coordinate logiche e occuperà la stessa posizione relativa in qualsiasi impostazione dpi.</span><span class="sxs-lookup"><span data-stu-id="6e140-134">If you draw a control at (100, 100), it is drawn to those logical coordinates, and will occupy the same relative position at any dpi setting.</span></span>  
  
<a name="Scaling_in_UI_Automation_Clients"></a>
## <a name="scaling-in-ui-automation-clients"></a><span data-ttu-id="6e140-135">Ridimensionamento nei client di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="6e140-135">Scaling in UI Automation Clients</span></span>  
 <span data-ttu-id="6e140-136">L'API [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] non utilizza coordinate logiche.</span><span class="sxs-lookup"><span data-stu-id="6e140-136">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] API does not use logical coordinates.</span></span> <span data-ttu-id="6e140-137">I metodi e le proprietà seguenti restituiscono coordinate fisiche o le accettano come parametri.</span><span class="sxs-lookup"><span data-stu-id="6e140-137">The following methods and properties either return physical coordinates or take them as parameters.</span></span>  
  
- <xref:System.Windows.Automation.AutomationElement.GetClickablePoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.TryGetClickablePoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.ClickablePointProperty>  
  
- <xref:System.Windows.Automation.AutomationElement.FromPoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.BoundingRectangle%2A>  
  
 <span data-ttu-id="6e140-138">Per impostazione predefinita, un'applicazione client di automazione interfaccia utente in esecuzione in un ambiente non-96- dpi non sarà in grado di ottenere risultati corretti da questi metodi e proprietà.</span><span class="sxs-lookup"><span data-stu-id="6e140-138">By default, a UI Automation client application running in a non-96- dpi environment will not be able to obtain correct results from these methods and properties.</span></span> <span data-ttu-id="6e140-139">Ad esempio, poiché la posizione del cursore è definita in coordinate logiche, il client non può semplicemente passare tali coordinate al metodo <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> per ottenere l'elemento sotto il cursore.</span><span class="sxs-lookup"><span data-stu-id="6e140-139">For example, because the cursor position is in logical coordinates, the client cannot simply pass these coordinates to <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> to obtain the element that is under the cursor.</span></span> <span data-ttu-id="6e140-140">Inoltre, l'applicazione non sarà in grado di posizionare correttamente le finestre al di fuori dell'area client.</span><span class="sxs-lookup"><span data-stu-id="6e140-140">In addition, the application will not be able to correctly place windows outside its client area.</span></span>  
  
 <span data-ttu-id="6e140-141">La soluzione è costituita da due parti.</span><span class="sxs-lookup"><span data-stu-id="6e140-141">The solution is in two parts.</span></span>  
  
1. <span data-ttu-id="6e140-142">In primo luogo, rendere l'applicazione client dpi-aware.</span><span class="sxs-lookup"><span data-stu-id="6e140-142">First, make the client application dpi-aware.</span></span> <span data-ttu-id="6e140-143">A tale scopo, chiamare la `SetProcessDPIAware` funzione Win32 all'avvio.</span><span class="sxs-lookup"><span data-stu-id="6e140-143">To do this, call the Win32 function `SetProcessDPIAware` at startup.</span></span> <span data-ttu-id="6e140-144">In codice gestito, la dichiarazione seguente rende disponibile questa funzione.</span><span class="sxs-lookup"><span data-stu-id="6e140-144">In managed code, the following declaration makes this function available.</span></span>  
  
     [!code-csharp[Highlighter#101](../../../samples/snippets/csharp/VS_Snippets_Wpf/Highlighter/CSharp/NativeMethods.cs#101)]
     [!code-vb[Highlighter#101](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/Highlighter/VisualBasic/NativeMethods.vb#101)]  
  
     <span data-ttu-id="6e140-145">Questa funzione rende l'intero processo dpi-aware, vale a dire che tutte le finestre che appartengono al processo non vengono scalate.</span><span class="sxs-lookup"><span data-stu-id="6e140-145">This function makes the entire process dpi-aware, meaning that all windows that belong to the process are unscaled.</span></span> <span data-ttu-id="6e140-146">[Nell'esempio Evidenziatore](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter), ad esempio, le quattro finestre che costituiscono il rettangolo di evidenziazione si trovano in corrispondenza delle coordinate fisiche ottenute da Automazione interfaccia utenteUI Automation, non delle coordinate logiche.</span><span class="sxs-lookup"><span data-stu-id="6e140-146">In the [Highlighter Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter), for instance, the four windows that make up the highlight rectangle are located at the physical coordinates obtained from UI Automation, not the logical coordinates.</span></span> <span data-ttu-id="6e140-147">Se l'esempio non fosse dpi-aware, l'evidenziazione verrebbe disegnata in corrispondenza delle coordinate logiche sul desktop, il che comporterebbe un posizionamento non corretto in un ambiente non-96- dpi.</span><span class="sxs-lookup"><span data-stu-id="6e140-147">If the sample were not dpi-aware, the highlight would be drawn at the logical coordinates on the desktop, which would result in incorrect placement in a non-96- dpi environment.</span></span>  
  
2. <span data-ttu-id="6e140-148">Per ottenere le coordinate del cursore, chiamare la funzione `GetPhysicalCursorPos`Win32 .</span><span class="sxs-lookup"><span data-stu-id="6e140-148">To get cursor coordinates, call the Win32 function `GetPhysicalCursorPos`.</span></span> <span data-ttu-id="6e140-149">Nell'esempio riportato di seguito viene illustrato come dichiarare e usare questa funzione.</span><span class="sxs-lookup"><span data-stu-id="6e140-149">The following example shows how to declare and use this function.</span></span>  
  
     [!code-csharp[UIAClient_snip#185](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#185)]
     [!code-vb[UIAClient_snip#185](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#185)]  
  
> [!CAUTION]
> <span data-ttu-id="6e140-150">Non usare <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6e140-150">Do not use <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="6e140-151">Il comportamento di questa proprietà al di fuori delle finestre client in un ambiente non ridimensionato non è definito.</span><span class="sxs-lookup"><span data-stu-id="6e140-151">The behavior of this property outside client windows in a scaled environment is undefined.</span></span>  
  
 <span data-ttu-id="6e140-152">Se l'applicazione esegue una comunicazione diretta tra processi con applicazioni non in grado di riconoscere dpi, è possibile che sia stata eseguita la conversione tra coordinate logiche e fisiche utilizzando le funzioni `PhysicalToLogicalPoint` Win32 e `LogicalToPhysicalPoint`.</span><span class="sxs-lookup"><span data-stu-id="6e140-152">If your application performs direct cross-process communication with non- dpi-aware applications, you may have convert between logical and physical coordinates by using the Win32 functions `PhysicalToLogicalPoint` and `LogicalToPhysicalPoint`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6e140-153">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6e140-153">See also</span></span>

- [<span data-ttu-id="6e140-154">Highlighter Sample</span><span class="sxs-lookup"><span data-stu-id="6e140-154">Highlighter Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter)
