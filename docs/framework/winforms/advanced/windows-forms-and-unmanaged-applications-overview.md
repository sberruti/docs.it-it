---
title: Panoramica delle app non gestite
ms.date: 03/30/2017
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: 0b4c3e738848be1ead2adeb1945e168c9db60071
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/24/2020
ms.locfileid: "76732530"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="e5aca-102">Cenni preliminari su Windows Form e applicazioni non gestite</span><span class="sxs-lookup"><span data-stu-id="e5aca-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="e5aca-103">Le applicazioni e i controlli Windows Form possono interagire con le applicazioni non gestite, con alcune raccomandazioni.</span><span class="sxs-lookup"><span data-stu-id="e5aca-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="e5aca-104">Nelle sezioni che seguono vengono descritti configurazioni e scenari supportati e non supportati dalle applicazioni e dai controlli Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="e5aca-105">Controlli Windows Form e applicazioni ActiveX</span><span class="sxs-lookup"><span data-stu-id="e5aca-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="e5aca-106">Fatta eccezione per Microsoft Internet Explorer e MFC (Microsoft Foundation Classes), i controlli Windows Form non sono supportati in applicazioni progettate per ospitare controlli ActiveX.</span><span class="sxs-lookup"><span data-stu-id="e5aca-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="e5aca-107">Le altre applicazioni e gli strumenti per lo sviluppo in grado di ospitare controlli ActiveX, come i Test Container ActiveX di versioni di Visual Studio precedenti a Visual Studio .NET 2003, non sono host supportati per i controlli Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="e5aca-108">Queste limitazioni si applicano anche all'uso dei controlli Windows Form tramite l'interoperabilità COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="e5aca-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="e5aca-109">L'uso di un controllo Windows Form tramite COM Callable Wrapper (CCW) è supportato solo in Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="e5aca-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="e5aca-110">Per altre informazioni sull'interoperabilità COM, vedere</span><span class="sxs-lookup"><span data-stu-id="e5aca-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="e5aca-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="e5aca-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="e5aca-112">Nella tabella riportata di seguito è illustrato il supporto per l'hosting ActiveX per i controlli Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="e5aca-113">Versione di Windows Form</span><span class="sxs-lookup"><span data-stu-id="e5aca-113">Windows Forms version</span></span>|<span data-ttu-id="e5aca-114">Supporto</span><span class="sxs-lookup"><span data-stu-id="e5aca-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="e5aca-115">.NET Framework versione 1.0</span><span class="sxs-lookup"><span data-stu-id="e5aca-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="e5aca-116">Internet Explorer 5.01 e versioni successive</span><span class="sxs-lookup"><span data-stu-id="e5aca-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="e5aca-117">.NET Framework 1.1 e versioni successive</span><span class="sxs-lookup"><span data-stu-id="e5aca-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="e5aca-118">Internet Explorer 5.01 e versioni successive</span><span class="sxs-lookup"><span data-stu-id="e5aca-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="e5aca-119">MFC (Microsoft Foundation Classes) 7.0 e versioni successive</span><span class="sxs-lookup"><span data-stu-id="e5aca-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="e5aca-120">Hosting dei componenti Windows Form come controlli ActiveX</span><span class="sxs-lookup"><span data-stu-id="e5aca-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="e5aca-121">In .NET Framework 1.1, il supporto è stato esteso per includere MFC 7.0 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="e5aca-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="e5aca-122">Questo supporto include tutti i contenitori completamente compatibili con il contenitore di controlli ActiveX di MFC 7.0 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="e5aca-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="e5aca-123">La registrazione dei controlli Windows Form come controlli ActiveX non è tuttavia supportata,</span><span class="sxs-lookup"><span data-stu-id="e5aca-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="e5aca-124">analogamente alla chiamata al metodo `com.ms.win32.Ole32.CoCreateInstance` per i controlli Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="e5aca-125">È supportata solo l'attivazione gestita dei controlli Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="e5aca-126">Dopo aver creato un controllo Windows Form, è possibile inserirlo in un'applicazione MFC come se fosse un controllo ActiveX.</span><span class="sxs-lookup"><span data-stu-id="e5aca-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="e5aca-127">Per usare i controlli Windows Form nell'applicazione non gestita, inserire il CLR usando le API per l'hosting del CLR non gestito oppure usare le funzioni di interoperabilità C++.</span><span class="sxs-lookup"><span data-stu-id="e5aca-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="e5aca-128">Si consiglia di usare le funzioni di interoperabilità C++.</span><span class="sxs-lookup"><span data-stu-id="e5aca-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="e5aca-129">Windows Form in applicazioni client COM</span><span class="sxs-lookup"><span data-stu-id="e5aca-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="e5aca-130">Quando si apre un Windows Form da un'applicazione client COM, come un'applicazione Visual Basic 6.0 o un'applicazione MFC, il form può presentare comportamenti imprevisti.</span><span class="sxs-lookup"><span data-stu-id="e5aca-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="e5aca-131">Ad esempio, quando si preme il tasto TAB, lo stato di attivazione non passa da un controllo a un altro.</span><span class="sxs-lookup"><span data-stu-id="e5aca-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="e5aca-132">Se si preme il tasto INVIO quando un pulsante di comando è nello stato di attivazione, l'evento <xref:System.Windows.Forms.Control.Click> del pulsante non viene generato.</span><span class="sxs-lookup"><span data-stu-id="e5aca-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="e5aca-133">Può verificarsi un comportamento imprevisto anche per le pressioni dei tasti o l'attività del mouse.</span><span class="sxs-lookup"><span data-stu-id="e5aca-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="e5aca-134">Questo comportamento si verifica in quanto l'applicazione non gestita non implementa il supporto del ciclo di messaggi richiesto per il funzionamento corretto di Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="e5aca-135">Il ciclo di messaggi fornito dall'applicazione client COM è fondamentalmente diverso dal ciclo di messaggi di Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="e5aca-136">Il ciclo di messaggi di un'applicazione è un ciclo interno di programma che recupera i messaggi dalla coda di messaggi di un thread, li converte e li invia all'applicazione per la gestione.</span><span class="sxs-lookup"><span data-stu-id="e5aca-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="e5aca-137">Il ciclo di messaggi di Windows Form non dispone della stessa architettura dei cicli di messaggi fornita dalle applicazioni precedenti, come le applicazioni Visual Basic 6.0 e le applicazioni MFC.</span><span class="sxs-lookup"><span data-stu-id="e5aca-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="e5aca-138">I messaggi inseriti nel ciclo dei messaggi possono essere gestiti in modo diverso da quanto previsto nel Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="e5aca-139">Di conseguenza, può prodursi un comportamento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="e5aca-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="e5aca-140">Alcune combinazioni di tasti potrebbero non funzionare, così come alcune operazioni eseguite con il mouse, oppure alcuni eventi potrebbero non essere generati in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="e5aca-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="e5aca-141">Risoluzione di problemi di interoperabilità</span><span class="sxs-lookup"><span data-stu-id="e5aca-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="e5aca-142">Per risolvere questi problemi, è possibile visualizzare il form in un ciclo di messaggi .NET Framework, creato usando il metodo <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e5aca-142">You can resolve these problems by displaying the form on a .NET Framework message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="e5aca-143">Perché un Windows Form funzioni correttamente da un'applicazione client COM, è necessario eseguirlo in un ciclo di messaggi Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="e5aca-144">Per eseguire questa operazione, adottare uno degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="e5aca-144">To do this, use one of the following approaches:</span></span>  
  
- <span data-ttu-id="e5aca-145">Usare il metodo <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> per visualizzare il Windows Form.</span><span class="sxs-lookup"><span data-stu-id="e5aca-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="e5aca-146">Per altre informazioni, vedere [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="e5aca-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
- <span data-ttu-id="e5aca-147">Visualizzare ogni Windows Form in un nuovo thread.</span><span class="sxs-lookup"><span data-stu-id="e5aca-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="e5aca-148">Per altre informazioni, vedere [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="e5aca-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e5aca-149">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e5aca-149">See also</span></span>

- [<span data-ttu-id="e5aca-150">Windows Forms and Unmanaged Applications</span><span class="sxs-lookup"><span data-stu-id="e5aca-150">Windows Forms and Unmanaged Applications</span></span>](windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="e5aca-151">Interoperabilità COM</span><span class="sxs-lookup"><span data-stu-id="e5aca-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="e5aca-152">Interoperabilità COM nelle applicazioni .NET Framework</span><span class="sxs-lookup"><span data-stu-id="e5aca-152">COM Interoperability in .NET Framework Applications</span></span>](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)
- <span data-ttu-id="e5aca-153">[Esempi di interoperabilità COM](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="e5aca-153">[COM Interoperability Samples](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="e5aca-154">Aximp.exe (utilità di importazione di controlli ActiveX di Windows Form)</span><span class="sxs-lookup"><span data-stu-id="e5aca-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../tools/aximp-exe-windows-forms-activex-control-importer.md)
- [<span data-ttu-id="e5aca-155">Esposizione di componenti .NET Framework a COM</span><span class="sxs-lookup"><span data-stu-id="e5aca-155">Exposing .NET Framework Components to COM</span></span>](../../interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="e5aca-156">Preparazione di un assembly per COM</span><span class="sxs-lookup"><span data-stu-id="e5aca-156">Packaging an Assembly for COM</span></span>](../../interop/packaging-an-assembly-for-com.md)
- [<span data-ttu-id="e5aca-157">Registrazione di assembly presso COM</span><span class="sxs-lookup"><span data-stu-id="e5aca-157">Registering Assemblies with COM</span></span>](../../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="e5aca-158">Procedura: Supportare l'interoperabilità COM visualizzando un Windows Form con il metodo ShowDialog</span><span class="sxs-lookup"><span data-stu-id="e5aca-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="e5aca-159">Procedura: supportare l'interoperabilità COM mediante la visualizzazione di ogni Windows Form nel relativo thread</span><span class="sxs-lookup"><span data-stu-id="e5aca-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
