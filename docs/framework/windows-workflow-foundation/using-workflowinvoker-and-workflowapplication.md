---
title: Utilizzo di WorkflowInvoker e WorkflowApplication
ms.date: 03/30/2017
ms.assetid: cd0e583c-a3f9-4fa2-b247-c7b3368c48a7
ms.openlocfilehash: 5d09fc3c902b1993b32edf3e9f92393433281636
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/12/2020
ms.locfileid: "79182696"
---
# <a name="using-workflowinvoker-and-workflowapplication"></a><span data-ttu-id="6bc09-102">Utilizzo di WorkflowInvoker e WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="6bc09-102">Using WorkflowInvoker and WorkflowApplication</span></span>
<span data-ttu-id="6bc09-103">Windows Workflow Foundation (WF) fornisce diversi metodi di hosting dei flussi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="6bc09-103">Windows Workflow Foundation (WF) provides several methods of hosting workflows.</span></span> <span data-ttu-id="6bc09-104"><xref:System.Activities.WorkflowInvoker> offre un modo semplice per richiamare un flusso di lavoro come se fosse una chiamata a un metodo e può essere usato solo per i flussi di lavoro che non usano la persistenza.</span><span class="sxs-lookup"><span data-stu-id="6bc09-104"><xref:System.Activities.WorkflowInvoker> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence.</span></span> <span data-ttu-id="6bc09-105"><xref:System.Activities.WorkflowApplication> fornisce un modello più dettagliato per l'esecuzione di flussi di lavoro che include la notifica degli eventi del ciclo di vita, il controllo di esecuzione, la ripresa del segnalibro e la persistenza.</span><span class="sxs-lookup"><span data-stu-id="6bc09-105"><xref:System.Activities.WorkflowApplication> provides a richer model for executing workflows that includes notification of lifecycle events, execution control, bookmark resumption, and persistence.</span></span> <span data-ttu-id="6bc09-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> fornisce il supporto per le attività di messaggistica e viene principalmente usato con i servizi flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="6bc09-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> provides support for messaging activities and is primarily used with workflow services.</span></span> <span data-ttu-id="6bc09-107">In questo argomento viene illustrato l'hosting del flusso di lavoro con <xref:System.Activities.WorkflowInvoker> e <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-107">This topic introduces you to workflow hosting with <xref:System.Activities.WorkflowInvoker> and <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="6bc09-108">Per ulteriori informazioni sull'hosting dei flussi di lavoro con <xref:System.ServiceModel.Activities.WorkflowServiceHost>, vedere Workflow [Services](../wcf/feature-details/workflow-services.md) e Hosting Workflow Services [Overview](../wcf/feature-details/hosting-workflow-services-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6bc09-108">For more information about hosting workflows with <xref:System.ServiceModel.Activities.WorkflowServiceHost>, see [Workflow Services](../wcf/feature-details/workflow-services.md) and [Hosting Workflow Services Overview](../wcf/feature-details/hosting-workflow-services-overview.md).</span></span>  
  
## <a name="using-workflowinvoker"></a><span data-ttu-id="6bc09-109">Uso di WorkflowInvoker</span><span class="sxs-lookup"><span data-stu-id="6bc09-109">Using WorkflowInvoker</span></span>  
 <span data-ttu-id="6bc09-110">L'oggetto <xref:System.Activities.WorkflowInvoker> fornisce un modello per l'esecuzione di un flusso di lavoro come se si trattasse di una chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="6bc09-110"><xref:System.Activities.WorkflowInvoker> provides a model for executing a workflow as if it were a method call.</span></span> <span data-ttu-id="6bc09-111">Per richiamare un flusso di lavoro tramite l'oggetto <xref:System.Activities.WorkflowInvoker>, chiamare il metodo <xref:System.Activities.WorkflowInvoker.Invoke%2A> e passare la definizione del flusso di lavoro da richiamare.</span><span class="sxs-lookup"><span data-stu-id="6bc09-111">To invoke a workflow using <xref:System.Activities.WorkflowInvoker>, call the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method and pass in the workflow definition of the workflow to invoke.</span></span> <span data-ttu-id="6bc09-112">In questo esempio viene richiamata un'attività <xref:System.Activities.Statements.WriteLine> tramite l'oggetto <xref:System.Activities.WorkflowInvoker>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-112">In this example, a <xref:System.Activities.Statements.WriteLine> activity is invoked using <xref:System.Activities.WorkflowInvoker>.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#1)]  
  
 <span data-ttu-id="6bc09-113">Quando un flusso di lavoro viene richiamato usando l'oggetto <xref:System.Activities.WorkflowInvoker>, tale flusso di lavoro viene eseguito sul thread chiamante e il metodo <xref:System.Activities.WorkflowInvoker.Invoke%2A> viene bloccato finché il flusso di lavoro non viene completato, incluso qualsiasi tempo di inattività.</span><span class="sxs-lookup"><span data-stu-id="6bc09-113">When a workflow is invoked using <xref:System.Activities.WorkflowInvoker>, the workflow executes on the calling thread and the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method blocks until the workflow is complete, including any idle time.</span></span> <span data-ttu-id="6bc09-114">Per configurare un intervallo di timeout entro cui completare il flusso di lavoro, usare uno degli overload <xref:System.Activities.WorkflowInvoker.Invoke%2A> che accetta un parametro <xref:System.TimeSpan>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-114">To configure a time-out interval in which the workflow must complete, use one of the <xref:System.Activities.WorkflowInvoker.Invoke%2A> overloads that takes a <xref:System.TimeSpan> parameter.</span></span> <span data-ttu-id="6bc09-115">In questo esempio un flusso di lavoro viene richiamato due volte con due intervalli di timeout diversi.</span><span class="sxs-lookup"><span data-stu-id="6bc09-115">In this example, a workflow is invoked twice with two different time-out intervals.</span></span> <span data-ttu-id="6bc09-116">Il primo flusso di lavoro viene completato, ma non il secondo.</span><span class="sxs-lookup"><span data-stu-id="6bc09-116">The first workflow complets, but the second does not.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#50](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#50)]  
  
> [!NOTE]
> <span data-ttu-id="6bc09-117">L'eccezione <xref:System.TimeoutException> viene generata solo se l'intervallo di timeout scade e il flusso di lavoro diventa inattivo durante l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="6bc09-117">The <xref:System.TimeoutException> is only thrown if the time-out interval elapses and the workflow becomes idle during execution.</span></span> <span data-ttu-id="6bc09-118">Un flusso di lavoro il cui completamento richiede più tempo rispetto all'intervallo di timeout specificato viene completato correttamente se non diventa inattivo.</span><span class="sxs-lookup"><span data-stu-id="6bc09-118">A workflow that takes longer than the specified time-out interval to complete completes successfully if the workflow does not become idle.</span></span>  
  
 <span data-ttu-id="6bc09-119">L'elemento <xref:System.Activities.WorkflowInvoker> fornisce anche versioni asincrone del metodo di richiamo.</span><span class="sxs-lookup"><span data-stu-id="6bc09-119"><xref:System.Activities.WorkflowInvoker> also provides asynchronous versions of the invoke method.</span></span> <span data-ttu-id="6bc09-120">Per altre informazioni, vedere <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> e <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-120">For more information, see <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> and <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span></span>  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="6bc09-121">Impostazione degli argomenti di input di un flusso di lavoro</span><span class="sxs-lookup"><span data-stu-id="6bc09-121">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="6bc09-122">I dati possono essere passati in un flusso di lavoro tramite un dizionario di parametri di input, con chiavi in base al nome dell'argomento, che sono mappati agli argomenti di input del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="6bc09-122">Data can be passed into a workflow using a dictionary of input parameters, keyed by argument name, that map to the input arguments of the workflow.</span></span> <span data-ttu-id="6bc09-123">In questo esempio viene richiamato un oggetto <xref:System.Activities.Statements.WriteLine> e il valore del relativo argomento <xref:System.Activities.Statements.WriteLine.Text%2A> viene specificato usando il dizionario di parametri di input.</span><span class="sxs-lookup"><span data-stu-id="6bc09-123">In this example, a <xref:System.Activities.Statements.WriteLine> is invoked and the value for its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#3)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="6bc09-124">Recupero degli argomenti di output di un flusso di lavoro</span><span class="sxs-lookup"><span data-stu-id="6bc09-124">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="6bc09-125">I parametri di output di un flusso di lavoro possono essere ottenuti tramite il dizionario di output restituito dalla chiamata all'overload <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-125">The output parameters of a workflow can be obtained using the outputs dictionary that is returned from the call to <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span></span> <span data-ttu-id="6bc09-126">Nell'esempio seguente viene richiamato un flusso di lavoro composto da una singola attività `Divide` che dispone di due argomenti di input e due di output.</span><span class="sxs-lookup"><span data-stu-id="6bc09-126">The following example invokes a workflow consisting of a single `Divide` activity that has two input arguments and two output arguments.</span></span> <span data-ttu-id="6bc09-127">Quando viene richiamato il flusso di lavoro, viene passato il dizionario `arguments` che contiene i valori per ogni argomento di input, con chiavi in base al nome dell'argomento.</span><span class="sxs-lookup"><span data-stu-id="6bc09-127">When the workflow is invoked, the `arguments` dictionary is passed which contains the values for each input argument, keyed by argument name.</span></span> <span data-ttu-id="6bc09-128">Quando la chiamata a `Invoke` restituisce un valore, ogni argomento di output viene restituito nel dizionario `outputs`, anche con chiavi in base al nome dell'argomento.</span><span class="sxs-lookup"><span data-stu-id="6bc09-128">When the call to `Invoke` returns, each output argument is returned in the `outputs` dictionary, also keyed by argument name.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#120](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#120)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#20](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#20)]  
  
 <span data-ttu-id="6bc09-129">Se il flusso di lavoro deriva da <xref:System.Activities.ActivityWithResult>, ad esempio `CodeActivity<TResult>` o `Activity<TResult>`, ed esistono altri argomenti di output oltre all'argomento di output <xref:System.Activities.Activity%601.Result%2A> definito correttamente, è necessario usare un overload non generico di `Invoke` per recuperare gli argomenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="6bc09-129">If the workflow derives from <xref:System.Activities.ActivityWithResult>, such as `CodeActivity<TResult>` or `Activity<TResult>`, and there are output arguments in addition to the well-defined <xref:System.Activities.Activity%601.Result%2A> output argument, a non-generic overload of `Invoke` must be used in order to retrieve the additional arguments.</span></span> <span data-ttu-id="6bc09-130">A tale scopo, la definizione del flusso di lavoro passata in `Invoke` deve essere di tipo <xref:System.Activities.Activity>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-130">To do this, the workflow definition passed into `Invoke` must be of type <xref:System.Activities.Activity>.</span></span> <span data-ttu-id="6bc09-131">In questo esempio l'attività `Divide` deriva da `CodeActivity<int>`, ma viene dichiarata come <xref:System.Activities.Activity> in modo che venga usato un overload non generico di `Invoke` che restituisce un dizionario di argomenti anziché un solo valore restituito.</span><span class="sxs-lookup"><span data-stu-id="6bc09-131">In this example the `Divide` activity derives from `CodeActivity<int>`, but is declared as <xref:System.Activities.Activity> so that a non-generic overload of `Invoke` is used which returns a dictionary of arguments instead of a single return value.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#121](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#121)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#21)]  
  
## <a name="using-workflowapplication"></a><span data-ttu-id="6bc09-132">Uso di WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="6bc09-132">Using WorkflowApplication</span></span>  
 <span data-ttu-id="6bc09-133"><xref:System.Activities.WorkflowApplication> offre un'ampia gamma di funzionalità per la gestione delle istanze del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="6bc09-133"><xref:System.Activities.WorkflowApplication> provides a rich set of features for workflow instance management.</span></span> <span data-ttu-id="6bc09-134"><xref:System.Activities.WorkflowApplication> agisce da proxy thread-safe verso l'oggetto <xref:System.Activities.Hosting.WorkflowInstance> effettivo, che incapsula il runtime e fornisce i metodo per creare e caricare istanze del flusso di lavoro, sospendere e riprendere, chiudere e inviare notifiche di eventi del ciclo di vita.</span><span class="sxs-lookup"><span data-stu-id="6bc09-134"><xref:System.Activities.WorkflowApplication> acts as a thread safe proxy to the actual  <xref:System.Activities.Hosting.WorkflowInstance>, which encapsulates the runtime, and provides methods for creating and loading workflow instances, pausing and resuming, terminating, and notification of lifecycle events.</span></span> <span data-ttu-id="6bc09-135">Per eseguire un flusso di lavoro tramite l'oggetto <xref:System.Activities.WorkflowApplication> è necessario creare l'oggetto <xref:System.Activities.WorkflowApplication>, sottoscrivere un qualsiasi evento del ciclo di vita desiderato, avviare il flusso di lavoro, quindi attendere il relativo completamento.</span><span class="sxs-lookup"><span data-stu-id="6bc09-135">To run a workflow using <xref:System.Activities.WorkflowApplication> you create the <xref:System.Activities.WorkflowApplication>, subscribe to any desired lifecycle events, start the workflow, and then wait for it to finish.</span></span> <span data-ttu-id="6bc09-136">In questo esempio viene creata una definizione del flusso di lavoro costituita da un'attività <xref:System.Activities.Statements.WriteLine>; con la definizione del flusso specificata viene creato poi un oggetto <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-136">In this example, a workflow definition that consists of a <xref:System.Activities.Statements.WriteLine> activity is created and a <xref:System.Activities.WorkflowApplication> is created using the specified workflow definition.</span></span> <span data-ttu-id="6bc09-137">L'oggetto <xref:System.Activities.WorkflowApplication.Completed%2A> viene gestito in modo che all'host sia notificato quando il flusso di lavoro viene completato, il flusso di lavoro viene avviato con una chiamata a <xref:System.Activities.WorkflowApplication.Run%2A>, quindi l'host attende il completamento del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="6bc09-137"><xref:System.Activities.WorkflowApplication.Completed%2A> is handled so the host is notified when the workflow completes, the workflow is started with a call to <xref:System.Activities.WorkflowApplication.Run%2A>, and then the host waits for the workflow to complete.</span></span> <span data-ttu-id="6bc09-138">Quando il flusso di lavoro viene completato, l'oggetto <xref:System.Threading.AutoResetEvent> viene impostato e l'applicazione host può riprendere l'esecuzione, come mostrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="6bc09-138">When the workflow completes, the <xref:System.Threading.AutoResetEvent> is set and the host application can resume execution, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#31](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#31)]  
  
### <a name="workflowapplication-lifecycle-events"></a><span data-ttu-id="6bc09-139">Eventi del ciclo di vita di WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="6bc09-139">WorkflowApplication Lifecycle Events</span></span>  
 <span data-ttu-id="6bc09-140">Oltre alla proprietà <xref:System.Activities.WorkflowApplication.Completed%2A>, gli autori di host possono ricevere una notifica quando un flusso di lavoro viene scaricato (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), interrotto (<xref:System.Activities.WorkflowApplication.Aborted%2A>), diventa inattivo (<xref:System.Activities.WorkflowApplication.Idle%2A> e <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>) o si verifica un'eccezione non gestita (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span><span class="sxs-lookup"><span data-stu-id="6bc09-140">In addition to <xref:System.Activities.WorkflowApplication.Completed%2A>, host authors can be notified when a workflow is unloaded (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), aborted (<xref:System.Activities.WorkflowApplication.Aborted%2A>), becomes idle (<xref:System.Activities.WorkflowApplication.Idle%2A> and <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>), or an unhandled exception occurs (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span></span> <span data-ttu-id="6bc09-141">Gli sviluppatori di applicazioni del flusso di lavoro possono gestire queste notifiche e intraprendere le azioni appropriate, come mostrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="6bc09-141">Workflow application developers can handle these notifications and take appropriate action, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#32](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#32)]  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="6bc09-142">Impostazione degli argomenti di input di un flusso di lavoro</span><span class="sxs-lookup"><span data-stu-id="6bc09-142">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="6bc09-143">I dati possono essere passati in un flusso di lavoro come se avviati tramite un dizionario di parametri, ovvero in modo simile al passaggio dei dati tramite l'oggetto <xref:System.Activities.WorkflowInvoker>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-143">Data can be passed into a workflow as it is started using a dictionary of parameters, similar to the way data is passed in when using <xref:System.Activities.WorkflowInvoker>.</span></span> <span data-ttu-id="6bc09-144">Ogni elemento del dizionario viene mappato a un argomento di input del flusso di lavoro specificato.</span><span class="sxs-lookup"><span data-stu-id="6bc09-144">Each item in the dictionary maps to an input argument of the specified workflow.</span></span> <span data-ttu-id="6bc09-145">In questo esempio viene richiamato un flusso di lavoro costituito da un'attività <xref:System.Activities.Statements.WriteLine> e il relativo argomento <xref:System.Activities.Statements.WriteLine.Text%2A> viene specificato usando il dizionario di parametri di input.</span><span class="sxs-lookup"><span data-stu-id="6bc09-145">In this example, a workflow that consists of a <xref:System.Activities.Statements.WriteLine> activity is invoked and its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#30](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#30)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="6bc09-146">Recupero degli argomenti di output di un flusso di lavoro</span><span class="sxs-lookup"><span data-stu-id="6bc09-146">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="6bc09-147">Quando un flusso di lavoro viene completato, qualsiasi argomento di output può essere recuperato nel gestore <xref:System.Activities.WorkflowApplication.Completed%2A> eseguendo l'accesso al dizionario <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-147">When a workflow completes, any output arguments can be retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler by accessing the <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType> dictionary.</span></span> <span data-ttu-id="6bc09-148">Nell'esempio seguente viene ospitato un flusso di lavoro tramite <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-148">The following example hosts a workflow using <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="6bc09-149">Un'istanza <xref:System.Activities.WorkflowApplication> viene costruita utilizzando una `DiceRoll` definizione del flusso di lavoro costituita da una singola attività.</span><span class="sxs-lookup"><span data-stu-id="6bc09-149">A <xref:System.Activities.WorkflowApplication> instance is constructed using a workflow definition consisting of a single `DiceRoll` activity.</span></span> <span data-ttu-id="6bc09-150">L'attività `DiceRoll` dispone di due argomenti di output che rappresentano i risultati dell'operazione di lancio dei dadi.</span><span class="sxs-lookup"><span data-stu-id="6bc09-150">The `DiceRoll` activity has two output arguments that represent the results of the dice roll operation.</span></span> <span data-ttu-id="6bc09-151">Quando il flusso di lavoro viene completato, gli output vengono recuperati nel gestore <xref:System.Activities.WorkflowApplication.Completed%2A>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-151">When the workflow completes, the outputs are retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#130](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#130)]  
  
 [!code-csharp[CFX_WorkflowApplicationExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#21)]  
  
> [!NOTE]
> <span data-ttu-id="6bc09-152">Gli oggetti <xref:System.Activities.WorkflowApplication> e <xref:System.Activities.WorkflowInvoker> accettano un dizionario di argomenti di input e restituiscono un dizionario di argomenti `out`.</span><span class="sxs-lookup"><span data-stu-id="6bc09-152"><xref:System.Activities.WorkflowApplication> and <xref:System.Activities.WorkflowInvoker> take a dictionary of input arguments and return a dictionary of `out` arguments.</span></span> <span data-ttu-id="6bc09-153">Questi parametri, proprietà e valori restituiti del dizionario sono di tipo `IDictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="6bc09-153">These dictionary parameters, properties, and return values are of type `IDictionary<string, object>`.</span></span> <span data-ttu-id="6bc09-154">L'istanza effettiva della classe di dizionario passata può essere qualsiasi classe che implementa `IDictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="6bc09-154">The actual instance of the dictionary class that is passed in can be any class that implements `IDictionary<string, object>`.</span></span> <span data-ttu-id="6bc09-155">In questi esempi, viene usato `Dictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="6bc09-155">In these examples, `Dictionary<string, object>` is used.</span></span> <span data-ttu-id="6bc09-156">Per ulteriori informazioni sui <xref:System.Collections.Generic.IDictionary%602> <xref:System.Collections.Generic.Dictionary%602>dizionari, vedere e .</span><span class="sxs-lookup"><span data-stu-id="6bc09-156">For more information about dictionaries, see <xref:System.Collections.Generic.IDictionary%602> and <xref:System.Collections.Generic.Dictionary%602>.</span></span>  
  
### <a name="passing-data-into-a-running-workflow-using-bookmarks"></a><span data-ttu-id="6bc09-157">Passaggio di dati in un flusso di lavoro in esecuzione tramite i segnalibri</span><span class="sxs-lookup"><span data-stu-id="6bc09-157">Passing Data into a Running Workflow Using Bookmarks</span></span>  
 <span data-ttu-id="6bc09-158">I segnalibri consentono a un'attività di attendere passivamente la relativa ripresa, nonché di passare i dati a un'istanza del flusso di lavoro in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="6bc09-158">Bookmarks are the mechanism by which an activity can passively wait to be resumed and are a mechanism for passing data into a running workflow instance.</span></span> <span data-ttu-id="6bc09-159">Se un'attività sta attendendo dei dati, può creare un oggetto <xref:System.Activities.Bookmark> e registrare un metodo callback da chiamare quando l'oggetto <xref:System.Activities.Bookmark> viene ripreso, come mostrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="6bc09-159">If an activity is waiting for data, it can create a <xref:System.Activities.Bookmark> and register a callback method to be called when the <xref:System.Activities.Bookmark> is resumed, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#15](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#15)]  
  
 <span data-ttu-id="6bc09-160">In caso di esecuzione, l'attività `ReadLine` crea un oggetto <xref:System.Activities.Bookmark>, registra un callback, quindi attende la ripresa dell'oggetto <xref:System.Activities.Bookmark>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-160">When executed, the `ReadLine` activity creates a <xref:System.Activities.Bookmark>, registers a callback, and then waits for the <xref:System.Activities.Bookmark> to be resumed.</span></span> <span data-ttu-id="6bc09-161">Una volta ripresa, l'attività `ReadLine` assegna i dati passati con l'oggetto <xref:System.Activities.Bookmark> al relativo argomento <xref:System.Activities.Activity%601.Result%2A>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-161">When it is resumed, the `ReadLine` activity assigns the data that was passed with the <xref:System.Activities.Bookmark> to its <xref:System.Activities.Activity%601.Result%2A> argument.</span></span> <span data-ttu-id="6bc09-162">In questo esempio viene creato un flusso di lavoro che usa l'attività `ReadLine` per rilevare il nome dell'utente e visualizzarlo nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="6bc09-162">In this example, a workflow is created that uses the `ReadLine` activity to gather the user’s name and display it to the console window.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#22](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#22)]  
  
 <span data-ttu-id="6bc09-163">Quando l'attività `ReadLine` viene eseguita, crea un oggetto <xref:System.Activities.Bookmark> denominato `UserName` e attende la ripresa del segnalibro.</span><span class="sxs-lookup"><span data-stu-id="6bc09-163">When the `ReadLine` activity is executed, it creates a <xref:System.Activities.Bookmark> named `UserName` and then waits for the bookmark to be resumed.</span></span> <span data-ttu-id="6bc09-164">L'host raccoglie i dati desiderati, quindi riprende l'oggetto <xref:System.Activities.Bookmark>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-164">The host collects the desired data and then resumes the <xref:System.Activities.Bookmark>.</span></span> <span data-ttu-id="6bc09-165">Il flusso di lavoro viene ripreso, ne viene visualizzato il nome, quindi viene completato.</span><span class="sxs-lookup"><span data-stu-id="6bc09-165">The workflow resumes, displays the name, and then completes.</span></span>  
  
 <span data-ttu-id="6bc09-166">L'applicazione host può esaminare il flusso di lavoro per determinare se sono disponibili segnalibri attivi.</span><span class="sxs-lookup"><span data-stu-id="6bc09-166">The host application can inspect the workflow to determine if there are any active bookmarks.</span></span> <span data-ttu-id="6bc09-167">Tale operazione può essere eseguita chiamando il metodo <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> di un'istanza <xref:System.Activities.WorkflowApplication> o esaminando l'oggetto <xref:System.Activities.WorkflowApplicationIdleEventArgs> nel gestore <xref:System.Activities.WorkflowApplication.Idle%2A>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-167">It can do this by calling the <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> method of a <xref:System.Activities.WorkflowApplication> instance, or by inspecting the <xref:System.Activities.WorkflowApplicationIdleEventArgs> in the <xref:System.Activities.WorkflowApplication.Idle%2A> handler.</span></span>  
  
 <span data-ttu-id="6bc09-168">L'esempio di codice seguente è simile al precedente, ad eccezione del fatto che i segnalibri attivi vengono enumerati prima che venga ripreso il segnalibro.</span><span class="sxs-lookup"><span data-stu-id="6bc09-168">The following code example is like the previous example except that the active bookmarks are enumerated before the bookmark is resumed.</span></span> <span data-ttu-id="6bc09-169">Il flusso di lavoro viene avviato e, una volta creato l'oggetto <xref:System.Activities.Bookmark> e reso inattivo il flusso di lavoro, viene chiamato il metodo <xref:System.Activities.WorkflowApplication.GetBookmarks%2A>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-169">The workflow is started, and once the <xref:System.Activities.Bookmark> is created and the workflow goes idle, <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> is called.</span></span> <span data-ttu-id="6bc09-170">Quando il flusso di lavoro viene completato, l'output seguente viene visualizzato nella console.</span><span class="sxs-lookup"><span data-stu-id="6bc09-170">When the workflow is completed, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="6bc09-171">**Come ti chiami?**</span><span class="sxs-lookup"><span data-stu-id="6bc09-171">**What is your name?**</span></span>  
<span data-ttu-id="6bc09-172">**NomeSegnalibro: NomeUtente - ProprietarioDisplayName: ReadLine**
**Steve**
**Hello, Steve**</span><span class="sxs-lookup"><span data-stu-id="6bc09-172">**BookmarkName: UserName - OwnerDisplayName: ReadLine**
**Steve**
**Hello, Steve**</span></span>

[!code-csharp[CFX_WorkflowApplicationExample#14](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#14)]  
  
 <span data-ttu-id="6bc09-173">Nell'esempio di codice seguente viene esaminato l'oggetto <xref:System.Activities.WorkflowApplicationIdleEventArgs> passato nel gestore <xref:System.Activities.WorkflowApplication.Idle%2A> di un'istanza <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-173">The following code example inspects the <xref:System.Activities.WorkflowApplicationIdleEventArgs> passed into the <xref:System.Activities.WorkflowApplication.Idle%2A> handler of a <xref:System.Activities.WorkflowApplication> instance.</span></span> <span data-ttu-id="6bc09-174">In questo esempio il flusso di lavoro che diventa inattivo dispone di un oggetto <xref:System.Activities.Bookmark> denominato `EnterGuess`, di proprietà di un'attività denominata `ReadInt`.</span><span class="sxs-lookup"><span data-stu-id="6bc09-174">In this example the workflow going idle has one <xref:System.Activities.Bookmark> with a name of `EnterGuess`, owned by an activity named `ReadInt`.</span></span> <span data-ttu-id="6bc09-175">Questo esempio di codice è basato su [Procedura: Esecuzione](how-to-run-a-workflow.md)di un flusso di lavoro , che fa parte dell'esercitazione [introduttiva](getting-started-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="6bc09-175">This code example is based off of [How to: Run a Workflow](how-to-run-a-workflow.md), which is part of the [Getting Started Tutorial](getting-started-tutorial.md).</span></span> <span data-ttu-id="6bc09-176">Se il gestore <xref:System.Activities.WorkflowApplication.Idle%2A> nel passaggio indicato viene modificato per contenere il codice da questo esempio, viene visualizzato l'output seguente.</span><span class="sxs-lookup"><span data-stu-id="6bc09-176">If the <xref:System.Activities.WorkflowApplication.Idle%2A> handler in that step is modified to contain the code from this example, the following output is displayed.</span></span>  
  
 <span data-ttu-id="6bc09-177">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span><span class="sxs-lookup"><span data-stu-id="6bc09-177">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span></span>

 [!code-csharp[CFX_WorkflowApplicationExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#2)]  
  
## <a name="summary"></a><span data-ttu-id="6bc09-178">Summary</span><span class="sxs-lookup"><span data-stu-id="6bc09-178">Summary</span></span>  
 <span data-ttu-id="6bc09-179">L'oggetto <xref:System.Activities.WorkflowInvoker> rappresenta un modo semplice per richiamare i flussi di lavoro e, sebbene fornisca i metodi per passare i dati all'inizio di un flusso di lavoro ed estrarli da un flusso di lavoro completato, non garantisce scenari più complessi in cui è possibile usare l'oggetto <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="6bc09-179"><xref:System.Activities.WorkflowInvoker> provides a lightweight way to invoke workflows, and although it provides methods for passing data in at the start of a workflow and extracting data from a completed workflow, it does not provide for more complex scenarios which is where <xref:System.Activities.WorkflowApplication> can be used.</span></span>
