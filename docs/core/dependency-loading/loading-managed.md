---
title: Algoritmo di caricamento di assembly gestito - .NET CoreManaged assembly loading algorithm - .NET Core
description: Descrizione dei dettagli dell'algoritmo di caricamento dell'assembly gestito in .NET Core
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 312a320676be6eb453697e0704ab771a6707618b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/14/2020
ms.locfileid: "73973506"
---
# <a name="managed-assembly-loading-algorithm"></a><span data-ttu-id="e4ff4-103">Algoritmo di caricamento dell'assembly gestito</span><span class="sxs-lookup"><span data-stu-id="e4ff4-103">Managed assembly loading algorithm</span></span>

<span data-ttu-id="e4ff4-104">Gli assembly gestiti vengono individuati e caricati con un algoritmo che coinvolge varie fasi.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-104">Managed assemblies are located and loaded with an algorithm involving various stages.</span></span>

<span data-ttu-id="e4ff4-105">Tutti gli assembly gestiti, ad eccezione degli assembly e `WinRT` assembly satellite, utilizzano lo stesso algoritmo.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-105">All managed assemblies except satellite assemblies and `WinRT` assemblies use the same algorithm.</span></span>

## <a name="when-are-managed-assemblies-loaded"></a><span data-ttu-id="e4ff4-106">Quando vengono caricati gli assembly gestiti?</span><span class="sxs-lookup"><span data-stu-id="e4ff4-106">When are managed assemblies loaded?</span></span>

<span data-ttu-id="e4ff4-107">Il meccanismo più comune per attivare il caricamento di un assembly gestito è un riferimento statico all'assembly.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-107">The most common mechanism to trigger a managed assembly load is a static assembly reference.</span></span> <span data-ttu-id="e4ff4-108">Questi riferimenti vengono inseriti dal compilatore ogni volta che il codice utilizza un tipo definito in un altro assembly.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-108">These references are inserted by the compiler whenever code uses a type defined in another assembly.</span></span> <span data-ttu-id="e4ff4-109">Questi assembly vengono`load-by-name`caricati ( ) in base alle esigenze del runtime.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-109">These assemblies are loaded (`load-by-name`) as needed by the runtime.</span></span>

<span data-ttu-id="e4ff4-110">Anche l'uso diretto di API specifiche attiverà i caricamenti:</span><span class="sxs-lookup"><span data-stu-id="e4ff4-110">The direct use of specific APIs will also trigger loads:</span></span>

|<span data-ttu-id="e4ff4-111">API</span><span class="sxs-lookup"><span data-stu-id="e4ff4-111">API</span></span>  |<span data-ttu-id="e4ff4-112">Descrizione</span><span class="sxs-lookup"><span data-stu-id="e4ff4-112">Description</span></span>  |<span data-ttu-id="e4ff4-113">`Active` <xref:System.Runtime.Loader.AssemblyLoadContext></span><span class="sxs-lookup"><span data-stu-id="e4ff4-113">`Active` <xref:System.Runtime.Loader.AssemblyLoadContext></span></span> |
|---------|---------|---------|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyName%2A?displayProperty=nameWithType>|`Load-by-name`|<span data-ttu-id="e4ff4-114">L'istanza [di questa.](../../csharp/language-reference/keywords/this.md)</span><span class="sxs-lookup"><span data-stu-id="e4ff4-114">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyPath%2A?displayProperty=nameWithType><p><xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromNativeImagePath%2A?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-115">Carica dal percorso.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-115">Load from path.</span></span>|<span data-ttu-id="e4ff4-116">L'istanza [di questa.](../../csharp/language-reference/keywords/this.md)</span><span class="sxs-lookup"><span data-stu-id="e4ff4-116">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromStream%2A?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-117">Carica dall'oggetto.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-117">Load from object.</span></span>|<span data-ttu-id="e4ff4-118">L'istanza [di questa.](../../csharp/language-reference/keywords/this.md)</span><span class="sxs-lookup"><span data-stu-id="e4ff4-118">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-119">Carica dal percorso <xref:System.Runtime.Loader.AssemblyLoadContext> in una nuova istanza</span><span class="sxs-lookup"><span data-stu-id="e4ff4-119">Load from path in a new <xref:System.Runtime.Loader.AssemblyLoadContext> instance</span></span>|<span data-ttu-id="e4ff4-120">Nuova istanza di <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-120">The new <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>|
<xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-121">Caricare dal percorso <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> nell'istanza.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-121">Load from path in the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span><p><span data-ttu-id="e4ff4-122">Aggiunge <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving> un <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>gestore a .</span><span class="sxs-lookup"><span data-stu-id="e4ff4-122">Adds a <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving> handler to <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="e4ff4-123">Il gestore caricherà le dipendenze dell'assembly dalla relativa directory.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-123">The handler will load the assembly's dependencies from its directory.</span></span>|<span data-ttu-id="e4ff4-124">Istanza <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-124">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Reflection.AssemblyName)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.String)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-125">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-125">`Load-by-name`.</span></span>|<span data-ttu-id="e4ff4-126">Dedotta dal chiamante.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-126">Inferred from caller.</span></span><p><span data-ttu-id="e4ff4-127">Preferisci i <xref:System.Runtime.Loader.AssemblyLoadContext> metodi.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-127">Prefer <xref:System.Runtime.Loader.AssemblyLoadContext> methods.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Byte[])?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.Byte[],System.Byte[])?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-128">Caricare dall'oggetto <xref:System.Runtime.Loader.AssemblyLoadContext> in una nuova istanza.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-128">Load from object in a new <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>|<span data-ttu-id="e4ff4-129">Nuova istanza di <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-129">The new <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>|
<xref:System.Type.GetType(System.String)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean,System.Boolean)?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-130">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-130">`Load-by-name`.</span></span>|<span data-ttu-id="e4ff4-131">Dedotta dal chiamante.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-131">Inferred from caller.</span></span><p><span data-ttu-id="e4ff4-132">Preferisci <xref:System.Type.GetType%2A?displayProperty=nameWithType> i `assemblyResolver` metodi con un argomento.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-132">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> methods with an `assemblyResolver` argument.</span></span>|
<xref:System.Reflection.Assembly.GetType%2A?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-133">Se `name` type descrive un tipo generico `Load-by-name`qualificato dall'assembly, attivare un file .</span><span class="sxs-lookup"><span data-stu-id="e4ff4-133">If type `name` describes an assembly qualified generic type, trigger a `Load-by-name`.</span></span>|<span data-ttu-id="e4ff4-134">Dedotta dal chiamante.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-134">Inferred from caller.</span></span><p><span data-ttu-id="e4ff4-135">Preferire <xref:System.Type.GetType%2A?displayProperty=nameWithType> quando si utilizzano i nomi di tipo completo dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-135">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> when using assembly qualified type names.</span></span>|
<xref:System.Activator.CreateInstance(System.String,System.String)?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Object[])?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Boolean,System.Reflection.BindingFlags,System.Reflection.Binder,System.Object[],System.Globalization.CultureInfo,System.Object[])?displayProperty=nameWithType>|<span data-ttu-id="e4ff4-136">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-136">`Load-by-name`.</span></span>|<span data-ttu-id="e4ff4-137">Dedotta dal chiamante.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-137">Inferred from caller.</span></span><p><span data-ttu-id="e4ff4-138">Preferire <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType> i <xref:System.Type> metodi che prendono un argomento.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-138">Prefer <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType> methods taking a <xref:System.Type> argument.</span></span>|

## <a name="algorithm"></a><span data-ttu-id="e4ff4-139">Algoritmo</span><span class="sxs-lookup"><span data-stu-id="e4ff4-139">Algorithm</span></span>

<span data-ttu-id="e4ff4-140">L'algoritmo seguente descrive il modo in cui il runtime carica un assembly gestito.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-140">The following algorithm describes how the runtime loads a managed assembly.</span></span>

1. <span data-ttu-id="e4ff4-141">Determinare `active` <xref:System.Runtime.Loader.AssemblyLoadContext>il file .</span><span class="sxs-lookup"><span data-stu-id="e4ff4-141">Determine the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>

    - <span data-ttu-id="e4ff4-142">Per un riferimento statico `active` <xref:System.Runtime.Loader.AssemblyLoadContext> all'assembly, è l'istanza che ha caricato l'assembly di riferimento.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-142">For a static assembly reference, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> is the instance that loaded the referring assembly.</span></span>
    - <span data-ttu-id="e4ff4-143">Le API preferite `active` <xref:System.Runtime.Loader.AssemblyLoadContext> rendono l'explicit.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-143">Preferred APIs make the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> explicit.</span></span>
    - <span data-ttu-id="e4ff4-144">Altre API deducono il `active` <xref:System.Runtime.Loader.AssemblyLoadContext>file .</span><span class="sxs-lookup"><span data-stu-id="e4ff4-144">Other APIs infer the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span> <span data-ttu-id="e4ff4-145">Per queste API, <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType> viene utilizzata la proprietà.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-145">For these APIs, the <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType> property is used.</span></span> <span data-ttu-id="e4ff4-146">Se il `null`valore è , <xref:System.Runtime.Loader.AssemblyLoadContext> viene utilizzata l'istanza dedotta.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-146">If its value is `null`, then the inferred <xref:System.Runtime.Loader.AssemblyLoadContext> instance is used.</span></span>
    - <span data-ttu-id="e4ff4-147">Vedere la tabella precedente.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-147">See table above.</span></span>

2. <span data-ttu-id="e4ff4-148">Per `Load-by-name` i metodi, <xref:System.Runtime.Loader.AssemblyLoadContext> l'attivo carica l'assieme.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-148">For the `Load-by-name` methods, the active <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="e4ff4-149">In ordine di priorità per:</span><span class="sxs-lookup"><span data-stu-id="e4ff4-149">In priority order by:</span></span>
    - <span data-ttu-id="e4ff4-150">Verifica `cache-by-name`del suo file .</span><span class="sxs-lookup"><span data-stu-id="e4ff4-150">Checking its `cache-by-name`.</span></span>

    - <span data-ttu-id="e4ff4-151">Chiamata <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType> della funzione.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-151">Calling the <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType> function.</span></span>

    - <span data-ttu-id="e4ff4-152">Controllo <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> della cache delle istanze e esecuzione della logica di probe predefinita dell'assembly [gestito.](default-probing.md#managed-assembly-default-probing)</span><span class="sxs-lookup"><span data-stu-id="e4ff4-152">Checking the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instances' cache and running [managed assembly default probing](default-probing.md#managed-assembly-default-probing) logic.</span></span>

    - <span data-ttu-id="e4ff4-153">Generazione <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> dell'evento per l'oggetto AssemblyLoadContext attivo.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-153">Raising the <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> event for the active AssemblyLoadContext.</span></span>

    - <span data-ttu-id="e4ff4-154">Generazione <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> dell'evento.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-154">Raising the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>

3. <span data-ttu-id="e4ff4-155">Per gli altri tipi `active` <xref:System.Runtime.Loader.AssemblyLoadContext> di carichi, l'assieme viene caricato.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-155">For the other types of loads, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="e4ff4-156">In ordine di priorità per:</span><span class="sxs-lookup"><span data-stu-id="e4ff4-156">In priority order by:</span></span>
    - <span data-ttu-id="e4ff4-157">Verifica `cache-by-name`del suo file .</span><span class="sxs-lookup"><span data-stu-id="e4ff4-157">Checking its `cache-by-name`.</span></span>

    - <span data-ttu-id="e4ff4-158">Caricamento dal percorso specificato o dall'oggetto assembly non elaborato.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-158">Loading from the specified path or raw assembly object.</span></span>

4. <span data-ttu-id="e4ff4-159">In entrambi i casi, se un assembly è appena caricato, allora:</span><span class="sxs-lookup"><span data-stu-id="e4ff4-159">In either case, if an assembly is newly loaded, then:</span></span>
   - <span data-ttu-id="e4ff4-160">Viene generato l'evento <xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-160">The <xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType> event is raised.</span></span>
   - <span data-ttu-id="e4ff4-161">Viene aggiunto un riferimento all'istanza <xref:System.Runtime.Loader.AssemblyLoadContext> `cache-by-name`dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="e4ff4-161">A reference is added to the assembly's <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>

5. <span data-ttu-id="e4ff4-162">Se l'assembly viene trovato, viene aggiunto `active` <xref:System.Runtime.Loader.AssemblyLoadContext> un `cache-by-name`riferimento in base alle esigenze dell'istanza .</span><span class="sxs-lookup"><span data-stu-id="e4ff4-162">If the assembly is found, a reference is added as needed to the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>
