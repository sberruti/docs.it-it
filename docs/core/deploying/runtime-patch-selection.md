---
title: Roll forward del runtime per le distribuzioni di app autonome di .NET Core.
description: Informazioni sulle modifiche di dotnet publish per le distribuzioni autonome.
author: KathleenDollard
ms.date: 05/31/2018
ms.openlocfilehash: 22385c7b5d2bf87755fd51cd6268d21fe3431c74
ms.sourcegitcommit: 9a97c76e141333394676bc5d264c6624b6f45bcf
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2020
ms.locfileid: "75740792"
---
# <a name="self-contained-deployment-runtime-roll-forward"></a><span data-ttu-id="3b901-103">Roll forward del runtime di distribuzione autonoma</span><span class="sxs-lookup"><span data-stu-id="3b901-103">Self-contained deployment runtime roll forward</span></span>

<span data-ttu-id="3b901-104">Le [distribuzioni di applicazioni autonome](index.md) .NET Core includono sia le librerie che il runtime .NET Core.</span><span class="sxs-lookup"><span data-stu-id="3b901-104">.NET Core [self-contained application deployments](index.md) include both the .NET Core libraries and the .NET Core runtime.</span></span> <span data-ttu-id="3b901-105">A partire da .NET Core 2.1 SDK (versione 2.1.300), le distribuzioni di applicazioni autonome [pubblicano nel computer il runtime della patch con il numero di versione più alto](https://github.com/dotnet/designs/pull/36).</span><span class="sxs-lookup"><span data-stu-id="3b901-105">Starting in .NET Core 2.1 SDK (version 2.1.300), a self-contained application deployment [publishes the highest patch runtime on your machine](https://github.com/dotnet/designs/pull/36).</span></span> <span data-ttu-id="3b901-106">Per impostazione predefinita, [`dotnet publish`](../tools/dotnet-publish.md) per una distribuzione autonoma seleziona la versione più recente installata come parte dell'SDK nel computer di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="3b901-106">By default, [`dotnet publish`](../tools/dotnet-publish.md) for a self-contained deployment selects the latest version installed as part of the SDK on the publishing machine.</span></span> <span data-ttu-id="3b901-107">Ciò consente l'esecuzione dell'applicazione distribuita con le correzioni, di sicurezza e di altro tipo, disponibili durante l'esecuzione di `publish`.</span><span class="sxs-lookup"><span data-stu-id="3b901-107">This enables your deployed application to run with security fixes (and other fixes) available during `publish`.</span></span> <span data-ttu-id="3b901-108">Per ottenere una nuova patch, è necessario ripubblicare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3b901-108">The application must be republished to obtain a new patch.</span></span> <span data-ttu-id="3b901-109">Le applicazioni autonome vengono create specificando `-r <RID>` nel comando `dotnet publish` o specificando l'[identificatore di runtime](../rid-catalog.md) nel file di progetto (csproj o vbproj) o nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="3b901-109">Self-contained applications are created by specifying `-r <RID>` on the `dotnet publish` command or by specifying the [runtime identifier (RID)](../rid-catalog.md) in the project file (csproj / vbproj) or on the command line.</span></span>

## <a name="patch-version-roll-forward-overview"></a><span data-ttu-id="3b901-110">Panoramica del roll forward della versione della patch</span><span class="sxs-lookup"><span data-stu-id="3b901-110">Patch version roll forward overview</span></span>

<span data-ttu-id="3b901-111">[`restore`](../tools/dotnet-restore.md), [`build`](../tools/dotnet-build.md) e [`publish`](../tools/dotnet-publish.md) sono comandi `dotnet` eseguibili separatamente.</span><span class="sxs-lookup"><span data-stu-id="3b901-111">[`restore`](../tools/dotnet-restore.md), [`build`](../tools/dotnet-build.md) and [`publish`](../tools/dotnet-publish.md) are `dotnet` commands that can run separately.</span></span> <span data-ttu-id="3b901-112">La scelta del runtime fa parte dell'operazione di `restore`, non di `publish` o di `build`.</span><span class="sxs-lookup"><span data-stu-id="3b901-112">The runtime choice is part of the `restore` operation, not `publish` or `build`.</span></span> <span data-ttu-id="3b901-113">Se si chiama `publish`, viene scelta la versione più recente della patch.</span><span class="sxs-lookup"><span data-stu-id="3b901-113">If you call `publish`, the latest patch version will be chosen.</span></span> <span data-ttu-id="3b901-114">Se si chiama `publish` con l'argomento `--no-restore`, non è possibile ottenere la versione desiderata della patch, perché in precedenza non può essere stato eseguito un comando `restore` con i nuovi criteri di pubblicazione dell'applicazione autonoma.</span><span class="sxs-lookup"><span data-stu-id="3b901-114">If you call `publish` with the `--no-restore` argument, then you may not get the desired patch version because a prior `restore` may not have been executed with the new self-contained application publishing policy.</span></span> <span data-ttu-id="3b901-115">In questo caso, viene generato un errore di compilazione con testo simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="3b901-115">In this case, a build error is generated with text similar to the following:</span></span>

  <span data-ttu-id="3b901-116">"The project was restored using Microsoft.NETCore.App version 2.0.0, but with current settings, version 2.0.6 would be used instead.</span><span class="sxs-lookup"><span data-stu-id="3b901-116">"The project was restored using Microsoft.NETCore.App version 2.0.0, but with current settings, version 2.0.6 would be used instead.</span></span> <span data-ttu-id="3b901-117">To resolve this issue, make sure the same settings are used for restore and for subsequent operations such as build or publish.</span><span class="sxs-lookup"><span data-stu-id="3b901-117">To resolve this issue, make sure the same settings are used for restore and for subsequent operations such as build or publish.</span></span> <span data-ttu-id="3b901-118">Typically this issue can occur if the RuntimeIdentifier property is set during build or publish but not during restore" (Il progetto è stato ripristinato tramite Microsoft.NETCore.App versione 2.0.0, ma con le impostazioni correnti avrebbe dovuto essere usata la versione 2.0.6. Per risolvere il problema, assicurarsi che vengano usate le stesse impostazioni per il comando restore e per operazioni successive, quali build o publish. Questo problema si presenta, in genere, se la proprietà RuntimeIdentifier viene impostata durante l'operazione build o publish ma non durante restore).</span><span class="sxs-lookup"><span data-stu-id="3b901-118">Typically this issue can occur if the RuntimeIdentifier property is set during build or publish but not during restore."</span></span>

> [!NOTE]
> <span data-ttu-id="3b901-119">I comandi `restore` e `build` possono essere eseguiti in modo implicito all'interno di un altro comando, ad esempio `publish`.</span><span class="sxs-lookup"><span data-stu-id="3b901-119">`restore` and `build` can be run implicitly as part of another command, like `publish`.</span></span> <span data-ttu-id="3b901-120">Durante l'esecuzione in modo implicito all'interno di un altro comando, vengono specificati con contesto aggiuntivo, in modo che vengano generati gli artefatti corretti.</span><span class="sxs-lookup"><span data-stu-id="3b901-120">When run implicitly as part of another command, they are provided with additional context so that the right artifacts are produced.</span></span> <span data-ttu-id="3b901-121">Quando si esegue `publish` con un runtime (ad esempio, `dotnet publish -r linux-x64`), il comando `restore` implicito ripristina i pacchetti per il runtime linux-x64.</span><span class="sxs-lookup"><span data-stu-id="3b901-121">When you `publish` with a runtime (for example, `dotnet publish -r linux-x64`), the implicit `restore` restores packages for the linux-x64 runtime.</span></span> <span data-ttu-id="3b901-122">Se chiamato in modo esplicito, `restore` non ripristina i pacchetti di runtime per impostazione predefinita, poiché non dispone di tale contesto.</span><span class="sxs-lookup"><span data-stu-id="3b901-122">If you call `restore` explicitly, it does not restore runtime packages by default, because it doesn't have that context.</span></span>

## <a name="how-to-avoid-restore-during-publish"></a><span data-ttu-id="3b901-123">Come evitare il ripristino durante la pubblicazione</span><span class="sxs-lookup"><span data-stu-id="3b901-123">How to avoid restore during publish</span></span>

<span data-ttu-id="3b901-124">L'esecuzione di `restore` all'interno dell'operazione `publish` può essere indesiderata per lo scenario.</span><span class="sxs-lookup"><span data-stu-id="3b901-124">Running `restore` as part of the `publish` operation may be undesirable for your scenario.</span></span> <span data-ttu-id="3b901-125">Per evitare l'esecuzione di `restore` durante la creazione di applicazioni autonome tramite `publish`, eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="3b901-125">To avoid `restore` during `publish` while creating self-contained applications, do the following:</span></span>

- <span data-ttu-id="3b901-126">Impostare la proprietà `RuntimeIdentifiers` su un elenco delimitato da punto e virgola di tutti i [RID](../rid-catalog.md) da pubblicare.</span><span class="sxs-lookup"><span data-stu-id="3b901-126">Set the `RuntimeIdentifiers` property to a semicolon-separated list of all the [RIDs](../rid-catalog.md) to be published.</span></span>
- <span data-ttu-id="3b901-127">Impostare la proprietà `TargetLatestRuntimePatch` su `true`.</span><span class="sxs-lookup"><span data-stu-id="3b901-127">Set the `TargetLatestRuntimePatch` property to `true`.</span></span>

## <a name="no-restore-argument-with-dotnet-publish-options"></a><span data-ttu-id="3b901-128">Argomento no-restore con le opzioni di dotnet publish</span><span class="sxs-lookup"><span data-stu-id="3b901-128">No-restore argument with dotnet publish options</span></span>

<span data-ttu-id="3b901-129">Se con lo stesso file di progetto si vogliono creare sia applicazioni autonome che [applicazioni dipendenti dal framework](index.md) e si vuole usare l'argomento `--no-restore` con `dotnet publish`, scegliere una delle alternative seguenti:</span><span class="sxs-lookup"><span data-stu-id="3b901-129">If you want to create both self-contained applications and [framework-dependent applications](index.md) with the same project file, and you want to use the `--no-restore` argument with `dotnet publish`, then choose one of the following:</span></span>

1. <span data-ttu-id="3b901-130">Preferire il comportamento dipendente dal framework.</span><span class="sxs-lookup"><span data-stu-id="3b901-130">Prefer the framework-dependent behavior.</span></span> <span data-ttu-id="3b901-131">Se l'applicazione è dipendente dal framework, questo è il comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="3b901-131">If the application is framework-dependent, this is the default behavior.</span></span> <span data-ttu-id="3b901-132">Se l'applicazione è autonoma e può usare un runtime locale versione 2.1.0 senza patch, impostare `TargetLatestRuntimePatch` su `false` nel file di progetto.</span><span class="sxs-lookup"><span data-stu-id="3b901-132">If the application is self-contained, and can use an unpatched 2.1.0 local runtime, set the `TargetLatestRuntimePatch` to `false` in the project file.</span></span>

2. <span data-ttu-id="3b901-133">Preferire il comportamento autonomo.</span><span class="sxs-lookup"><span data-stu-id="3b901-133">Prefer the self-contained behavior.</span></span> <span data-ttu-id="3b901-134">Se l'applicazione è autonoma, questo è il comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="3b901-134">If the application is self-contained, this is the default behavior.</span></span> <span data-ttu-id="3b901-135">Se l'applicazione è dipendente dal framework e richiede l'installazione della patch più recente, impostare `TargetLatestRuntimePatch` su `true` nel file di progetto.</span><span class="sxs-lookup"><span data-stu-id="3b901-135">If the application is framework-dependent, and requires the latest patch installed, set `TargetLatestRuntimePatch` to `true` in the project file.</span></span>

3. <span data-ttu-id="3b901-136">Assumere il controllo esplicito della versione del framework del runtime impostando `RuntimeFrameworkVersion` sulla versione specifica della patch nel file di progetto.</span><span class="sxs-lookup"><span data-stu-id="3b901-136">Take explicit control of the runtime framework version by setting `RuntimeFrameworkVersion` to the specific patch version in the project file.</span></span>
