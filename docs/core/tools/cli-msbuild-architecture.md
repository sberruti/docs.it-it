---
title: Architettura degli strumenti della riga di comando di .NET Core
description: Informazioni sui livelli degli strumenti di .NET Core e sulle modifiche apportate nelle versioni più recenti.
ms.date: 03/06/2017
ms.openlocfilehash: 0064e7354f073be618bcf6a79962ab495927fadd
ms.sourcegitcommit: 19014f9c081ca2ff19652ca12503828db8239d48
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/04/2020
ms.locfileid: "76980210"
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="5d44b-103">Panoramica generale delle modifiche agli strumenti di .NET Core</span><span class="sxs-lookup"><span data-stu-id="5d44b-103">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="5d44b-104">Questo documento descrive le modifiche associate al passaggio da *project.json* a MSBuild e al sistema di progetti *csproj* con informazioni sulle modifiche ai livelli degli strumenti .NET Core e all'implementazione dei comandi dell'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="5d44b-104">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="5d44b-105">Queste modifiche sono state introdotte con il rilascio di .NET Core SDK 1.0 e Visual Studio 2017 il 7 marzo 2017 (vedere l'[annuncio](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)), ma sono state implementate inizialmente con il rilascio di .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="5d44b-105">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="5d44b-106">Abbandono di project.json</span><span class="sxs-lookup"><span data-stu-id="5d44b-106">Moving away from project.json</span></span>

<span data-ttu-id="5d44b-107">Il cambiamento più significativo negli strumenti di .NET Core è il [passaggio da project.json a csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) come sistema di progetto.</span><span class="sxs-lookup"><span data-stu-id="5d44b-107">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="5d44b-108">Le versioni più recenti degli strumenti da riga di comando non supportano i file *project.json*.</span><span class="sxs-lookup"><span data-stu-id="5d44b-108">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="5d44b-109">Ciò significa che non può essere usato per compilare, eseguire o pubblicare applicazioni e librerie basate su Project. JSON.</span><span class="sxs-lookup"><span data-stu-id="5d44b-109">That means that it cannot be used to build, run, or publish project.json based applications and libraries.</span></span> <span data-ttu-id="5d44b-110">Per usare questa versione degli strumenti, eseguire la migrazione dei progetti esistenti o avviarne di nuovi.</span><span class="sxs-lookup"><span data-stu-id="5d44b-110">To use this version of the tools, migrate your existing projects or start new ones.</span></span>

<span data-ttu-id="5d44b-111">Come parte di questo passaggio, il motore di compilazione personalizzato sviluppato per i progetti project.json è stato sostituito da un motore di compilazione maturo e dotato di funzionalità complete denominato [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="5d44b-111">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="5d44b-112">MSBuild è un motore noto nella community di .NET.</span><span class="sxs-lookup"><span data-stu-id="5d44b-112">MSBuild is a well-known engine in the .NET community.</span></span> <span data-ttu-id="5d44b-113">Si tratta di una tecnologia fondamentale rispetto alla prima versione della piattaforma.</span><span class="sxs-lookup"><span data-stu-id="5d44b-113">It has been a key technology since the platform's first release.</span></span> <span data-ttu-id="5d44b-114">Poiché è necessario compilare applicazioni .NET Core, MSBuild è stato trasferito a .NET Core e può essere usato su qualsiasi piattaforma su cui è in esecuzione .NET Core.</span><span class="sxs-lookup"><span data-stu-id="5d44b-114">Because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="5d44b-115">Una delle promesse principali di .NET Core è la realizzazione di uno stack di sviluppo multipiattaforma, e Microsoft ha mantenuto tale promessa.</span><span class="sxs-lookup"><span data-stu-id="5d44b-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!TIP]
> <span data-ttu-id="5d44b-116">Se non si ha familiarità con MSBuild e si desidera ottenere altre informazioni, è possibile iniziare leggendo i [concetti relativi a MSBuild](/visualstudio/msbuild/msbuild-concepts) .</span><span class="sxs-lookup"><span data-stu-id="5d44b-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span>

## <a name="the-tooling-layers"></a><span data-ttu-id="5d44b-117">Livelli degli strumenti</span><span class="sxs-lookup"><span data-stu-id="5d44b-117">The tooling layers</span></span>

<span data-ttu-id="5d44b-118">Con l'abbandono del sistema di progetto esistente e dei commutatori del motore di compilazione, la domanda da porsi è la seguente: uno qualsiasi di questi cambiamenti modificherà i livelli complessivi dell'ecosistema degli strumenti .NET Core?</span><span class="sxs-lookup"><span data-stu-id="5d44b-118">With the move away from the existing project system as well as with building engine switches, the question that naturally follows is do any of these changes change the overall "layering" of the whole .NET Core tooling ecosystem?</span></span> <span data-ttu-id="5d44b-119">Esistono nuovi elementi e componenti?</span><span class="sxs-lookup"><span data-stu-id="5d44b-119">Are there new bits and components?</span></span>

<span data-ttu-id="5d44b-120">Nella figura seguente viene fornito un breve riepilogo dei livelli dell'anteprima 2:</span><span class="sxs-lookup"><span data-stu-id="5d44b-120">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Architettura di alto livello degli strumenti dell'anteprima 2](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="5d44b-122">L'organizzazione su più livelli degli strumenti è piuttosto semplice.</span><span class="sxs-lookup"><span data-stu-id="5d44b-122">The layering of the tools is quite simple.</span></span> <span data-ttu-id="5d44b-123">Nella parte inferiore, la base è la interfaccia della riga di comando di .NET Core.</span><span class="sxs-lookup"><span data-stu-id="5d44b-123">At the bottom, the foundation is the .NET Core CLI.</span></span> <span data-ttu-id="5d44b-124">Tutti gli altri strumenti di livello più alto, ad esempio Visual Studio o Visual Studio Code, dipendono e si basano sull'interfaccia della riga di comando per compilare progetti, ripristinare le dipendenze e così via.</span><span class="sxs-lookup"><span data-stu-id="5d44b-124">All other, higher-level tools, such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies, and so on.</span></span> <span data-ttu-id="5d44b-125">Ad esempio, se Visual Studio voleva eseguire un'operazione di ripristino, eseguirebbe la chiamata nel comando `dotnet restore` ([vedere la nota](#dotnet-restore-note)) nell'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="5d44b-125">For example, if Visual Studio wanted to perform a restore operation, it would call into `dotnet restore` ([see note](#dotnet-restore-note)) command in the CLI.</span></span>

<span data-ttu-id="5d44b-126">Con il passaggio al nuovo sistema di progetto, il diagramma precedente risulta modificato nel modo illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="5d44b-126">With the move to the new project system, the previous diagram changes:</span></span>

![Architettura di alto livello di .NET Core SDK 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="5d44b-128">La differenza principale è che l'interfaccia della riga di comando non è più il livello di base. Tale ruolo viene ora svolto dal "componente SDK condiviso".</span><span class="sxs-lookup"><span data-stu-id="5d44b-128">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="5d44b-129">Questo componente SDK condiviso è un set di destinazioni e attività associate responsabili della compilazione del codice, della pubblicazione, della compressione dei pacchetti NuGet e così via.</span><span class="sxs-lookup"><span data-stu-id="5d44b-129">This shared SDK component is a set of targets and associated tasks that are responsible for compiling code, publishing it, packing NuGet packages, and so on.</span></span> <span data-ttu-id="5d44b-130">Il .NET Core SDK è open source ed è disponibile in GitHub nel [repository SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="5d44b-130">The .NET Core SDK is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span>

> [!NOTE]
> <span data-ttu-id="5d44b-131">Una "destinazione" è un termine di MSBuild che indica un'operazione denominata che MSBuild può richiamare.</span><span class="sxs-lookup"><span data-stu-id="5d44b-131">A "target" is an MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="5d44b-132">La destinazione è in genere associata a una o più attività che eseguono la logica dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="5d44b-132">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="5d44b-133">MSBuild supporta diverse destinazioni predefinite, ad esempio `Copy` o `Execute`. Consente inoltre agli utenti di scrivere le proprie attività usando codice gestito e definire destinazioni per eseguire tali attività.</span><span class="sxs-lookup"><span data-stu-id="5d44b-133">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="5d44b-134">Per altre informazioni, vedere [Attività di MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="5d44b-134">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span>

<span data-ttu-id="5d44b-135">Tutti i set di strumenti, inclusa l'interfaccia della riga di comando, utilizzano ora il componente SDK condiviso e le relative destinazioni.</span><span class="sxs-lookup"><span data-stu-id="5d44b-135">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="5d44b-136">Ad esempio, Visual Studio 2019 non chiama il comando `dotnet restore` ([vedere la nota](#dotnet-restore-note)) per ripristinare le dipendenze per i progetti .NET Core.</span><span class="sxs-lookup"><span data-stu-id="5d44b-136">For example, Visual Studio 2019 doesn't call into the `dotnet restore` ([see note](#dotnet-restore-note)) command to restore dependencies for .NET Core projects.</span></span> <span data-ttu-id="5d44b-137">Viene invece utilizzata direttamente la destinazione "Restore".</span><span class="sxs-lookup"><span data-stu-id="5d44b-137">Instead, it uses the "Restore" target directly.</span></span> <span data-ttu-id="5d44b-138">Poiché si tratta di destinazioni MSBuild, è anche possibile usare direttamente MSBuild per eseguirle mediante il comando [dotnet-msbuild](dotnet-msbuild.md).</span><span class="sxs-lookup"><span data-stu-id="5d44b-138">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span>

### <a name="cli-commands"></a><span data-ttu-id="5d44b-139">Comandi dell'interfaccia della riga di comando</span><span class="sxs-lookup"><span data-stu-id="5d44b-139">CLI commands</span></span>

<span data-ttu-id="5d44b-140">Con l'introduzione del componente SDK condiviso, la maggior parte dei comandi dell'interfaccia della riga di comando esistenti sono stati reimplementati come attività e destinazioni MSBuild.</span><span class="sxs-lookup"><span data-stu-id="5d44b-140">The shared SDK component means that the majority of existing CLI commands have been re-implemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="5d44b-141">Cosa significa questo per i comandi dell'interfaccia della riga di comando e per l'utilizzo del set di strumenti?</span><span class="sxs-lookup"><span data-stu-id="5d44b-141">What does this mean for the CLI commands and your usage of the toolset?</span></span>

<span data-ttu-id="5d44b-142">Dal punto di vista dell'utilizzo, non cambia il modo in cui si usa l'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="5d44b-142">From a usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="5d44b-143">L'interfaccia della riga di comando contiene ancora i comandi di base esistenti nella versione di .NET Core 1,0 Preview 2:</span><span class="sxs-lookup"><span data-stu-id="5d44b-143">The CLI still has the core commands that existed in the .NET Core 1.0 Preview 2 release:</span></span>

- `new`
- `restore`
- `run`
- `build`
- `publish`
- `test`
- `pack`

<span data-ttu-id="5d44b-144">Questi comandi eseguono ancora le operazioni che si prevede di eseguire (nuovo progetto, compilazione, pubblicazione, compressione e così via).</span><span class="sxs-lookup"><span data-stu-id="5d44b-144">These commands still do what you expect them to do (new up a project, build it, publish it, pack it, and so on).</span></span> <span data-ttu-id="5d44b-145">È possibile consultare la schermata della guida del comando (usando `dotnet <command> --help`) o la documentazione di questo sito per acquisire familiarità con il proprio comportamento.</span><span class="sxs-lookup"><span data-stu-id="5d44b-145">You can consult either the command's help screen (using `dotnet <command> --help`) or documentation on this site to get familiar with their behavior.</span></span>

<span data-ttu-id="5d44b-146">Dal punto di vista dell'esecuzione, i comandi dell'interfaccia della riga di comando accettano i parametri e creano una chiamata a MSBuild "Raw" che imposta le proprietà necessarie ed esegue la destinazione desiderata.</span><span class="sxs-lookup"><span data-stu-id="5d44b-146">From an execution perspective, the CLI commands take their parameters and construct a call to "raw" MSBuild that sets the needed properties and runs the desired target.</span></span> <span data-ttu-id="5d44b-147">Per comprendere meglio quanto esposto sopra, prendere in considerazione il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="5d44b-147">To better illustrate this, consider the following command:</span></span>

   ```dotnetcli
   dotnet publish -o pub -c Release
   ```

<span data-ttu-id="5d44b-148">Questo comando pubblica un'applicazione in una cartella `pub` usando la configurazione "release".</span><span class="sxs-lookup"><span data-stu-id="5d44b-148">This command publishes an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="5d44b-149">A livello interno, il comando viene tradotto nella chiamata a MSBuild seguente:</span><span class="sxs-lookup"><span data-stu-id="5d44b-149">Internally, this command gets translated into the following MSBuild invocation:</span></span>

   ```dotnetcli
   dotnet msbuild -t:Publish -p:OutputPath=pub -p:Configuration=Release
   ```

<span data-ttu-id="5d44b-150">Le eccezioni rilevanti a questa regola sono i comandi `new` e `run`.</span><span class="sxs-lookup"><span data-stu-id="5d44b-150">Notable exceptions to this rule are the `new` and `run` commands.</span></span> <span data-ttu-id="5d44b-151">Non sono state implementate come destinazioni MSBuild.</span><span class="sxs-lookup"><span data-stu-id="5d44b-151">They have not been implemented as MSBuild targets.</span></span>

<a name="dotnet-restore-note"></a>
[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
